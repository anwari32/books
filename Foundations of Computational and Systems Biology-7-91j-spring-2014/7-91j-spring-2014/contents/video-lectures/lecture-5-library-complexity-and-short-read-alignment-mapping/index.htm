<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 5: Library Complexity and Short Read Alignment (Mapping) | Video Lectures | Foundations of Computational and Systems Biology | Biology | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="7-91j-foundations-of-computational-and-systems-biology-spring-2014" name="WT.cg_n">
    <meta content="Lecture 5: Library Complexity and Short Read Alignment (Mapping)" name="WT.cg_s">
    <meta content="In this lecture, Prof. David Gifford talks about library complexity as it relates to genome sequencing. He explains how to create a full-text minute-size (FM) index, which involves a Burrows-Wheeler transform (BWT). He ends by talking about how to deal with the problem of mismatching." name="Description">
    <meta content="Burge, Christopher" name="Author">
    <meta content="Gifford, David" name="Author">
    <meta content="Fraenkel, Ernest" name="Author">
    <meta content="7.91J,7.91,20.490J,20.490,20.390J,20.390,7.36J,7.36,6.802J,6.802,6.874J,6.874,HST.506J,HST.506,DNA sequencing,genome,short read alignment,read mapping,library complexity,full-text minute-size index,BWT,sequencing adapter,Poisson,Burrows-Wheeler transform,Computational Biology,Computation and Systems Biology,Computational Modeling and Simulation" name="keywords">
    <meta content="7.91J Foundations of Computational and Systems Biology | Lecture 5: Library Complexity and Short Read Alignment (Mapping)" name="Search_Display">
    <meta content="Computational Biology" itemprop="about">
    <meta content="Computation and Systems Biology" itemprop="about">
    <meta content="Computational Modeling and Simulation" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/biology/7-91j-foundations-of-computational-and-systems-biology-spring-2014/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/biology">Biology</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Foundations of Computational and Systems Biology</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Video Lectures</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 5: Library Complexity and Short Read Alignment (Mapping)
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 5: Library Complexity and Short Read Alignment (Mapping)
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/instructor-insights/index.htm">
		                  Instructor Insights  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-slides/index.htm">
		                  Lecture Slides  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Video Lectures  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/recitations/index.htm">
		                  Recitations  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/assignments/index.htm">
		                  Assignments  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/project/index.htm">
		                  Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/tools/index.htm">
		                  Tools  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/biology/7-91j-foundations-of-computational-and-systems-biology-spring-2014/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping/P3ORBMon8aw.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id951068236">iTunes U</a> or the <a href="http://archive.org/download/MIT7.91JS14/MIT7_91JS14_lec05_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/P3ORBMon8aw', 'youtube', '/courses/biology/7-91j-foundations-of-computational-and-systems-biology-spring-2014/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping', 'https://img.youtube.com/vi/P3ORBMon8aw/0.jpg',0,0, 'https://ocw.mit.edu/courses/biology/7-91j-foundations-of-computational-and-systems-biology-spring-2014/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping/P3ORBMon8aw.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 532942, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-4-comparative-genomic-analysis-of-gene-regulation/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-6-genome-assembly/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> Prof. Gifford talks about library complexity as it relates to genome sequencing. He explains how to create a full-text minute-size (FM) index, which involves a Burrows-Wheeler transform (BWT). He ends with how to deal with the problem of mismatching.</p> <p><strong>Instructor:</strong> Prof. David Gifford</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-course-introduction-history-of-computational-biology-overview-of-the-course-course-policies-and-mechanics-dna-sequencing-technologies/index.htm">
<img src="https://img.youtube.com/vi/lJzybEXmIj0/default.jpg" title="Lecture 1: Introduction to Computational and Systems Biology" alt="Lecture 1: Introduction to Computational and Systems Biology">
<p>Lecture 1: Introduction to ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-local-alignment-blast-and-statistics/index.htm">
<img src="https://img.youtube.com/vi/6Udqou3vmng/default.jpg" title="Lecture 2: Local Alignment (BLAST) and Statistics" alt="Lecture 2: Local Alignment (BLAST) and Statistics">
<p>Lecture 2: Local Alignment ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-global-alignment-of-protein-sequences-nw-sw-pam-blosum/index.htm">
<img src="https://img.youtube.com/vi/PdyARRNwi7I/default.jpg" title="Lecture 3: Global Alignment of Protein Sequences (NW, SW, PAM, BLOSUM)" alt="Lecture 3: Global Alignment of Protein Sequences (NW, SW, PAM, BLOSUM)">
<p>Lecture 3: Global Alignment...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-comparative-genomic-analysis-of-gene-regulation/index.htm">
<img src="https://img.youtube.com/vi/14m9MW-qMhg/default.jpg" title="Lecture 4: Comparative Genomic Analysis of Gene Regulation" alt="Lecture 4: Comparative Genomic Analysis of Gene Regulation">
<p>Lecture 4: Comparative Geno...</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/P3ORBMon8aw/default.jpg" title="Lecture 5: Library Complexity and Short Read Alignment (Mapping)" alt="Lecture 5: Library Complexity and Short Read Alignment (Mapping)">
<p>Lecture 5: Library Complexi...</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-genome-assembly/index.htm">
<img src="https://img.youtube.com/vi/ZYW2AeDE6wU/default.jpg" title="Lecture 6: Genome Assembly" alt="Lecture 6: Genome Assembly">
<p>Lecture 6: Genome Assembly</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/leture-7-chip-seq-analysis-dna-protein-interactions/index.htm">
<img src="https://img.youtube.com/vi/Ob9xGBPvr_s/default.jpg" title="Leture 7: ChIP-seq Analysis; DNA-protein Interactions" alt="Leture 7: ChIP-seq Analysis; DNA-protein Interactions">
<p>Leture 7: ChIP-seq Analysis...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-rna-sequence-analysis-expression-isoforms/index.htm">
<img src="https://img.youtube.com/vi/MniYgsZSp30/default.jpg" title="Lecture 8: RNA-sequence Analysis: Expression, Isoforms" alt="Lecture 8: RNA-sequence Analysis: Expression, Isoforms">
<p>Lecture 8: RNA-sequence Ana...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-modeling-and-discovery-of-sequence-motifs-gibbs-sampler-alternatives/index.htm">
<img src="https://img.youtube.com/vi/1EMonM7qAU8/default.jpg" title="Lecture 9: Modeling and Discovery of Sequence Motifs" alt="Lecture 9: Modeling and Discovery of Sequence Motifs">
<p>Lecture 9: Modeling and Dis...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-markov-and-hidden-markov-models-of-genomic-and-protein-features/index.htm">
<img src="https://img.youtube.com/vi/d5NMrA2HkG4/default.jpg" title="Lecture 10: Markov and Hidden Markov Models of Genomic and Protein Features" alt="Lecture 10: Markov and Hidden Markov Models of Genomic and Protein Features">
<p>Lecture 10: Markov and Hidd...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-rna-secondary-structure-2013-biological-functions-and-prediction/index.htm">
<img src="https://img.youtube.com/vi/kUN6rJ21Hno/default.jpg" title="Lecture 11: RNA Secondary Structure – Biological Functions and Prediction" alt="Lecture 11: RNA Secondary Structure – Biological Functions and Prediction">
<p>Lecture 11: RNA Secondary S...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/leture-12-introduction-to-protein-structure-structure-comparison-and-classification/index.htm">
<img src="https://img.youtube.com/vi/6ROBp57G2ZI/default.jpg" title="Leture 12: Introduction to Protein Structure; Structure Comparison and Classification" alt="Leture 12: Introduction to Protein Structure; Structure Comparison and Classification">
<p>Leture 12: Introduction to ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-predicting-protein-structure/index.htm">
<img src="https://img.youtube.com/vi/j1s9JfZKFqU/default.jpg" title="Lecture 13: Predicting Protein Structure" alt="Lecture 13: Predicting Protein Structure">
<p>Lecture 13: Predicting Prot...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-predicting-protein-interactions/index.htm">
<img src="https://img.youtube.com/vi/C95294_vvQY/default.jpg" title="Lecture 14: Predicting Protein Interactions" alt="Lecture 14: Predicting Protein Interactions">
<p>Lecture 14: Predicting Prot...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-gene-regulatory-networks/index.htm">
<img src="https://img.youtube.com/vi/So6MK_FcP4E/default.jpg" title="Lecture 15: Gene Regulatory Networks" alt="Lecture 15: Gene Regulatory Networks">
<p>Lecture 15: Gene Regulatory...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-protein-interaction-networks/index.htm">
<img src="https://img.youtube.com/vi/RBPcKbEvK3U/default.jpg" title="Lecture 16: Protein Interaction Networks" alt="Lecture 16: Protein Interaction Networks">
<p>Lecture 16: Protein Interac...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-logic-modeling-of-cell-signaling-networks.-guest-lecture-doug-lauffenburger/index.htm">
<img src="https://img.youtube.com/vi/i59JDQ9hk10/default.jpg" title="Lecture 17: Logic Modeling of Cell Signaling Networks" alt="Lecture 17: Logic Modeling of Cell Signaling Networks">
<p>Lecture 17: Logic Modeling ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-analysis-of-chromatin-structure/index.htm">
<img src="https://img.youtube.com/vi/iKLvCuFD1MA/default.jpg" title="Lecture 18: Analysis of Chromatin Structure" alt="Lecture 18: Analysis of Chromatin Structure">
<p>Lecture 18: Analysis of Chr...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-discovering-quantitative-trait-loci-qtls/index.htm">
<img src="https://img.youtube.com/vi/kx_Hks_-SZM/default.jpg" title="Lecture 19: Discovering Quantitative Trait Loci (QTLs)" alt="Lecture 19: Discovering Quantitative Trait Loci (QTLs)">
<p>Lecture 19: Discovering Qua...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-human-genetics-snps-and-genome-wide-associate-studies/index.htm">
<img src="https://img.youtube.com/vi/KYQ2dPW5nEU/default.jpg" title="Lecture 20: Human Genetics, SNPs, and Genome Wide Associate Studies" alt="Lecture 20: Human Genetics, SNPs, and Genome Wide Associate Studies">
<p>Lecture 20: Human Genetics,...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-synthetic-biology-from-parts-to-modules-to-therapeutic-systems.-guest-lecture-ron-weiss/index.htm">
<img src="https://img.youtube.com/vi/kKyrR0cFrEg/default.jpg" title="Lecture 21: Synthetic Biology: From Parts to Modules to Therapeutic Systems" alt="Lecture 21: Synthetic Biology: From Parts to Modules to Therapeutic Systems">
<p>Lecture 21: Synthetic Biolo...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-causality-natural-computing-and-engineering-genomes.-guest-lecture-george-church/index.htm">
<img src="https://img.youtube.com/vi/uD4-fOWeXAY/default.jpg" title="Lecture 22: Causality, Natural Computing, and Engineering Genomes" alt="Lecture 22: Causality, Natural Computing, and Engineering Genomes">
<p>Lecture 22: Causality, Natu...</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping/P3ORBMon8aw.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="60">The</span> <span m="190">following</span> <span m="630">content</span> <span m="1220">is</span> <span m="1340">provided</span> <span m="1780">under</span> <span m="2060">a</span> <span m="2100">Creative</span> <span m="2500">Commons</span> <span m="2910">license.</span> <span m="4019">Your</span> <span m="4210">support</span> <span m="4710">will</span> <span m="4870">help</span> <span m="5110">MIT</span> <span m="5570">OpenCourseWare</span> <span m="6360">continue</span> <span m="6870">to</span> <span m="6950">offer</span> <span m="7360">high</span> <span m="7600">quality</span> <span m="8119">educational</span> <span m="8750">resources</span> <span m="9370">for</span> <span m="9520">free.</span> <span m="10730">To</span> <span m="10830">make</span> <span m="10940">a</span> <span m="10980">donation</span> <span m="11670">or</span> <span m="11940">view</span> <span m="12380">additional</span> <span m="12800">materials</span> <span m="13330">from</span> <span m="13490">hundreds</span> <span m="13920">of</span> <span m="14030">MIT</span> <span m="14460">courses,</span> <span m="15580">visit</span> <span m="15780">MIT</span> <span m="16210">OpenCourseWare</span> <span m="17260">at</span> <span m="17420">ocw.mit.edu.</span> </p>
<p><span m="27210">PROFESSOR: OK,</span> <span m="27920">so</span> <span m="30240">welcome</span> <span m="30650">back</span> <span m="31670">to</span> <span m="31980">computational</span> <span m="32600">systems</span> <span m="32940">biology,</span> <span m="33590">I'm</span> <span m="34340">David</span> <span m="34850">Gifford.</span> <span m="35300">I'm</span> <span m="35830">delighted</span> <span m="36150">to</span> <span m="36210">be</span> <span m="36370">with</span> <span m="36580">you</span> <span m="36760">here</span> <span m="36930">here</span> <span m="37180">today.</span> <span m="38410">And</span> <span m="38680">today</span> <span m="38880">we're going to</span> <span m="39050">be</span> <span m="39150">talking</span> <span m="39430">about</span> <span m="39730">a</span> <span m="39830">topic</span> <span m="40230">that</span> <span m="40350">is</span> <span m="40810">central</span> <span m="41460">to</span> <span m="41600">modern</span> <span m="42290">high</span> <span m="42520">throughput</span> <span m="42980">biology,</span> <span m="43610">which</span> <span m="43710">is</span> <span m="43880">understanding</span> <span m="45010">how</span> <span m="45390">to do</span> <span m="45590">short</span> <span m="45970">read</span> <span m="46250">alignment,</span> <span m="46780">sometimes</span> <span m="47200">called</span> <span m="47790">read</span> <span m="48130">mapping.</span> <span m="49600">Now</span> <span m="49840">it's</span> <span m="50040">very</span> <span m="50500">important</span> <span m="50990">to</span> <span m="51070">me</span> <span m="51320">that</span> <span m="51460">you</span> <span m="51620">understand</span> <span m="53310">what</span> <span m="53670">I'm</span> <span m="53910">about</span> <span m="54210">to</span> <span m="54270">say</span> <span m="54480">today,</span> <span m="54860">and</span> <span m="55030">so</span> <span m="55120">I'm</span> <span m="55240">hopeful</span> <span m="56210">that</span> <span m="56360">you'll</span> <span m="56940">be</span> <span m="57110">uninhibited</span> <span m="57880">to</span> <span m="58100">raise</span> <span m="58310">your</span> <span m="58470">hand</span> <span m="58770">and</span> <span m="58990">ask</span> <span m="59200">questions</span> <span m="59540">about the</span> <span m="59840">fine</span> <span m="60140">points</span> <span m="60470">in</span> <span m="60560">today's</span> <span m="60850">lecture</span> <span m="61270">if</span> <span m="61570">you</span> <span m="61680">have</span> <span m="61970">any,</span> <span m="62670">because</span> <span m="62860">I'd</span> <span m="62980">be</span> <span m="63650">totally</span> <span m="64069">delighted</span> <span m="64650">to</span> <span m="64819">answer</span> <span m="65180">any</span> <span m="65290">questions</span> <span m="65800">and</span> <span m="65910">we</span> <span m="66020">have</span> <span m="66250">enough</span> <span m="66430">time</span> <span m="66800">today</span> <span m="67700">that</span> <span m="67870">we</span> <span m="68010">can</span> <span m="69110">spend</span> <span m="69470">time</span> <span m="69820">looking</span> <span m="70230">at</span> <span m="70870">one</span> <span m="71160">aspect</span> <span m="71590">of</span> <span m="71660">this</span> <span m="71800">problem</span> <span m="72680">and</span> <span m="73010">understand</span> <span m="73590">it</span> <span m="73750">thoroughly.</span> </p>
<p><span m="74690">An</span> <span m="75030">associated</span> <span m="76710">topic</span> <span m="77280">is</span> <span m="77500">the</span> <span m="77590">question</span> <span m="78000">library</span> <span m="78450">complexity.</span> <span m="79080">How</span> <span m="79210">many</span> <span m="79310">people</span> <span m="79600">have heard of</span> <span m="79820">sequencing</span> <span m="80290">libraries</span> <span m="80770">before?</span> <span m="81035">Let's</span> <span m="81300">see</span> <span m="81590">a</span> <span m="81630">show</span> <span m="81860">of</span> <span m="81940">hands.</span> <span m="83340">OK,</span> <span m="83780">how many</span> <span m="83900">people</span> <span m="84140">have heard of</span> <span m="84520">read</span> <span m="85010">alignment</span> <span m="85570">before,</span> <span m="86000">read</span> <span m="86180">mapping?</span> <span m="87540">OK,</span> <span m="87990">great,</span> <span m="88680">fantastic.</span> <span m="90570">Let's</span> <span m="90770">start</span> <span m="91210">with</span> <span m="91970">what</span> <span m="92140">we're</span> <span m="92220">going</span> <span m="92310">to</span> <span m="92350">be</span> <span m="92480">talking</span> <span m="92850">about</span> <span m="93090">today.</span> <span m="93370">We're going to</span> <span m="93680">first</span> <span m="94110">begin</span> <span m="94420">talking</span> <span m="94820">about</span> <span m="95130">what</span> <span m="95310">a</span> <span m="95410">sequencing</span> <span m="95870">library</span> <span m="96470">is</span> <span m="96730">and</span> <span m="96870">what</span> <span m="97010">we</span> <span m="97130">mean</span> <span m="97310">by</span> <span m="97440">library</span> <span m="97980">complexity.</span> </p>
<p><span m="99440">We'll</span> <span m="99600">then</span> <span m="99880">turn</span> <span m="100450">to</span> <span m="100660">what</span> <span m="100820">has</span> <span m="101040">been</span> <span m="101270">called</span> <span m="101640">a</span> <span m="101740">full</span> <span m="102060">text</span> <span m="102480">minute</span> <span m="102830">size</span> <span m="103150">index,</span> <span m="104110">sometimes</span> <span m="104590">called</span> <span m="105040">a</span> <span m="105590">burrows</span> <span m="106060">Wheeler</span> <span m="106430">transform</span> <span m="107010">index,</span> <span m="107430">a</span> <span m="107600">BWT</span> <span m="108220">index,</span> <span m="108770">an</span> <span m="108930">FM</span> <span m="109360">index,</span> <span m="110570">but</span> <span m="110780">this</span> <span m="110950">is</span> <span m="111070">at</span> <span m="111260">the</span> <span m="111360">center</span> <span m="111920">of</span> <span m="112090">most</span> <span m="112460">modern</span> <span m="113290">computational</span> <span m="114040">biology</span> <span m="114670">algorithms</span> <span m="115300">for</span> <span m="115440">processing</span> <span m="116450">high</span> <span m="116710">throughput</span> <span m="117210">sequencing</span> <span m="117640">data.</span> <span m="119100">And</span> <span m="119210">then</span> <span m="119300">we'll</span> <span m="119420">turn</span> <span m="119670">how</span> <span m="119830">to</span> <span m="119900">use</span> <span m="120310">that</span> <span m="121070">type</span> <span m="121260">of</span> <span m="121370">index</span> <span m="122160">for</span> <span m="122450">read</span> <span m="122680">alignment.</span> <span m="124470">So</span> <span m="124810">let's</span> <span m="125060">start</span> <span m="125450">now</span> <span m="125750">with</span> <span m="125980">what a</span> <span m="126240">sequencing</span> <span m="126850">library</span> <span m="127420">Is.</span> <span m="127660">Let's</span> <span m="127860">just</span> <span m="128060">say</span> <span m="128229">that</span> <span m="128370">you</span> <span m="128449">have</span> <span m="128759">a</span> <span m="128900">DNA</span> <span m="129310">sample,</span> <span m="130180">we'll</span> <span m="130310">be</span> <span m="130440">talking</span> <span m="130710">about</span> <span m="130889">various</span> <span m="131220">ways</span> <span m="131390">of</span> <span m="131480">producing</span> <span m="132110">said</span> <span m="132400">samples</span> <span m="134090">throughout</span> <span m="134500">the</span> <span m="134590">term.</span> </p>
<p><span m="135440">But</span> <span m="135680">we're</span> <span m="135820">going</span> <span m="135970">to</span> <span m="136050">assume</span> <span m="136440">that we</span> <span m="136580">have</span> <span m="137070">a</span> <span m="137170">bunch</span> <span m="137420">of</span> <span m="137490">different</span> <span m="137900">DNA</span> <span m="138160">molecules.</span> <span m="139870">And</span> <span m="140240">I'll</span> <span m="143690">illustrate</span> <span m="144240">the</span> <span m="144330">different</span> <span m="144570">molecules</span> <span m="144990">here</span> <span m="145140">in</span> <span m="145290">different</span> <span m="145370">colors.</span> <span m="146240">And</span> <span m="146400">we</span> <span m="146500">have</span> <span m="146690">three</span> <span m="147000">different</span> <span m="147610">types</span> <span m="147890">of</span> <span m="147980">molecules</span> <span m="148530">here.</span> <span m="149050">Some</span> <span m="149290">molecules</span> <span m="149800">are</span> <span m="149940">duplicated,</span> <span m="150840">because</span> <span m="151090">as</span> <span m="151300">you know,</span> <span m="151510">typically,</span> <span m="151940">we're</span> <span m="152080">preparing</span> <span m="153520">DNA</span> <span m="153960">from</span> <span m="154550">an</span> <span m="154630">experiment</span> <span m="155150">where</span> <span m="155260">there</span> <span m="155400">are</span> <span m="155510">many</span> <span m="155920">cells</span> <span m="156350">and</span> <span m="156440">we</span> <span m="156530">can</span> <span m="156660">get</span> <span m="156830">copies</span> <span m="157230">of</span> <span m="157320">DNA</span> <span m="158270">from</span> <span m="158690">those</span> <span m="158890">cells</span> <span m="159550">or</span> <span m="159680">the</span> <span m="159790">DNA</span> <span m="159960">could</span> <span m="160080">be</span> <span m="160220">amplified</span> <span m="160675">using</span> <span m="161410">PCR</span> <span m="161790">or</span> <span m="161910">some</span> <span m="162110">other</span> <span m="162280">technique.</span> <span m="163500">So</span> <span m="163640">we</span> <span m="163740">have</span> <span m="164440">this</span> <span m="165660">collection</span> <span m="166230">of</span> <span m="166280">molecules,</span> <span m="166970">and</span> <span m="167160">to</span> <span m="167230">make</span> <span m="167410">a</span> <span m="167470">library,</span> <span m="168080">we're</span> <span m="168130">going</span> <span m="168330">to</span> <span m="168420">process</span> <span m="168930">it.</span> </p>
<p><span m="169040">And</span> <span m="169190">one</span> <span m="169380">of</span> <span m="169420">the</span> <span m="169510">things</span> <span m="169710">that</span> <span m="169810">we'll</span> <span m="169950">do</span> <span m="170150">when</span> <span m="170240">we</span> <span m="170340">process</span> <span m="170830">the</span> <span m="170930">library</span> <span m="172070">is</span> <span m="172270">we'll</span> <span m="172360">put</span> <span m="172570">sequencing</span> <span m="173070">adapters</span> <span m="173570">on.</span> <span m="173720">These</span> <span m="173890">are</span> <span m="173980">short</span> <span m="174430">DNA</span> <span m="176170">sequences</span> <span m="176730">that</span> <span m="176830">we</span> <span m="176970">put</span> <span m="177140">on</span> <span m="177390">to</span> <span m="177470">the</span> <span m="177600">end</span> <span m="177830">of</span> <span m="177880">the</span> <span m="177960">molecules</span> <span m="178760">to</span> <span m="178910">enable</span> <span m="180080">them</span> <span m="180260">to</span> <span m="180350">have</span> <span m="181060">defined</span> <span m="181530">sequences</span> <span m="182060">at</span> <span m="182160">the</span> <span m="182310">ends</span> <span m="183370">which</span> <span m="183590">permits</span> <span m="183950">sequencing.</span> <span m="188200">Now,</span> <span m="188650">if</span> <span m="188760">somebody</span> <span m="189090">hands</span> <span m="189380">you</span> <span m="189490">a</span> <span m="189600">tube</span> <span m="190060">of</span> <span m="190220">DNA</span> <span m="190540">like</span> <span m="190800">this,</span> <span m="191050">there are</span> <span m="191120">a</span> <span m="191170">couple</span> <span m="191430">questions</span> <span m="191800">you</span> <span m="191900">could</span> <span m="192060">ask.</span> <span m="192250">You</span> <span m="192340">could</span> <span m="192460">check</span> <span m="192670">the</span> <span m="192750">DNA</span> <span m="193040">concentration</span> <span m="193860">to</span> <span m="193960">find</span> <span m="194220">out</span> <span m="194330">how</span> <span m="194690">DNA</span> <span m="195000">is</span> <span m="195120">there,</span> <span m="195790">you</span> <span m="195920">could</span> <span m="196060">run</span> <span m="196270">a</span> <span m="196350">gel</span> <span m="196700">to</span> <span m="196790">look</span> <span m="196980">at</span> <span m="197050">the</span> <span m="197150">size</span> <span m="197520">of</span> <span m="197600">the</span> <span m="197680">fragments</span> <span m="198160">that</span> <span m="198230">you're</span> <span m="198350">sequencing.</span> <span m="199710">We'll</span> <span m="200060">be</span> <span m="200240">returning</span> <span m="200600">to</span> <span m="200670">that</span> <span m="200850">later,</span> <span m="201140">but</span> <span m="201710">these</span> <span m="201950">are</span> <span m="202120">typically</span> <span m="202500">called</span> <span m="202790">the</span> <span m="202930">insert</span> <span m="203410">sizes</span> <span m="203900">of</span> <span m="203990">the</span> <span m="204270">library</span> <span m="204710">that</span> <span m="204820">you're</span> <span m="204930">sequencing,</span> <span m="205370">the</span> <span m="205520">total</span> <span m="205880">length</span> <span m="206090">of</span> <span m="206150">the</span> <span m="206230">DNA</span> <span m="207730">excluding</span> <span m="208280">the</span> <span m="208410">adapters.</span> </p>
<p><span m="210550">But</span> <span m="210720">we</span> <span m="210840">could</span> <span m="210970">also</span> <span m="211290">ask</span> <span m="211480">questions</span> <span m="211820">about</span> <span m="211980">how</span> <span m="212190">complex</span> <span m="212700">this</span> <span m="212880">library</span> <span m="213390">is,</span> <span m="213550">because</span> <span m="213750">it's</span> <span m="213890">possible</span> <span m="214880">to</span> <span m="215090">run</span> <span m="215770">experiments</span> <span m="216980">where</span> <span m="217260">you</span> <span m="217490">produce</span> <span m="218410">libraries</span> <span m="218750">that</span> <span m="219090">are</span> <span m="219170">not</span> <span m="219350">very</span> <span m="219580">complex,</span> <span m="220090">where</span> <span m="220170">they</span> <span m="220240">don't</span> <span m="220370">have very</span> <span m="220620">many</span> <span m="220820">different</span> <span m="221110">types</span> <span m="221440">of</span> <span m="221520">molecules.</span> <span m="222230">Now</span> <span m="222620">that</span> <span m="222750">typically</span> <span m="223130">is a</span> <span m="223250">failure</span> <span m="223820">of</span> <span m="223930">the</span> <span m="224030">experiment.</span> <span m="225980">So</span> <span m="226150">an</span> <span m="226250">important</span> <span m="226670">part</span> <span m="226820">of</span> <span m="226900">quality</span> <span m="227220">control</span> <span m="227495">is</span> <span m="227770">characterizing</span> <span m="228570">the</span> <span m="228680">library</span> <span m="229210">complexity</span> <span m="230970">where</span> <span m="232130">we</span> <span m="232220">want</span> <span m="232410">to</span> <span m="232480">figure</span> <span m="232800">out</span> <span m="232930">here</span> <span m="233680">complexity</span> <span m="234280">is</span> <span m="234390">equal</span> <span m="234610">to</span> <span m="234710">3.</span> <span m="235000">There</span> <span m="235140">are</span> <span m="235180">three</span> <span m="235380">different</span> <span m="235660">types</span> <span m="235890">of</span> <span m="235950">molecules.</span> <span m="237700">And</span> <span m="237990">we</span> <span m="238140">sample</span> <span m="238610">these</span> <span m="238800">molecules.</span> </p>
<p><span m="240860">And</span> <span m="241340">when</span> <span m="241510">we</span> <span m="241660">sample</span> <span m="242130">them,</span> <span m="242290">we</span> <span m="242640">get</span> <span m="242750">a</span> <span m="242800">bunch</span> <span m="243040">of</span> <span m="243120">DNA</span> <span m="243400">sequence</span> <span m="243780">reads.</span> <span m="246370">And</span> <span m="246570">typically</span> <span m="246980">the</span> <span m="247070">number</span> <span m="247400">of</span> <span m="247490">reads that</span> <span m="247890">we</span> <span m="248020">get</span> <span m="250380">is</span> <span m="250840">larger</span> <span m="251270">than</span> <span m="251430">the</span> <span m="251520">complexity</span> <span m="252120">of</span> <span m="252170">the</span> <span m="252260">library.</span> <span m="253720">Here</span> <span m="253970">we</span> <span m="254080">have</span> <span m="256120">a</span> <span m="256209">total</span> <span m="256470">of</span> <span m="256579">12</span> <span m="256910">different</span> <span m="257209">reads.</span> <span m="258399">And</span> <span m="258730">when</span> <span m="258910">we</span> <span m="260050">sequence</span> <span m="260620">a</span> <span m="260730">library,</span> <span m="261459">we're</span> <span m="261540">sampling</span> <span m="262100">from</span> <span m="262390">it.</span> <span m="262990">And</span> <span m="263070">so</span> <span m="263180">the</span> <span m="263270">probability</span> <span m="263890">that</span> <span m="263990">we</span> <span m="264100">get</span> <span m="264660">any</span> <span m="264890">one</span> <span m="265110">particular</span> <span m="265610">molecule</span> <span m="266600">is</span> <span m="266760">going</span> <span m="266900">to</span> <span m="266990">be</span> <span m="267690">roughly</span> <span m="267920">speaking</span> <span m="269150">equal</span> <span m="269460">to</span> <span m="270840">1</span> <span m="271310">over</span> <span m="271590">c,</span> <span m="272390">which</span> <span m="272530">is</span> <span m="272610">the</span> <span m="272700">complexity.</span> <span m="275550">And</span> <span m="275850">thus,</span> <span m="276070">we</span> <span m="276180">could</span> <span m="276320">use</span> <span m="276500">the</span> <span m="276600">binomial</span> <span m="277120">distribution</span> <span m="277880">to</span> <span m="277970">figure</span> <span m="278320">out</span> <span m="278410">the</span> <span m="278490">likelihood</span> <span m="278815">that</span> <span m="279140">we</span> <span m="279230">had</span> <span m="279370">exactly</span> <span m="279910">four</span> <span m="280890">of</span> <span m="281050">these</span> <span m="281970">type</span> <span m="282280">one</span> <span m="282500">molecules.</span> </p>
<p><span m="284200">However,</span> <span m="284570">as</span> <span m="285180">n</span> <span m="285540">the</span> <span m="285690">number of</span> <span m="285920">sequencing</span> <span m="286330">reads</span> <span m="286630">grows</span> <span m="287030">to</span> <span m="287110">be</span> <span m="287230">very</span> <span m="287500">large,</span> <span m="287900">typical</span> <span m="288270">numbers</span> <span m="288700">are</span> <span m="289200">a</span> <span m="289560">hundred</span> <span m="290070">million</span> <span m="290350">different</span> <span m="290630">reads,</span> <span m="291680">the</span> <span m="291870">binomial</span> <span m="292410">becomes</span> <span m="293280">cumbersome</span> <span m="293760">to</span> <span m="293860">work</span> <span m="294100">with.</span> <span m="294690">And</span> <span m="294740">so</span> <span m="294830">we</span> <span m="294940">typically</span> <span m="295400">are</span> <span m="295920">going</span> <span m="296120">to</span> <span m="296190">characterize</span> <span m="297720">this</span> <span m="298000">kind</span> <span m="298360">of</span> <span m="299410">selection</span> <span m="299840">process</span> <span m="300820">with</span> <span m="301170">a</span> <span m="301310">different</span> <span m="301600">kind</span> <span m="301770">of</span> <span m="301860">distribution.</span> <span m="303440">So</span> <span m="303580">one</span> <span m="303820">idea</span> <span m="304190">is</span> <span m="304440">to</span> <span m="304520">use</span> <span m="304940">a</span> <span m="305060">Poisson,</span> <span m="306200">where</span> <span m="306360">we</span> <span m="306470">say</span> <span m="306660">that</span> <span m="306760">the</span> <span m="306930">rate</span> <span m="307470">of</span> <span m="307830">sequencing</span> <span m="308840">is</span> <span m="308990">going</span> <span m="309190">to</span> <span m="309250">be</span> <span m="309970">n</span> <span m="310360">over</span> <span m="310990">c.</span> <span m="312640">And</span> <span m="312860">we</span> <span m="313020">can</span> <span m="314980">see</span> <span m="316760">that</span> <span m="317270">here</span> <span m="317560">shown</span> <span m="318040">on</span> <span m="318300">the</span> <span m="318380">slide</span> <span m="318730">above</span> <span m="319900">is</span> <span m="320110">the</span> <span m="320200">same</span> <span m="320470">process</span> <span m="320900">where</span> <span m="321000">we</span> <span m="321120">have</span> <span m="321250">the</span> <span m="321330">ligation</span> <span m="321820">of</span> <span m="321890">the</span> <span m="322010">adapters.</span> </p>
<p><span m="323400">We</span> <span m="323550">have</span> <span m="324000">a</span> <span m="324120">library</span> <span m="324800">and</span> <span m="324900">we</span> <span m="324990">have</span> <span m="325150">reads</span> <span m="325430">coming</span> <span m="325670">from</span> <span m="325820">the</span> <span m="325900">library.</span> <span m="329470">We</span> <span m="329600">have</span> <span m="329850">a</span> <span m="330710">characterized</span> <span m="331380">library</span> <span m="331740">complexity</span> <span m="332280">here,</span> <span m="332490">there</span> <span m="332660">are</span> <span m="332710">four</span> <span m="332970">different</span> <span m="333220">types</span> <span m="333410">of</span> <span m="333500">molecules.</span> <span m="335980">And</span> <span m="336120">the</span> <span m="336180">modeling</span> <span m="336620">approach</span> <span m="337420">is</span> <span m="337820">that</span> <span m="338030">assuming</span> <span m="338490">that</span> <span m="338570">we</span> <span m="338680">have</span> <span m="338820">c</span> <span m="339010">different</span> <span m="339250">unique</span> <span m="339530">molecules,</span> <span m="340610">the</span> <span m="340710">probability</span> <span m="341160">that we'll</span> <span m="341310">get</span> <span m="341490">any</span> <span m="341730">one</span> <span m="341960">of</span> <span m="342060">them</span> <span m="342240">when</span> <span m="342360">we're</span> <span m="342710">doing</span> <span m="342890">the</span> <span m="342950">sequencing</span> <span m="343470">is</span> <span m="343920">1</span> <span m="344140">over</span> <span m="344350">c.</span> <span m="346370">And</span> <span m="347110">if</span> <span m="347290">we</span> <span m="347400">do</span> <span m="347590">end</span> <span m="347840">sequencing</span> <span m="348340">reads,</span> <span m="349520">we</span> <span m="349670">can</span> <span m="350230">find</span> <span m="350550">out the</span> <span m="350740">probability</span> <span m="351920">that</span> <span m="352020">we'll</span> <span m="352130">get</span> <span m="352700">a</span> <span m="352810">certain</span> <span m="353130">number</span> <span m="353400">of</span> <span m="353480">each</span> <span m="353690">type</span> <span m="353890">of</span> <span m="353970">molecule.</span> <span m="354820">Let's</span> <span m="354960">just</span> <span m="355090">stick</span> <span m="355270">with</span> <span m="355380">the</span> <span m="355460">first</span> <span m="355800">one</span> <span m="356120">to</span> <span m="356220">start,</span> <span m="356740">OK?</span> </p>
<p><span m="359110">Now</span> <span m="360000">part</span> <span m="360300">of</span> <span m="360380">the</span> <span m="360470">challenge</span> <span m="361060">in</span> <span m="361980">analyzing</span> <span m="362560">sequencing</span> <span m="363020">data</span> <span m="363590">is</span> <span m="363810">that</span> <span m="363990">you</span> <span m="364770">don't</span> <span m="365410">see</span> <span m="365790">what</span> <span m="365960">you</span> <span m="366080">don't</span> <span m="366400">sequence.</span> <span m="367730">So</span> <span m="368770">things</span> <span m="369130">that</span> <span m="369270">actually</span> <span m="369680">occur</span> <span m="370030">0</span> <span m="370520">times</span> <span m="371060">in</span> <span m="371230">your</span> <span m="371610">sequencing</span> <span m="372170">data</span> <span m="372760">still</span> <span m="373050">may</span> <span m="373170">be</span> <span m="373310">present</span> <span m="373710">in</span> <span m="373790">the</span> <span m="373870">library.</span> <span m="375470">And</span> <span m="375560">what</span> <span m="375680">we</span> <span m="375800">would</span> <span m="375890">like</span> <span m="376110">to</span> <span m="376210">do</span> <span m="376540">is</span> <span m="376750">from</span> <span m="376920">the</span> <span m="377070">observed</span> <span m="377430">sequencing</span> <span m="377940">data,</span> <span m="378410">estimate</span> <span m="379290">the</span> <span m="379370">library</span> <span m="379780">complexity.</span> <span m="382120">So</span> <span m="382290">we</span> <span m="382400">have</span> <span m="382660">all</span> <span m="382810">of the</span> <span m="382890">sequencing</span> <span m="383360">data,</span> <span m="383950">we</span> <span m="384080">just</span> <span m="384270">don't</span> <span m="384430">know</span> <span m="385090">how</span> <span m="385210">many</span> <span m="385340">different</span> <span m="385600">molecules</span> <span m="385870">there</span> <span m="386140">are</span> <span m="386370">over</span> <span m="386590">here.</span> <span m="388830">So</span> <span m="389030">one</span> <span m="389280">way</span> <span m="389430">to</span> <span m="389560">do</span> <span m="389740">with</span> <span m="389900">this</span> <span m="390150">is</span> <span m="390300">to</span> <span m="390410">say</span> <span m="390620">that</span> <span m="391740">let</span> <span m="391960">us</span> <span m="391990">suppose</span> <span m="393190">that</span> <span m="393330">we</span> <span m="393460">make</span> <span m="393640">a</span> <span m="393690">histogram</span> <span m="394470">of</span> <span m="394580">the</span> <span m="394660">number</span> <span m="394910">of</span> <span m="394980">times</span> <span m="395270">we</span> <span m="395390">see</span> <span m="396230">distinct</span> <span m="396590">molecules</span> <span m="398130">and</span> <span m="398300">we're</span> <span m="398420">going</span> <span m="398570">to</span> <span m="398660">say</span> <span m="398870">that</span> <span m="399000">we</span> <span m="399130">can</span> <span m="399370">observe</span> <span m="399820">molecules</span> <span m="400380">that</span> <span m="400580">are</span> <span m="400670">sequenced</span> <span m="401670">or</span> <span m="402140">appear</span> <span m="403100">l</span> <span m="403320">times</span> <span m="403690">up</span> <span m="403980">through</span> <span m="404780">r</span> <span m="405010">times.</span> </p>
<p><span m="405570">So</span> <span m="405750">we</span> <span m="405870">actually</span> <span m="406840">can</span> <span m="408590">create</span> <span m="409020">a</span> <span m="410010">version</span> <span m="410530">of</span> <span m="410640">the</span> <span m="410740">distribution</span> <span m="411970">that</span> <span m="412590">characterizes</span> <span m="413380">just a</span> <span m="413720">part</span> <span m="414140">of</span> <span m="414250">what</span> <span m="414390">we're</span> <span m="414520">seeing.</span> <span m="416970">So</span> <span m="417140">if</span> <span m="417260">we</span> <span m="417370">do</span> <span m="417590">this,</span> <span m="419230">we</span> <span m="419390">can</span> <span m="419710">build</span> <span m="420100">a</span> <span m="420320">Poisson</span> <span m="420700">model</span> <span m="422080">and</span> <span m="422460">we</span> <span m="422600">can</span> <span m="422840">estimate</span> <span m="423320">lambda</span> <span m="424070">from</span> <span m="424260">what</span> <span m="424400">we</span> <span m="424530">can</span> <span m="424680">observe.</span> <span m="426260">We</span> <span m="426440">don't</span> <span m="426660">get</span> <span m="426840">to</span> <span m="426900">observe</span> <span m="427250">things</span> <span m="427460">we</span> <span m="427590">don't</span> <span m="427880">see.</span> <span m="428400">So</span> <span m="428600">for</span> <span m="428760">sure,</span> <span m="429070">we</span> <span m="429200">know</span> <span m="429670">we</span> <span m="429820">can't</span> <span m="430060">observe</span> <span m="430340">the</span> <span m="430420">things</span> <span m="430670">that</span> <span m="430750">are</span> <span m="430820">sequenced</span> <span m="431210">0</span> <span m="431530">times.</span> <span m="432960">But</span> <span m="433110">for</span> <span m="433180">the</span> <span m="433320">things</span> <span m="433560">that are</span> <span m="433650">sequenced</span> <span m="434570">at</span> <span m="434690">least</span> <span m="434910">one</span> <span m="435240">time,</span> <span m="436350">we</span> <span m="436500">can</span> <span m="436630">build</span> <span m="436820">an</span> <span m="436920">estimate</span> <span m="437400">of</span> <span m="437530">lambda.</span> <span m="438790">And</span> <span m="438910">from</span> <span m="439110">that</span> <span m="439260">estimate</span> <span m="439620">of</span> <span m="439750">lambda,</span> <span m="440730">we</span> <span m="440860">can</span> <span m="440990">build</span> <span m="441290">an</span> <span m="441450">estimate</span> <span m="442100">of</span> <span m="442610">C.</span> </p>
<p><span m="445900">So</span> <span m="446950">one</span> <span m="447300">way</span> <span m="447730">to</span> <span m="448130">look</span> <span m="448360">at</span> <span m="448480">this</span> <span m="449730">is</span> <span m="449980">that</span> <span m="451450">if</span> <span m="451630">we</span> <span m="451810">look</span> <span m="452000">at</span> <span m="452090">the</span> <span m="452220">total</span> <span m="452510">number</span> <span m="452810">of</span> <span m="452970">unique</span> <span m="453320">molecules</span> <span m="454150">that</span> <span m="454330">we</span> <span m="454470">sequence,</span> <span m="455400">which</span> <span m="455580">is</span> <span m="455670">equal</span> <span m="455950">to</span> <span m="456030">m,</span> <span m="457750">then</span> <span m="458380">the</span> <span m="458500">probability</span> <span m="459530">that</span> <span m="459640">we</span> <span m="459840">observe</span> <span m="460170">between</span> <span m="460570">l and</span> <span m="460920">r</span> <span m="464000">occurrences</span> <span m="464650">of</span> <span m="464770">a</span> <span m="464800">given</span> <span m="465090">individual</span> <span m="465660">sequence</span> <span m="467970">times</span> <span m="468400">c</span> <span m="468880">is</span> <span m="469000">going</span> <span m="469130">to</span> <span m="469190">be</span> <span m="469400">equal</span> <span m="469660">to</span> <span m="470290">the</span> <span m="470420">total</span> <span m="470660">number</span> <span m="470880">of</span> <span m="470940">unique</span> <span m="471310">molecules</span> <span m="471890">that</span> <span m="472140">we</span> <span m="472310">observe.</span> <span m="474290">Another</span> <span m="474600">way</span> <span m="474740">to</span> <span m="475000">look</span> <span m="475190">at</span> <span m="475260">this</span> <span m="475500">is</span> <span m="475910">the</span> <span m="476080">very</span> <span m="476350">bottom</span> <span m="476920">equation</span> <span m="477930">where</span> <span m="478110">we</span> <span m="478250">note</span> <span m="478580">that</span> <span m="479210">if</span> <span m="479390">we</span> <span m="480350">look</span> <span m="480560">at</span> <span m="480670">the</span> <span m="480770">total</span> <span m="481260">complexity</span> <span m="482350">of</span> <span m="482490">the</span> <span m="482580">library</span> <span m="484260">and</span> <span m="484420">we</span> <span m="484590">multiply</span> <span m="484910">it</span> <span m="485230">by</span> <span m="485590">1</span> <span m="485930">minus</span> <span m="486700">the</span> <span m="486790">probability</span> <span m="487280">that</span> <span m="487770">we</span> <span m="487990">don't</span> <span m="488280">observe</span> <span m="488690">certain</span> <span m="488900">molecules,</span> <span m="490270">that</span> <span m="490420">will</span> <span m="490550">give</span> <span m="490730">an</span> <span m="490830">estimate</span> <span m="491210">of</span> <span m="491300">the</span> <span m="491380">total</span> <span m="491640">number</span> <span m="491870">of</span> <span m="491940">unique</span> <span m="492200">molecules</span> <span m="492640">that</span> <span m="492710">we</span> <span m="492840">do</span> <span m="493010">see.</span> </p>
<p><span m="494770">And</span> <span m="494900">thus</span> <span m="495410">we</span> <span m="495560">can</span> <span m="495690">manipulate</span> <span m="496250">that</span> <span m="496670">to</span> <span m="496760">come</span> <span m="496940">up</span> <span m="497060">with</span> <span m="497190">an</span> <span m="497260">estimate</span> <span m="497640">of</span> <span m="497710">the</span> <span m="497790">complexity.</span> <span m="499770">Are</span> <span m="499990">there</span> <span m="500140">any</span> <span m="500250">questions</span> <span m="500670">about</span> <span m="500900">the</span> <span m="500970">details</span> <span m="501440">of</span> <span m="501530">this</span> <span m="501750">so</span> <span m="501870">far?</span> <span m="505030">OK,</span> <span m="505210">so</span> <span m="505330">this</span> <span m="505520">is</span> <span m="505620">a very</span> <span m="506070">simple</span> <span m="506400">model</span> <span m="507650">for</span> <span m="507860">estimating</span> <span m="509200">the</span> <span m="509430">complexity</span> <span m="510020">of</span> <span m="510110">a</span> <span m="510150">library</span> <span m="510660">based</span> <span m="510910">upon</span> <span m="511250">looking</span> <span m="511640">at</span> <span m="511770">the</span> <span m="511870">distribution</span> <span m="512500">of</span> <span m="512600">reads that</span> <span m="512840">we</span> <span m="513000">actually</span> <span m="513340">observe</span> <span m="514440">for</span> <span m="514590">quality</span> <span m="514880">control</span> <span m="515230">purposes.</span> <span m="516980">And</span> <span m="517429">let us</span> <span m="517760">suppose</span> <span m="518130">that</span> <span m="518230">we</span> <span m="518390">apply</span> <span m="518789">this</span> <span m="519630">to</span> <span m="520020">thousands</span> <span m="520929">genomes</span> <span m="521340">data,</span> <span m="522500">which</span> <span m="522650">is</span> <span m="522780">public</span> <span m="523500">data</span> <span m="523730">on</span> <span m="523970">human.</span> <span m="525410">And</span> <span m="525990">suppose</span> <span m="526360">we</span> <span m="526440">want</span> <span m="526590">to</span> <span m="526700">test</span> <span m="527020">whether</span> <span m="527230">this</span> <span m="527350">model</span> <span m="527640">works</span> <span m="527890">or</span> <span m="527950">not,</span> <span m="528230">so</span> <span m="528330">what</span> <span m="528360">we're</span> <span m="528470">going</span> <span m="528610">to</span> <span m="528710">do</span> <span m="529520">is we're</span> <span m="529620">going</span> <span m="529770">to</span> <span m="529850">estimate</span> <span m="530290">the</span> <span m="530380">library</span> <span m="530750">complexity</span> <span m="531610">from</span> <span m="531880">10</span> <span m="532130">percent</span> <span m="532530">of</span> <span m="532600">the</span> <span m="532680">sequencing</span> <span m="533140">reads,</span> <span m="533600">so we'll</span> <span m="533810">pick 10</span> <span m="533970">percent</span> <span m="534300">of</span> <span m="534380">the</span> <span m="534500">reads</span> <span m="534700">of</span> <span m="534790">an</span> <span m="534890">individual</span> <span m="535500">at</span> <span m="535670">random,</span> <span m="536580">we'll</span> <span m="537110">estimate</span> <span m="537540">the</span> <span m="537610">complexity</span> <span m="538190">of</span> <span m="538260">the</span> <span m="538320">library,</span> <span m="540280">and</span> <span m="540420">then</span> <span m="540600">we'll</span> <span m="541300">also</span> <span m="541650">take</span> <span m="541870">all</span> <span m="542160">of</span> <span m="542290">the</span> <span m="542420">region</span> <span m="542760">the</span> <span m="542830">individual</span> <span m="543670">and</span> <span m="543830">estimate</span> <span m="544200">the</span> <span m="544280">complexity.</span> </p>
<p><span m="545910">And</span> <span m="546100">if</span> <span m="546220">our</span> <span m="546330">estimator</span> <span m="546890">is</span> <span m="547240">pretty good,</span> <span m="547740">we</span> <span m="547840">should</span> <span m="548010">get</span> <span m="548110">about</span> <span m="548290">the</span> <span m="548590">same</span> <span m="548960">number,</span> <span m="549310">from</span> <span m="549590">10</span> <span m="549770">percent</span> <span m="550140">of</span> <span m="550250">the</span> <span m="550350">reads and</span> <span m="550730">from</span> <span m="550900">all of</span> <span m="551170">the</span> <span m="551270">reads.</span> <span m="552080">Will</span> <span m="552170">people</span> <span m="552410">go</span> <span m="552530">along</span> <span m="552760">with</span> <span m="552880">that?</span> <span m="554990">Think</span> <span m="555020">that</span> <span m="555170">seems</span> <span m="555380">reasonable?</span> <span m="557880">OK,</span> <span m="558100">so</span> <span m="558250">we</span> <span m="558350">do</span> <span m="558540">that.</span> <span m="559910">And</span> <span m="560070">this</span> <span m="560200">is</span> <span m="560280">what</span> <span m="560430">we</span> <span m="560540">get.</span> <span m="562320">And</span> <span m="562920">it's</span> <span m="563050">hard</span> <span m="563290">to</span> <span m="563350">see</span> <span m="563480">the</span> <span m="563590">diagonal</span> <span m="564040">line</span> <span m="564300">here,</span> <span m="565000">but</span> <span m="565120">there's</span> <span m="565270">a</span> <span m="565320">big</span> <span m="565610">oops</span> <span m="565930">here.</span> <span m="567450">And</span> <span m="567570">the</span> <span m="567630">big</span> <span m="567900">oops</span> <span m="568290">is</span> <span m="568650">that</span> <span m="569890">if</span> <span m="570060">we</span> <span m="570250">estimate</span> <span m="570650">the</span> <span m="570730">library</span> <span m="571110">complexity</span> <span m="571640">from</span> <span m="571760">just</span> <span m="572010">10</span> <span m="572180">percent</span> <span m="572540">of</span> <span m="572640">the</span> <span m="572750">reads,</span> <span m="573780">it's</span> <span m="573890">grossly</span> <span m="574540">underestimating</span> <span m="575330">the</span> <span m="575420">number</span> <span m="575730">of</span> <span m="575800">unique</span> <span m="576120">molecules</span> <span m="576630">we</span> <span m="576790">actually</span> <span m="577180">have.</span> <span m="578900">In</span> <span m="578940">fact,</span> <span m="579140">it's</span> <span m="579230">off</span> <span m="579570">by</span> <span m="580200">typically</span> <span m="580640">a</span> <span m="580690">factor</span> <span m="581050">of</span> <span m="581130">two</span> <span m="581380">or</span> <span m="581460">more.</span> </p>
<p><span m="583760">So</span> <span m="583940">for</span> <span m="584070">some</span> <span m="584310">reason,</span> <span m="584710">even</span> <span m="584830">though</span> <span m="584960">we're</span> <span m="585100">examining</span> <span m="585530">millions</span> <span m="585940">of</span> <span m="586050">reads</span> <span m="586420">in</span> <span m="586560">this</span> <span m="586770">subsample,</span> <span m="588110">we're</span> <span m="588270">not</span> <span m="588450">getting</span> <span m="588680">a</span> <span m="588750">good</span> <span m="588960">estimate</span> <span m="589480">of</span> <span m="589630">the</span> <span m="589720">complexity</span> <span m="590430">of</span> <span m="590560">the</span> <span m="590640">library.</span> <span m="593390">Does</span> <span m="593550">anybody</span> <span m="594000">have</span> <span m="594180">any</span> <span m="594330">idea</span> <span m="594570">what</span> <span m="594670">could</span> <span m="594770">be</span> <span m="594880">going</span> <span m="595210">wrong</span> <span m="595620">here?</span> <span m="597250">Why</span> <span m="597460">is</span> <span m="597680">it</span> <span m="597850">that</span> <span m="598680">this</span> <span m="598890">very</span> <span m="599210">simple</span> <span m="599540">model</span> <span m="600570">that</span> <span m="600820">is</span> <span m="601970">attempting</span> <span m="602400">to</span> <span m="602480">estimate</span> <span m="603040">how</span> <span m="603170">many</span> <span m="603300">different</span> <span m="603520">molecules</span> <span m="603960">we</span> <span m="604120">have</span> <span m="604270">here</span> <span m="604420">based</span> <span m="604660">upon</span> <span m="604900">what</span> <span m="605040">we</span> <span m="605210">observe</span> <span m="606460">is</span> <span m="607920">broken?</span> <span m="610420">Any</span> <span m="610490">ideas</span> <span m="610740">at all?</span> <span m="611020">And</span> <span m="611300">please</span> <span m="611410">say</span> <span m="611590">your</span> <span m="611680">name</span> <span m="611870">first.</span> </p>
<p><span m="612170">AUDIENCE: I'm Chris.</span> </p>
<p><span m="613410">PROFESSOR: Hi</span> <span m="613910">Chris.</span> </p>
<p><span m="614670">AUDIENCE: Is it</span> <span m="615515">because</span> <span m="616445">repeated sequences,</span> <span m="617375">so there</span> <span m="617840">could be a</span> <span m="618305">short</span> <span m="618770">sequence</span> <span m="619240">at the end</span> <span m="619680">of one molecule</span> <span m="620830">that's the</span> <span m="621270">beginning of</span> <span m="621710">another</span> <span m="622150">one,</span> <span m="622590">middle of</span> <span m="623030">another</span> <span m="623470">one,</span> <span m="623910">so</span> <span m="624276">[INAUDIBLE].</span> </p>
<p><span m="625010">PROFESSOR: Chris, you're on</span> <span m="625110">the right</span> <span m="625390">track,</span> <span m="625700">OK?</span> <span m="627080">Because</span> <span m="627800">what</span> <span m="628030">we</span> <span m="628660">have</span> <span m="629180">assumed</span> <span m="629710">at</span> <span m="629850">the</span> <span m="629980">outset</span> <span m="630870">was</span> <span m="631060">that</span> <span m="631540">all of</span> <span m="631880">these</span> <span m="632240">molecules</span> <span m="633050">occur</span> <span m="633310">with</span> <span m="633510">equal</span> <span m="633790">probability.</span> <span m="635180">Right?</span> <span m="635800">What</span> <span m="636060">would</span> <span m="636180">happen</span> <span m="636810">if</span> <span m="637000">in</span> <span m="637150">fact</span> <span m="638640">there</span> <span m="638790">are</span> <span m="638870">four</span> <span m="639190">copies</span> <span m="639580">of</span> <span m="639680">this</span> <span m="639840">purple</span> <span m="640150">one</span> <span m="640790">and</span> <span m="640910">only</span> <span m="641060">two</span> <span m="641220">copies</span> <span m="641570">of</span> <span m="641660">the</span> <span m="641750">other</span> <span m="641890">molecules?</span> <span m="643370">Then</span> <span m="643490">the</span> <span m="643580">probability of</span> <span m="644080">sampling</span> <span m="644570">this</span> <span m="644810">one</span> <span m="645010">is going</span> <span m="645120">to</span> <span m="645200">be</span> <span m="645320">twice</span> <span m="645630">as</span> <span m="645730">high</span> <span m="646040">as</span> <span m="646140">the</span> <span m="646210">probability</span> <span m="646420">of</span> <span m="646550">sampling</span> <span m="646870">one</span> <span m="647060">of</span> <span m="647140">these.</span> <span m="650550">If</span> <span m="650700">there's</span> <span m="650950">non</span> <span m="651270">uniformity</span> <span m="651930">in</span> <span m="652020">the</span> <span m="652210">original</span> <span m="652600">population,</span> <span m="653930">that's</span> <span m="654140">going</span> <span m="654340">to</span> <span m="655440">mess</span> <span m="655640">up</span> <span m="655770">our</span> <span m="655840">model</span> <span m="656100">big</span> <span m="656290">time.</span> </p>
<p><span m="658220">And</span> <span m="658360">that</span> <span m="658460">could</span> <span m="658590">happen</span> <span m="658940">from</span> <span m="659090">repeated</span> <span m="659440">sequences</span> <span m="659920">or</span> <span m="660030">other</span> <span m="660230">kinds</span> <span m="660440">of</span> <span m="660520">duplicated</span> <span m="661050">things,</span> <span m="661320">or</span> <span m="662010">it</span> <span m="662170">could</span> <span m="662360">be</span> <span m="662510">that</span> <span m="662670">there's</span> <span m="663190">unequal</span> <span m="663600">amplification.</span> <span m="664360">It</span> <span m="664450">might</span> <span m="664660">be</span> <span m="664810">that</span> <span m="665320">PCR</span> <span m="665970">really</span> <span m="666220">loves</span> <span m="666800">a</span> <span m="666870">particular</span> <span m="667330">molecule,</span> <span m="667860">right,</span> <span m="668090">and</span> <span m="668290">amplifies</span> <span m="668800">that</span> <span m="668950">one</span> <span m="669060">a</span> <span m="669100">lot,</span> <span m="670140">and</span> <span m="670290">doesn't</span> <span m="670550">amplify</span> <span m="670990">another</span> <span m="671240">one that's</span> <span m="671470">difficult to</span> <span m="671950">amplify.</span> <span m="672880">So</span> <span m="673080">somewhere</span> <span m="673820">in</span> <span m="673890">our</span> <span m="674050">experimental</span> <span m="674460">protocol</span> <span m="674870">pipeline,</span> <span m="675930">it</span> <span m="676050">could</span> <span m="676200">be that</span> <span m="676320">there's</span> <span m="676540">non</span> <span m="676800">uniformity</span> <span m="677890">and</span> <span m="678060">thus</span> <span m="678460">we're</span> <span m="678600">getting</span> <span m="678890">a</span> <span m="678970">skewness</span> <span m="679550">to</span> <span m="679680">our</span> <span m="680210">distribution</span> <span m="680710">here</span> <span m="680950">in our</span> <span m="681000">library.</span> <span m="683210">So</span> <span m="684610">the</span> <span m="684750">other</span> <span m="684880">thing</span> <span m="685040">that's</span> <span m="685180">true</span> <span m="685380">is</span> <span m="685500">in</span> <span m="685650">a</span> <span m="685890">Poisson,</span> <span m="686930">lambda,</span> <span m="687500">which</span> <span m="687510">is</span> <span m="687600">equal</span> <span m="687810">to</span> <span m="687890">the</span> <span m="687980">mean,</span> <span m="689140">is</span> <span m="689290">also</span> <span m="689640">equal</span> <span m="689850">to</span> <span m="689930">the</span> <span m="690050">variance.</span> </p>
<p><span m="691410">And so</span> <span m="691550">our</span> <span m="691680">Poisson's</span> <span m="692210">only</span> <span m="692370">one</span> <span m="692630">knob</span> <span m="692850">we</span> <span m="692970">could</span> <span m="693160">turn</span> <span m="693490">to</span> <span m="693560">fit</span> <span m="693740">the</span> <span m="693820">distribution.</span> <span m="696780">So</span> <span m="696940">coming</span> <span m="697210">back</span> <span m="697440">to</span> <span m="697510">this,</span> <span m="698190">we</span> <span m="698350">talked</span> <span m="698580">about</span> <span m="698760">the</span> <span m="698870">idea</span> <span m="699240">that</span> <span m="699360">the</span> <span m="699450">library</span> <span m="699800">complexity</span> <span m="700920">still</span> <span m="701150">may be</span> <span m="701420">four</span> <span m="701730">but</span> <span m="701970">then there</span> <span m="702180">may</span> <span m="702210">be</span> <span m="702630">different</span> <span m="702950">numbers</span> <span m="703520">of</span> <span m="703630">molecules</span> <span m="704690">of</span> <span m="704760">each</span> <span m="704980">type.</span> <span m="707130">And</span> <span m="707250">here's</span> <span m="707560">an</span> <span m="707670">idea</span> <span m="708050">for</span> <span m="708310">you,</span> <span m="708470">right?</span> <span m="708830">The</span> <span m="708940">idea</span> <span m="709290">is</span> <span m="709460">this.</span> <span m="711730">Imagine</span> <span m="712180">that</span> <span m="712300">the</span> <span m="712410">top</span> <span m="713000">distributions</span> <span m="714230">are</span> <span m="714440">the</span> <span m="714540">number</span> <span m="715030">of</span> <span m="715180">each</span> <span m="715420">type</span> <span m="715730">of</span> <span m="715850">molecule</span> <span m="716230">that</span> <span m="716290">are</span> <span m="716350">present.</span> <span m="717270">And</span> <span m="717530">it</span> <span m="717680">might</span> <span m="717880">be</span> <span m="718460">that</span> <span m="718590">our</span> <span m="718800">original</span> <span m="719070">assumption</span> <span m="719460">was</span> <span m="719600">that</span> <span m="719670">it was</span> <span m="719800">like</span> <span m="720100">the</span> <span m="720300">very</span> <span m="720640">top,</span> <span m="721570">that</span> <span m="722560">typically</span> <span m="723030">there</span> <span m="723210">are</span> <span m="723360">two</span> <span m="723590">copies</span> <span m="724010">of</span> <span m="724130">each</span> <span m="724330">molecule</span> <span m="725000">in</span> <span m="725050">the</span> <span m="725160">original</span> <span m="725490">sequencing</span> <span m="725950">library,</span> <span m="727276">and</span> <span m="727630">that's</span> <span m="727790">a</span> <span m="727840">fairly</span> <span m="728230">tight</span> <span m="728470">distribution.</span> </p>
<p><span m="730870">But</span> <span m="731020">it</span> <span m="731130">could</span> <span m="731390">be,</span> <span m="731570">in</span> <span m="731690">fact,</span> <span m="732340">that</span> <span m="732820">the</span> <span m="732920">number</span> <span m="733310">of</span> <span m="733770">molecules</span> <span m="734140">of</span> <span m="734220">each</span> <span m="734420">type</span> <span m="735190">is</span> <span m="735340">very</span> <span m="738360">dispersed.</span> <span m="739960">And</span> <span m="740100">so</span> <span m="740160">if</span> <span m="740250">we</span> <span m="740360">look</span> <span m="740580">at</span> <span m="740690">each</span> <span m="740950">one</span> <span m="741290">of</span> <span m="741390">those</span> <span m="742540">plots</span> <span m="742870">at</span> <span m="742950">the</span> <span m="743040">top,</span> <span m="743310">the</span> <span m="743390">first</span> <span m="743720">four,</span> <span m="744450">those</span> <span m="744660">are</span> <span m="744730">going</span> <span m="744860">to</span> <span m="744920">be</span> <span m="746170">our</span> <span m="746400">guesses</span> <span m="747460">about</span> <span m="748230">the</span> <span m="748350">distribution</span> <span m="749870">of</span> <span m="750600">the</span> <span m="751720">number</span> <span m="752140">of</span> <span m="752230">copies</span> <span m="752580">of</span> <span m="752680">a</span> <span m="752740">molecule</span> <span m="753320">in</span> <span m="753410">the</span> <span m="753550">original</span> <span m="754020">library.</span> <span m="756750">And</span> <span m="756830">we</span> <span m="756930">don't</span> <span m="757150">know</span> <span m="757270">what</span> <span m="757420">that</span> <span m="757590">is,</span> <span m="758030">right?</span> <span m="758210">That's</span> <span m="758470">something</span> <span m="758810">we</span> <span m="758940">can't</span> <span m="759210">directly</span> <span m="759660">observe,</span> <span m="761110">but</span> <span m="761380">imagine</span> <span m="761870">that</span> <span m="761950">we</span> <span m="762070">took</span> <span m="762550">that</span> <span m="762900">distribution</span> <span m="763640">and</span> <span m="763820">used</span> <span m="764180">it</span> <span m="764320">for</span> <span m="764430">lambda</span> <span m="766480">in</span> <span m="766770">our</span> <span m="767020">Poisson</span> <span m="767510">distribution</span> <span m="768110">down</span> <span m="768300">below</span> <span m="768560">for</span> <span m="768690">sampling.</span> </p>
<p><span m="769890">So</span> <span m="770020">we have</span> <span m="770130">one</span> <span m="770360">distribution</span> <span m="770980">over</span> <span m="771650">the</span> <span m="771770">number</span> <span m="771990">of</span> <span m="772060">each</span> <span m="772210">type</span> <span m="772460">of</span> <span m="772530">molecule</span> <span m="772970">we</span> <span m="773417">have</span> <span m="774311">and we</span> <span m="774760">have</span> <span m="774930">the</span> <span m="775030">Poisson</span> <span m="775570">for</span> <span m="775690">sampling</span> <span m="776220">from</span> <span m="776380">that,</span> <span m="777790">and</span> <span m="777990">we</span> <span m="778130">put</span> <span m="778710">those</span> <span m="778930">two</span> <span m="779120">together.</span> <span m="780910">And</span> <span m="780950">when</span> <span m="781080">we</span> <span m="781190">do</span> <span m="781410">that,</span> <span m="781860">we</span> <span m="781940">have</span> <span m="782100">the</span> <span m="782180">Poisson</span> <span m="782660">distribution</span> <span m="783480">at</span> <span m="783550">the</span> <span m="783640">top,</span> <span m="784610">the</span> <span m="784700">gamma</span> <span m="785060">distribution</span> <span m="785650">is</span> <span m="785790">what</span> <span m="785970">we'll</span> <span m="786140">use</span> <span m="786520">for</span> <span m="786770">representing</span> <span m="787890">the</span> <span m="788250">number</span> <span m="788590">of</span> <span m="788640">different</span> <span m="788930">species</span> <span m="789870">over</span> <span m="790100">here</span> <span m="790470">and</span> <span m="790640">their</span> <span m="790880">relative</span> <span m="791930">copy</span> <span m="792270">number.</span> <span m="793950">And</span> <span m="794030">when</span> <span m="794160">we</span> <span m="795410">actually</span> <span m="796750">put</span> <span m="796930">those</span> <span m="797200">together</span> <span m="798940">as</span> <span m="799090">shown,</span> <span m="799880">we</span> <span m="799970">wind</span> <span m="800190">up</span> <span m="800280">with</span> <span m="800370">what's</span> <span m="800550">called</span> <span m="800750">the</span> <span m="800810">negative</span> <span m="801200">binomial</span> <span m="801720">distribution,</span> <span m="803450">which</span> <span m="803520">is</span> <span m="803620">a</span> <span m="803670">more</span> <span m="803860">flexible</span> <span m="804330">distribution,</span> <span m="804830">it has</span> <span m="804970">two</span> <span m="805150">parameters.</span> </p>
<p><span m="807320">And</span> <span m="807540">that</span> <span m="807700">negative</span> <span m="808000">binomial</span> <span m="808430">distribution</span> <span m="809350">can</span> <span m="809500">be</span> <span m="809600">used,</span> <span m="810130">once</span> <span m="810350">again,</span> <span m="810640">to</span> <span m="810800">estimate</span> <span m="812600">our</span> <span m="813560">library</span> <span m="813980">complexity.</span> <span m="815910">And</span> <span m="815980">when</span> <span m="816110">we</span> <span m="816220">do</span> <span m="816460">so,</span> <span m="817160">we</span> <span m="817320">have</span> <span m="817530">lamba</span> <span m="817810">be</span> <span m="817970">the</span> <span m="818090">same,</span> <span m="818420">but</span> <span m="818640">k</span> <span m="818910">is</span> <span m="819020">a</span> <span m="819060">new</span> <span m="819230">parameter.</span> <span m="819565">It</span> <span m="819900">measures</span> <span m="820640">sort</span> <span m="820820">of</span> <span m="820860">the</span> <span m="820940">variance</span> <span m="821390">or</span> <span m="821450">dispersion</span> <span m="822950">of</span> <span m="823830">this</span> <span m="824060">original</span> <span m="824510">sequencing</span> <span m="824950">library.</span> <span m="826540">And</span> <span m="826670">then</span> <span m="826790">when</span> <span m="826920">we</span> <span m="827040">fit</span> <span m="827310">this</span> <span m="827490">negative</span> <span m="827880">binomial</span> <span m="828370">distribution</span> <span m="829010">to</span> <span m="829090">that</span> <span m="829320">1,000</span> <span m="829730">genomes</span> <span m="830160">data,</span> <span m="832660">it's</span> <span m="832910">going</span> <span m="833070">to</span> <span m="833130">be</span> <span m="833340">hopefully</span> <span m="833830">better.</span> <span m="835180">Let's</span> <span m="835350">start</span> <span m="835670">with</span> <span m="836120">a</span> <span m="836230">smaller</span> <span m="836850">example.</span> <span m="838340">If</span> <span m="838390">we</span> <span m="838490">have</span> <span m="838650">a</span> <span m="838710">library</span> <span m="839180">that's</span> <span m="839330">artificial</span> <span m="839950">with</span> <span m="840120">a</span> <span m="840590">known</span> <span m="840950">million</span> <span m="841280">unique</span> <span m="841570">molecules</span> <span m="842310">and</span> <span m="842480">we</span> <span m="843030">subsample,</span> <span m="843600">it</span> <span m="843700">gives</span> <span m="843880">you</span> <span m="843990">100,000</span> <span m="844710">reads,</span> <span m="845670">you</span> <span m="845810">can</span> <span m="845970">see</span> <span m="846200">that</span> <span m="847240">with</span> <span m="847490">different</span> <span m="847780">dispersions</span> <span m="848035">here</span> <span m="848290">in the</span> <span m="848510">left,</span> <span m="848980">k</span> <span m="849250">with</span> <span m="849410">different</span> <span m="849670">values from</span> <span m="850080">0.1</span> <span m="850480">to</span> <span m="850570">20,</span> <span m="851410">the</span> <span m="851550">Poisson</span> <span m="852570">begins</span> <span m="852890">to</span> <span m="852990">grossly</span> <span m="853560">underestimate</span> <span m="854150">the</span> <span m="854240">complexity</span> <span m="854780">of</span> <span m="854830">the</span> <span m="854900">library</span> <span m="855950">as</span> <span m="856110">the</span> <span m="856210">dispersion</span> <span m="856700">gets</span> <span m="856890">larger,</span> <span m="857730">whereas</span> <span m="858420">the</span> <span m="858490">negative</span> <span m="858780">binomial,</span> <span m="859270">otherwise</span> <span m="859660">known</span> <span m="859790">as</span> <span m="859860">the</span> <span m="860340">GP</span> <span m="860760">or</span> <span m="860840">gamma</span> <span m="861160">Poisson,</span> <span m="862090">does</span> <span m="862240">a</span> <span m="862290">much</span> <span m="862500">better</span> <span m="862720">job.</span> </p>
<p><span m="863560">And</span> <span m="863650">furthermore,</span> <span m="864780">when</span> <span m="864940">we</span> <span m="865060">look</span> <span m="865240">at</span> <span m="865330">this,</span> <span m="866860">in</span> <span m="868040">the</span> <span m="868130">context</span> <span m="868600">of</span> <span m="868740">the</span> <span m="869180">thousand</span> <span m="869510">genomes</span> <span m="869880">data,</span> <span m="870290">you</span> <span m="870510">can see</span> <span m="870680">when</span> <span m="870830">we</span> <span m="870950">fit</span> <span m="871220">this</span> <span m="871440">how</span> <span m="871620">much</span> <span m="871840">better</span> <span m="872180">we</span> <span m="873190">are</span> <span m="873360">doing.</span> <span m="874310">Almost</span> <span m="874620">all</span> <span m="874750">those</span> <span m="874930">points are</span> <span m="875240">almost</span> <span m="875510">exactly</span> <span m="875950">on</span> <span m="876120">the</span> <span m="876190">line,</span> <span m="877110">which</span> <span m="877220">means</span> <span m="877370">you</span> <span m="877460">can</span> <span m="877570">take</span> <span m="877720">a</span> <span m="877800">small</span> <span m="878250">sampling</span> <span m="878820">run</span> <span m="879890">and</span> <span m="880270">figure</span> <span m="880590">out</span> <span m="880720">from</span> <span m="880850">that</span> <span m="880990">sampling</span> <span m="881330">run</span> <span m="881550">how</span> <span m="881890">complex</span> <span m="882300">your</span> <span m="882420">library</span> <span m="883000">is.</span> <span m="884290">And</span> <span m="884410">that</span> <span m="884880">allows</span> <span m="885290">us</span> <span m="885670">to</span> <span m="885980">tell</span> <span m="886260">something</span> <span m="886560">very</span> <span m="886770">important,</span> <span m="887340">which</span> <span m="887400">is</span> <span m="887500">what</span> <span m="887690">is</span> <span m="887810">the</span> <span m="887890">marginal</span> <span m="888500">value</span> <span m="888910">of</span> <span m="889010">extra</span> <span m="889300">sequencing.</span> <span m="890950">So</span> <span m="891100">for</span> <span m="891260">example,</span> <span m="891600">if somebody</span> <span m="891850">comes</span> <span m="892110">to</span> <span m="892280">you</span> <span m="892460">and they say,</span> <span m="892540">well,</span> <span m="893530">I</span> <span m="893830">ran</span> <span m="894090">my</span> <span m="894230">experiment</span> <span m="895230">and</span> <span m="895580">all</span> <span m="895760">I</span> <span m="895830">could</span> <span m="895990">afford</span> <span m="896720">was</span> <span m="896910">50</span> <span m="897230">million</span> <span m="897560">reads.</span> <span m="897840">Do</span> <span m="898120">you</span> <span m="898240">think</span> <span m="898450">I</span> <span m="898500">should</span> <span m="898700">sequence</span> <span m="899170">more?</span> <span m="900100">Is</span> <span m="900290">there</span> <span m="900400">more</span> <span m="900720">information</span> <span m="901950">in</span> <span m="902070">my</span> <span m="902640">experimental</span> <span m="904370">DNA</span> <span m="904630">preparation?</span> </p>
<p><span m="906530">It's</span> <span m="906690">easy</span> <span m="906970">to</span> <span m="907070">tell</span> <span m="907370">now,</span> <span m="907590">right?</span> <span m="907890">Because</span> <span m="908140">you</span> <span m="908220">can</span> <span m="908350">actually</span> <span m="908610">analyze</span> <span m="909110">the</span> <span m="909200">distribution</span> <span m="909770">of</span> <span m="909810">the</span> <span m="909910">reads</span> <span m="910170">that they</span> <span m="910270">got</span> <span m="910880">and</span> <span m="911350">you</span> <span m="911500">can</span> <span m="911620">go</span> <span m="911780">back</span> <span m="912040">and</span> <span m="912210">you</span> <span m="912290">could</span> <span m="912480">estimate</span> <span m="913240">the</span> <span m="913340">marginal</span> <span m="913940">value</span> <span m="914410">of</span> <span m="914500">additional</span> <span m="914940">sequencing.</span> <span m="916180">And</span> <span m="916290">the</span> <span m="916370">way</span> <span m="916500">you</span> <span m="916740">do</span> <span m="916960">that</span> <span m="918290">is</span> <span m="918410">you</span> <span m="918500">go</span> <span m="918600">back</span> <span m="918820">to</span> <span m="918900">the</span> <span m="919970">distribution</span> <span m="920305">that</span> <span m="920640">you</span> <span m="920760">fit</span> <span m="921790">this</span> <span m="922030">negative</span> <span m="922350">binomial</span> <span m="923240">and</span> <span m="923430">ask</span> <span m="923660">if</span> <span m="923730">you</span> <span m="923820">have</span> <span m="924030">r</span> <span m="924270">more</span> <span m="924630">reads,</span> <span m="925320">how</span> <span m="925620">many</span> <span m="925890">more</span> <span m="926200">unique</span> <span m="926560">molecules</span> <span m="927280">are</span> <span m="927390">you</span> <span m="927470">going</span> <span m="927700">to</span> <span m="927760">get?</span> <span m="930330">And</span> <span m="931430">the</span> <span m="931800">answer</span> <span m="932270">is</span> <span m="934150">that</span> <span m="934770">you</span> <span m="934900">can</span> <span m="935040">see</span> <span m="935890">that</span> <span m="936580">if</span> <span m="936740">you</span> <span m="936970">imagine</span> <span m="937410">that</span> <span m="937680">this</span> <span m="937800">is</span> <span m="938120">artificial</span> <span m="940210">data,</span> <span m="941170">but</span> <span m="941470">if</span> <span m="941610">you</span> <span m="941740">imagine</span> <span m="942160">that you had a</span> <span m="942230">complexity</span> <span m="942730">of</span> <span m="942810">10</span> <span m="943020">to</span> <span m="943070">the</span> <span m="943180">6</span> <span m="943420">molecules,</span> <span m="945120">the</span> <span m="945260">number</span> <span m="945480">sequencing</span> <span m="945920">regions</span> <span m="946220">is on</span> <span m="946330">the</span> <span m="946440">x-axis,</span> <span m="947770">the</span> <span m="947870">number</span> <span m="948100">of</span> <span m="948220">observed</span> <span m="948800">distinct</span> <span m="949240">molecules</span> <span m="949750">is</span> <span m="949870">on</span> <span m="949980">the</span> <span m="950050">y-axis,</span> <span m="951550">and</span> <span m="951950">as</span> <span m="952380">you</span> <span m="952540">increase</span> <span m="953530">the</span> <span m="953660">sequencing</span> <span m="954170">depth,</span> <span m="954940">you</span> <span m="955040">get</span> <span m="955230">more</span> <span m="955670">and</span> <span m="955730">more</span> <span m="955940">back</span> <span m="956290">to</span> <span m="956360">the</span> <span m="956440">library.</span> </p>
<p><span m="957710">However,</span> <span m="958180">the</span> <span m="958320">important</span> <span m="958720">thing</span> <span m="958890">to</span> <span m="958950">note</span> <span m="959730">is</span> <span m="959900">that</span> <span m="960000">the</span> <span m="960080">more</span> <span m="960360">skewed</span> <span m="960950">the</span> <span m="961040">library</span> <span m="961700">is,</span> <span m="962615">the</span> <span m="963020">less</span> <span m="963300">benefit</span> <span m="963770">you</span> <span m="963890">get,</span> <span m="964430">right?</span> <span m="964660">So</span> <span m="964830">if</span> <span m="964900">you</span> <span m="965010">look</span> <span m="965150">at</span> <span m="965210">the</span> <span m="965290">various</span> <span m="965540">values</span> <span m="965830">of</span> <span m="965920">k,</span> <span m="966790">as</span> <span m="966940">k</span> <span m="967100">gets</span> <span m="967340">larger,</span> <span m="967710">the</span> <span m="968080">sort</span> <span m="968320">of</span> <span m="968360">the</span> <span m="968440">skewness</span> <span m="968950">of</span> <span m="969030">the</span> <span m="969110">library</span> <span m="969580">increases,</span> <span m="970700">and</span> <span m="970750">you</span> <span m="970840">can</span> <span m="970980">see</span> <span m="971160">that you</span> <span m="971270">get</span> <span m="971770">fewer</span> <span m="972130">unique</span> <span m="972410">molecules</span> <span m="973150">as</span> <span m="973420">you</span> <span m="973540">increase</span> <span m="974280">the</span> <span m="974380">sequencing</span> <span m="974880">depth.</span> <span m="976780">Now</span> <span m="976900">I</span> <span m="977010">mention</span> <span m="977380">this</span> <span m="977530">to</span> <span m="977640">you</span> <span m="977780">because</span> <span m="978710">it's</span> <span m="978890">important</span> <span m="979250">to</span> <span m="979320">think</span> <span m="981200">in</span> <span m="981350">a</span> <span m="981630">principled</span> <span m="982160">way</span> <span m="982560">about</span> <span m="983150">analyzing</span> <span m="983680">sequencing</span> <span m="984220">data.</span> <span m="984590">If</span> <span m="984790">somebody</span> <span m="984980">drops</span> <span m="985560">200</span> <span m="985820">million</span> <span m="986140">reads on</span> <span m="986410">your</span> <span m="986520">desk</span> <span m="987530">and</span> <span m="987680">says,</span> <span m="988390">can</span> <span m="988430">you</span> <span m="988490">help</span> <span m="988780">me</span> <span m="988880">with</span> <span m="989070">these,</span> <span m="990180">it's</span> <span m="990850">good</span> <span m="991090">to</span> <span m="991170">start</span> <span m="991440">with some</span> <span m="991560">fundamental</span> <span m="992060">questions,</span> <span m="992580">like</span> <span m="993320">just</span> <span m="993490">how</span> <span m="993710">complex</span> <span m="994090">is</span> <span m="994200">the</span> <span m="994330">original</span> <span m="994820">library</span> <span m="995990">and</span> <span m="996130">you</span> <span m="996260">think</span> <span m="996550">that these</span> <span m="996770">data</span> <span m="997000">are</span> <span m="997180">really</span> <span m="997390">good</span> <span m="998100">or</span> <span m="998250">not,</span> <span m="998940">OK?</span> </p>
<p><span m="1000370">Furthermore,</span> <span m="1000800">this</span> <span m="1000970">is</span> <span m="1001120">a</span> <span m="1001510">introduction</span> <span m="1002100">to</span> <span m="1002180">the</span> <span m="1002330">idea</span> <span m="1002750">that</span> <span m="1003190">certain</span> <span m="1003510">kinds</span> <span m="1003750">of</span> <span m="1003820">very</span> <span m="1004040">simplistic</span> <span m="1004560">models,</span> <span m="1005020">like</span> <span m="1005230">Poisson</span> <span m="1005640">models</span> <span m="1005910">of</span> <span m="1005980">sequencing</span> <span m="1006480">data</span> <span m="1007330">can</span> <span m="1007460">be</span> <span m="1007610">wrong</span> <span m="1008510">because</span> <span m="1008820">they're</span> <span m="1008920">not</span> <span m="1009130">adequately</span> <span m="1009600">taking</span> <span m="1010060">into</span> <span m="1010290">account</span> <span m="1010780">the</span> <span m="1010900">over</span> <span m="1011260">dispersion</span> <span m="1012720">of</span> <span m="1012910">the</span> <span m="1013060">original</span> <span m="1013410">sequencing</span> <span m="1013840">count</span> <span m="1014100">data.</span> <span m="1015620">OK,</span> <span m="1016070">so</span> <span m="1016200">that's</span> <span m="1016430">all</span> <span m="1016540">there</span> <span m="1016820">is</span> <span m="1016920">about</span> <span m="1017120">library</span> <span m="1017460">complexity.</span> <span m="1019480">Let's</span> <span m="1019720">move</span> <span m="1019920">on</span> <span m="1020080">now</span> <span m="1020320">to</span> <span m="1021610">questions</span> <span m="1022240">of</span> <span m="1024010">how</span> <span m="1024540">to</span> <span m="1024720">deal</span> <span m="1025050">with</span> <span m="1025210">these</span> <span m="1025680">reads</span> <span m="1026020">once</span> <span m="1026200">we</span> <span m="1026319">have</span> <span m="1026640">them.</span> <span m="1028619">So</span> <span m="1028790">the</span> <span m="1029160">fundamental</span> <span m="1029970">challenge</span> <span m="1030510">is</span> <span m="1031359">this.</span> </p>
<p><span m="1033890">I</span> <span m="1034069">hand</span> <span m="1034359">you</span> <span m="1034530">a</span> <span m="1034660">genome</span> <span m="1035290">like</span> <span m="1035450">human.</span> <span m="1039530">3</span> <span m="1039720">times</span> <span m="1039980">10</span> <span m="1040160">to</span> <span m="1040200">the</span> <span m="1040280">ninth</span> <span m="1040530">bases.</span> <span m="1042970">This</span> <span m="1043210">will</span> <span m="1043319">be</span> <span m="1043530">in</span> <span m="1046329">fast</span> <span m="1046660">a</span> <span m="1046750">format,</span> <span m="1047130">let's</span> <span m="1047349">say.</span> <span m="1048430">I</span> <span m="1048560">had</span> <span m="1048810">you</span> <span m="1049010">reads.</span> <span m="1051670">And</span> <span m="1051910">this</span> <span m="1052110">will be--</span> <span m="1052210">we'll</span> <span m="1052680">have,</span> <span m="1054160">say,</span> <span m="1054350">200</span> <span m="1054720">base</span> <span m="1054980">pairs</span> <span m="1055840">times</span> <span m="1058780">2</span> <span m="1059380">times</span> <span m="1060000">10</span> <span m="1060530">to</span> <span m="1060640">the</span> <span m="1062070">eighth</span> <span m="1063500">different</span> <span m="1064030">reads.</span> <span m="1065310">And</span> <span m="1065460">this</span> <span m="1065600">will</span> <span m="1065690">be</span> <span m="1065810">in</span> <span m="1065920">fast</span> <span m="1066310">q</span> <span m="1066450">format.</span> <span m="1070550">The</span> <span m="1070750">q</span> <span m="1071000">means</span> <span m="1071270">that there</span> <span m="1071380">are--</span> <span m="1071830">it's</span> <span m="1071920">like</span> <span m="1072080">fast a</span> <span m="1072580">except that our</span> <span m="1072900">quality</span> <span m="1073300">score's</span> <span m="1073750">associated</span> <span m="1074460">with</span> <span m="1074610">each</span> <span m="1075000">particular</span> <span m="1075560">base</span> <span m="1075820">position.</span> <span m="1077100">And</span> <span m="1078480">the</span> <span m="1078660">PHRED</span> <span m="1079030">score</span> <span m="1082550">which</span> <span m="1082800">is</span> <span m="1083100">typically</span> <span m="1083540">used</span> <span m="1083790">for</span> <span m="1083850">these</span> <span m="1083940">sorts</span> <span m="1084160">of</span> <span m="1084240">qualities,</span> <span m="1084700">is</span> <span m="1085570">minus</span> <span m="1086150">p</span> <span m="1088570">minus</span> <span m="1088990">10</span> <span m="1090090">times</span> <span m="1091330">log</span> <span m="1091480">base</span> <span m="1091680">10</span> <span m="1091960">of</span> <span m="1092040">the</span> <span m="1092120">probability</span> <span m="1092650">of</span> <span m="1092750">an</span> <span m="1092840">error.</span> </p>
<p><span m="1093870">Right,</span> <span m="1094120">so</span> <span m="1094600">a PHRED</span> <span m="1094950">score</span> <span m="1095320">of</span> <span m="1095490">10</span> <span m="1096400">means</span> <span m="1096670">that</span> <span m="1096750">there's</span> <span m="1096910">a</span> <span m="1096990">1</span> <span m="1097440">in</span> <span m="1097620">10</span> <span m="1097860">chance</span> <span m="1098200">that</span> <span m="1098270">the</span> <span m="1098360">bases</span> <span m="1098550">is</span> <span m="1098670">an</span> <span m="1098780">error,</span> <span m="1099180">a</span> <span m="1099620">PHRED</span> <span m="1099820">score of</span> <span m="1100090">20</span> <span m="1100490">means</span> <span m="1100680">it's</span> <span m="1100800">one in a</span> <span m="1100860">100,</span> <span m="1101580">and</span> <span m="1101700">so</span> <span m="1101850">forth.</span> <span m="1104470">And</span> <span m="1104610">then</span> <span m="1105270">the</span> <span m="1105390">goal</span> <span m="1105830">is</span> <span m="1106750">today</span> <span m="1108140">if</span> <span m="1108320">I</span> <span m="1108390">give</span> <span m="1108650">you</span> <span m="1108780">these</span> <span m="1109010">data</span> <span m="1109990">on</span> <span m="1110090">a</span> <span m="1110130">hard</span> <span m="1110430">drive,</span> <span m="1111770">your</span> <span m="1112440">job</span> <span m="1113040">would be</span> <span m="1113480">to</span> <span m="1113580">produce</span> <span m="1114080">a</span> <span m="1114170">SAM</span> <span m="1114580">file,</span> <span m="1116170">a</span> <span m="1116270">Sequence</span> <span m="1116680">Alignment</span> <span m="1117160">and</span> <span m="1117250">Mapping</span> <span m="1117590">file,</span> <span m="1118490">which</span> <span m="1118720">tells</span> <span m="1119160">us</span> <span m="1119450">where</span> <span m="1119730">all</span> <span m="1120050">these</span> <span m="1120290">reads</span> <span m="1120790">map</span> <span m="1121045">in</span> <span m="1121300">the</span> <span m="1121370">genome.</span> <span m="1124340">And</span> <span m="1125420">more</span> <span m="1125610">pictorially,</span> <span m="1127090">the</span> <span m="1127220">idea</span> <span m="1127600">is</span> <span m="1128010">that</span> <span m="1129150">there</span> <span m="1129310">are</span> <span m="1129420">many</span> <span m="1129700">different</span> <span m="1129980">reasons</span> <span m="1130320">why</span> <span m="1130460">we</span> <span m="1130610">want</span> <span m="1130840">to</span> <span m="1130940">do</span> <span m="1131080">this</span> <span m="1131240">mapping.</span> <span m="1132260">So</span> <span m="1132830">one</span> <span m="1133100">might</span> <span m="1133350">be</span> <span m="1133890">to</span> <span m="1134020">do</span> <span m="1134130">genotyping.</span> <span m="1135400">You</span> <span m="1135650">and</span> <span m="1135790">I</span> <span m="1135930">differ</span> <span m="1136360">in our</span> <span m="1136740">genomes</span> <span m="1136900">by</span> <span m="1137050">about</span> <span m="1137300">one</span> <span m="1137560">base</span> <span m="1137840">in</span> <span m="1137920">a</span> <span m="1137990">thousand.</span> <span m="1139470">So</span> <span m="1139530">if</span> <span m="1139610">I</span> <span m="1139680">sequence</span> <span m="1140080">your</span> <span m="1140240">genome</span> <span m="1140750">and</span> <span m="1141000">I map</span> <span m="1141280">it</span> <span m="1141340">back</span> <span m="1142060">or</span> <span m="1142180">align</span> <span m="1142440">it to</span> <span m="1142650">the</span> <span m="1143020">human</span> <span m="1143480">brain</span> <span m="1143750">reference</span> <span m="1144070">genome,</span> <span m="1144960">I'm</span> <span m="1145130">going</span> <span m="1145260">to</span> <span m="1145310">find</span> <span m="1145560">differences</span> <span m="1146010">between</span> <span m="1146350">your</span> <span m="1146540">genome</span> <span m="1147100">and</span> <span m="1147170">the</span> <span m="1147250">human</span> <span m="1147470">reference</span> <span m="1147870">genome.</span> </p>
<p><span m="1148320">And</span> <span m="1148450">you</span> <span m="1148540">can</span> <span m="1148660">see</span> <span m="1148900">how</span> <span m="1149060">this</span> <span m="1149230">is</span> <span m="1149340">done at</span> <span m="1149730">the</span> <span m="1149830">very</span> <span m="1149930">top</span> <span m="1150340">where</span> <span m="1150670">we</span> <span m="1150890">have</span> <span m="1151030">the</span> <span m="1151140">aligned</span> <span m="1151520">reads</span> <span m="1152280">and</span> <span m="1152420">there's</span> <span m="1152590">a</span> <span m="1152690">G,</span> <span m="1153060">let's</span> <span m="1153310">say,</span> <span m="1153620">in</span> <span m="1153820">the</span> <span m="1153920">sample</span> <span m="1154310">DNA,</span> <span m="1155480">and</span> <span m="1155620">there's</span> <span m="1155750">a C in</span> <span m="1156230">the</span> <span m="1156320">reference.</span> <span m="1157610">But</span> <span m="1157760">in</span> <span m="1157840">order</span> <span m="1158070">to</span> <span m="1158130">figure</span> <span m="1158380">out</span> <span m="1158440">where</span> <span m="1158550">the</span> <span m="1158660">differences</span> <span m="1159130">are,</span> <span m="1159720">we</span> <span m="1159870">have to</span> <span m="1159980">take</span> <span m="1160130">those</span> <span m="1160230">short</span> <span m="1160560">reads and</span> <span m="1161000">align</span> <span m="1161450">them</span> <span m="1161610">to</span> <span m="1162120">the</span> <span m="1162210">genome.</span> <span m="1164730">Another</span> <span m="1165730">kind</span> <span m="1166080">of</span> <span m="1166170">experimental</span> <span m="1166710">protocol</span> <span m="1167610">uses</span> <span m="1167990">DNA</span> <span m="1168290">fragments</span> <span m="1169160">that</span> <span m="1169310">are</span> <span m="1169510">representative</span> <span m="1170740">of</span> <span m="1170880">some</span> <span m="1171060">kind</span> <span m="1171240">of</span> <span m="1171310">biological</span> <span m="1171870">process.</span> <span m="1173490">So</span> <span m="1173640">here</span> <span m="1173910">the</span> <span m="1174000">DNA</span> <span m="1174540">being</span> <span m="1174800">produced</span> <span m="1175320">are</span> <span m="1175510">mapped</span> <span m="1175870">back</span> <span m="1176130">to</span> <span m="1176210">the</span> <span m="1176310">genome</span> <span m="1177070">to</span> <span m="1177210">look</span> <span m="1177390">for</span> <span m="1177830">areas</span> <span m="1178270">of</span> <span m="1178470">enrichment</span> <span m="1178930">or what</span> <span m="1179200">are sometimes</span> <span m="1179580">called</span> <span m="1179910">peaks.</span> </p>
<p><span m="1181330">And</span> <span m="1181480">there</span> <span m="1181630">we</span> <span m="1181750">want</span> <span m="1181980">to</span> <span m="1182060">actually</span> <span m="1182960">do</span> <span m="1183200">exactly</span> <span m="1183680">the</span> <span m="1183810">same</span> <span m="1184020">process,</span> <span m="1184910">but</span> <span m="1184950">the</span> <span m="1185030">post</span> <span m="1185360">processing</span> <span m="1185900">once</span> <span m="1186080">the</span> <span m="1186300">alignment</span> <span m="1186900">is</span> <span m="1187120">complete</span> <span m="1187550">is</span> <span m="1187760">different.</span> <span m="1190690">So</span> <span m="1191660">both</span> <span m="1192030">of</span> <span m="1192120">these</span> <span m="1193380">share</span> <span m="1193740">the</span> <span m="1193840">goal</span> <span m="1194370">of</span> <span m="1194510">taking</span> <span m="1195680">hundreds</span> <span m="1196290">of</span> <span m="1196420">millions</span> <span m="1196990">of</span> <span m="1197100">short</span> <span m="1197430">reads</span> <span m="1198620">and</span> <span m="1199130">aligning</span> <span m="1199710">them</span> <span m="1199960">to</span> <span m="1201460">a</span> <span m="1201620">very</span> <span m="1201970">large</span> <span m="1202290">genome.</span> <span m="1203480">And</span> <span m="1203630">you</span> <span m="1203690">heard</span> <span m="1203890">about</span> <span m="1204090">Smith</span> <span m="1204350">Waterman</span> <span m="1205110">from</span> <span m="1205300">Professor</span> <span m="1205720">Berg,</span> <span m="1206840">and</span> <span m="1206920">as</span> <span m="1207070">you</span> <span m="1207180">can</span> <span m="1207350">tell,</span> <span m="1207530">that</span> <span m="1207690">really</span> <span m="1208010">isn't</span> <span m="1208230">going</span> <span m="1208420">to</span> <span m="1208490">work,</span> <span m="1208780">because</span> <span m="1209630">its</span> <span m="1210950">time</span> <span m="1211250">complexity</span> <span m="1212380">is</span> <span m="1212550">not</span> <span m="1212750">going</span> <span m="1212860">to</span> <span m="1212920">be</span> <span m="1213430">admissible</span> <span m="1214050">for</span> <span m="1214180">hundreds</span> <span m="1214550">of</span> <span m="1214600">millions</span> <span m="1214920">of</span> <span m="1214990">reads.</span> </p>
<p><span m="1216760">So</span> <span m="1216910">we</span> <span m="1216990">need</span> <span m="1217150">to</span> <span m="1217230">come</span> <span m="1217390">up</span> <span m="1217490">with</span> <span m="1217630">a</span> <span m="1217660">different</span> <span m="1218090">way</span> <span m="1218950">of</span> <span m="1219110">approaching</span> <span m="1219880">this</span> <span m="1220130">problem.</span> <span m="1222510">So</span> <span m="1223860">finding</span> <span m="1224270">this</span> <span m="1224480">alignment</span> <span m="1224980">is</span> <span m="1225130">really</span> <span m="1226070">a</span> <span m="1226160">performance</span> <span m="1226670">bottleneck</span> <span m="1227620">for</span> <span m="1227790">many</span> <span m="1228530">computational</span> <span m="1229190">biology</span> <span m="1229600">problems</span> <span m="1230550">today.</span> <span m="1233310">And</span> <span m="1234840">we</span> <span m="1234970">have</span> <span m="1235140">to</span> <span m="1235240">talk</span> <span m="1235450">a</span> <span m="1235540">little</span> <span m="1235840">bit</span> <span m="1235980">about</span> <span m="1237340">what</span> <span m="1237510">we</span> <span m="1237640">mean</span> <span m="1237860">by</span> <span m="1238000">a</span> <span m="1238180">good</span> <span m="1238540">alignment,</span> <span m="1240150">because</span> <span m="1240590">we're</span> <span m="1240750">going</span> <span m="1240930">to</span> <span m="1240980">assume,</span> <span m="1241490">of</span> <span m="1241590">course,</span> <span m="1241760">fewer</span> <span m="1242030">mismatches</span> <span m="1242590">are</span> <span m="1242730">better.</span> <span m="1244240">And</span> <span m="1244480">we're</span> <span m="1244620">going</span> <span m="1244820">to</span> <span m="1244900">try</span> <span m="1245260">and</span> <span m="1245460">align</span> <span m="1245840">to</span> <span m="1245900">high</span> <span m="1246130">quality</span> <span m="1246560">bases</span> <span m="1246900">as</span> <span m="1247020">opposed</span> <span m="1247350">to</span> <span m="1247620">low</span> <span m="1247890">quality</span> <span m="1248230">bases</span> <span m="1250030">and</span> <span m="1250380">note</span> <span m="1250690">that</span> <span m="1250860">all</span> <span m="1251080">we</span> <span m="1251210">have</span> <span m="1252050">in</span> <span m="1252260">our</span> <span m="1252470">input</span> <span m="1252810">data</span> <span m="1253300">are</span> <span m="1253450">quality</span> <span m="1253950">scores</span> <span m="1254670">for</span> <span m="1254760">the</span> <span m="1254930">reads.</span> </p>
<p><span m="1256490">So</span> <span m="1256690">we</span> <span m="1257040">begin</span> <span m="1257670">with</span> <span m="1257830">an</span> <span m="1257920">assumption</span> <span m="1258450">that</span> <span m="1258720">the</span> <span m="1258820">genome</span> <span m="1259540">is</span> <span m="1260310">the</span> <span m="1260420">truth</span> <span m="1261770">and</span> <span m="1261890">when</span> <span m="1262050">we</span> <span m="1262170">are</span> <span m="1262330">aligning,</span> <span m="1263350">we</span> <span m="1263710">are</span> <span m="1263910">going</span> <span m="1264030">to</span> <span m="1264090">be</span> <span m="1264270">more</span> <span m="1264490">permissive</span> <span m="1265120">of</span> <span m="1265230">mismatches</span> <span m="1266060">in</span> <span m="1266460">read</span> <span m="1266740">locations</span> <span m="1267310">that</span> <span m="1267400">have</span> <span m="1267520">higher</span> <span m="1268760">likelihood</span> <span m="1269180">of</span> <span m="1269250">being</span> <span m="1269450">wrong.</span> <span m="1273910">So</span> <span m="1275850">is</span> <span m="1275970">everybody</span> <span m="1276480">OK</span> <span m="1276840">with</span> <span m="1276960">the</span> <span m="1277040">set</span> <span m="1277260">up</span> <span m="1277380">so</span> <span m="1277540">far?</span> <span m="1277820">You</span> <span m="1277900">understand</span> <span m="1278210">what</span> <span m="1278300">the</span> <span m="1278380">problem</span> <span m="1278800">is?</span> <span m="1280500">Yes,</span> <span m="1281560">all the way</span> <span m="1281810">in</span> <span m="1281940">the</span> <span m="1282010">back</span> <span m="1282240">row,</span> <span m="1282400">my</span> <span m="1282520">back</span> <span m="1282760">row</span> <span m="1282910">consultants,</span> <span m="1283790">you're</span> <span m="1283920">good</span> <span m="1284090">on</span> <span m="1284200">that?</span> <span m="1285015">See,</span> <span m="1285310">the</span> <span m="1285430">back</span> <span m="1285480">row</span> <span m="1285790">is</span> <span m="1285860">always</span> <span m="1286160">the</span> <span m="1286250">people</span> <span m="1286480">I</span> <span m="1286550">call on</span> <span m="1287090">for</span> <span m="1287410">consulting</span> <span m="1287940">advice,</span> <span m="1288350">right?</span> <span m="1288870">So</span> <span m="1290020">yeah.</span> <span m="1290890">You're</span> <span m="1291060">all good</span> <span m="1291120">back</span> <span m="1291280">there?</span> <span m="1292730">Good, I</span> <span m="1292860">like</span> <span m="1293060">that,</span> <span m="1293340">good,</span> <span m="1293680">that's</span> <span m="1293860">good,</span> <span m="1294050">I like</span> <span m="1294280">that,</span> <span m="1294620">OK.</span> </p>
<p><span m="1295350">All</span> <span m="1295430">right.</span> <span m="1297150">So</span> <span m="1298210">now</span> <span m="1298440">I'm</span> <span m="1298660">going</span> <span m="1298810">to</span> <span m="1298910">talk</span> <span m="1299220">to</span> <span m="1299430">you</span> <span m="1299530">about</span> <span m="1301396">what are</span> <span m="1301820">the</span> <span m="1302010">most</span> <span m="1302340">amazing</span> <span m="1302780">transforms</span> <span m="1303260">I</span> <span m="1303430">have</span> <span m="1303580">seen.</span> <span m="1305510">It's</span> <span m="1305680">called</span> <span m="1305960">the</span> <span m="1306590">Burrows</span> <span m="1307060">Wheeler</span> <span m="1307380">Transform.</span> <span m="1308860">And</span> <span m="1309100">it</span> <span m="1309260">is</span> <span m="1309870">a</span> <span m="1309960">transform</span> <span m="1310650">that</span> <span m="1310760">we</span> <span m="1310880">will</span> <span m="1311010">do</span> <span m="1311180">to</span> <span m="1311310">the</span> <span m="1311820">original</span> <span m="1312300">genome</span> <span m="1313280">that</span> <span m="1313420">allows</span> <span m="1313870">us</span> <span m="1313990">to</span> <span m="1314090">do</span> <span m="1315030">this</span> <span m="1315320">look</span> <span m="1315590">up</span> <span m="1315700">very,</span> <span m="1316140">very</span> <span m="1316280">quickly.</span> <span m="1317880">And</span> <span m="1318710">it's</span> <span m="1318900">worth</span> <span m="1319180">understanding.</span> <span m="1321570">So</span> <span m="1322230">here's</span> <span m="1322630">the</span> <span m="1322720">basic</span> <span m="1323120">idea</span> <span m="1323450">behind</span> <span m="1323740">the</span> <span m="1323800">Burrows</span> <span m="1324120">Wheeler</span> <span m="1324380">Transform.</span> <span m="1326760">We</span> <span m="1326890">take</span> <span m="1327090">the</span> <span m="1327260">original</span> <span m="1327760">string</span> <span m="1328420">that</span> <span m="1328560">we</span> <span m="1328690">want</span> <span m="1329030">to</span> <span m="1330190">use</span> <span m="1330660">as</span> <span m="1330860">our</span> <span m="1331070">target</span> <span m="1331510">that</span> <span m="1331600">we're</span> <span m="1331710">going</span> <span m="1331810">to</span> <span m="1331850">look</span> <span m="1332040">things</span> <span m="1332280">up</span> <span m="1332500">in,</span> <span m="1333000">OK,</span> <span m="1333340">so</span> <span m="1333550">this</span> <span m="1333740">is</span> <span m="1333870">going</span> <span m="1334040">to</span> <span m="1334100">be</span> <span m="1334600">the</span> <span m="1334710">dictionary</span> <span m="1335330">looking</span> <span m="1335590">things</span> <span m="1335780">up</span> <span m="1335920">in</span> <span m="1336310">and it's</span> <span m="1336420">going to</span> <span m="1336560">be</span> <span m="1336660">the</span> <span m="1336760">genome</span> <span m="1337200">sequence.</span> </p>
<p><span m="1338670">And</span> <span m="1338800">you</span> <span m="1338870">can</span> <span m="1338990">see</span> <span m="1339170">the</span> <span m="1339270">sequence</span> <span m="1339630">on</span> <span m="1339700">the</span> <span m="1339790">left</span> <span m="1340030">hand</span> <span m="1340300">side,</span> <span m="1340810">ACA,</span> <span m="1342880">ACG,</span> <span m="1343240">and</span> <span m="1343500">the</span> <span m="1343580">dollar</span> <span m="1343950">sign</span> <span m="1344240">represents</span> <span m="1344760">the</span> <span m="1344880">end of</span> <span m="1345165">string</span> <span m="1345450">terminator.</span> <span m="1347270">OK.</span> <span m="1349180">Now</span> <span m="1349280">here's</span> <span m="1349510">what</span> <span m="1349620">we're</span> <span m="1349740">going</span> <span m="1349920">to</span> <span m="1350000">do.</span> <span m="1350380">We</span> <span m="1350500">take</span> <span m="1350750">all</span> <span m="1351460">possible</span> <span m="1352970">rotations</span> <span m="1354600">of</span> <span m="1354770">this</span> <span m="1354910">string,</span> <span m="1356610">OK?</span> <span m="1358730">And</span> <span m="1358910">we're</span> <span m="1359040">going</span> <span m="1359260">to</span> <span m="1359380">sort</span> <span m="1359770">them.</span> <span m="1361900">And</span> <span m="1362140">the</span> <span m="1362210">result</span> <span m="1362640">of</span> <span m="1362700">sorting</span> <span m="1363600">all</span> <span m="1363840">the</span> <span m="1363920">rotations</span> <span m="1364550">is</span> <span m="1364650">shown</span> <span m="1365030">in</span> <span m="1365160">the</span> <span m="1365240">next</span> <span m="1366050">block</span> <span m="1366420">of</span> <span m="1366530">characters.</span> <span m="1368170">And</span> <span m="1368590">you</span> <span m="1368670">can</span> <span m="1368780">see</span> <span m="1368930">that</span> <span m="1369060">the</span> <span m="1369960">end of</span> <span m="1370245">string</span> <span m="1370530">character</span> <span m="1371220">has</span> <span m="1371400">the</span> <span m="1371650">shortest</span> <span m="1372340">sorting</span> <span m="1373320">order,</span> <span m="1374630">followed</span> <span m="1374870">by</span> <span m="1375050">A,</span> <span m="1375466">C, and G</span> <span m="1377350">and</span> <span m="1377560">that</span> <span m="1377700">all</span> <span m="1377940">the</span> <span m="1378020">strings</span> <span m="1378330">are</span> <span m="1378420">ordered</span> <span m="1378700">lexically</span> <span m="1379180">by</span> <span m="1379370">all</span> <span m="1379610">of</span> <span m="1379690">their</span> <span m="1379810">letters.</span> </p>
<p><span m="1381510">So</span> <span m="1381680">once</span> <span m="1381870">again,</span> <span m="1382620">we</span> <span m="1382800">take</span> <span m="1383010">the</span> <span m="1383150">original</span> <span m="1383670">input</span> <span m="1384000">string,</span> <span m="1385760">we</span> <span m="1386060">do</span> <span m="1386230">all</span> <span m="1386570">of the</span> <span m="1386610">possible</span> <span m="1387090">rotations</span> <span m="1387670">of</span> <span m="1387810">it,</span> <span m="1389070">and</span> <span m="1389210">then</span> <span m="1389300">we</span> <span m="1389390">sort</span> <span m="1389760">them</span> <span m="1390540">and</span> <span m="1390730">wind</span> <span m="1390980">up</span> <span m="1391130">with</span> <span m="1391430">this</span> <span m="1392040">Burrows</span> <span m="1392510">Wheeler</span> <span m="1392820">Matrix</span> <span m="1393230">as</span> <span m="1393350">it's</span> <span m="1393490">called</span> <span m="1393830">in this</span> <span m="1393880">slide,</span> <span m="1395810">OK?</span> <span m="1398020">And</span> <span m="1398210">we</span> <span m="1398570">take</span> <span m="1398820">the</span> <span m="1399080">last</span> <span m="1399550">column</span> <span m="1400070">of</span> <span m="1400210">that</span> <span m="1400400">matrix</span> <span m="1401700">and</span> <span m="1401930">that</span> <span m="1402190">is</span> <span m="1402400">the</span> <span m="1402490">Burrows</span> <span m="1402900">Wheeler</span> <span m="1403260">Transform.</span> <span m="1405140">Now</span> <span m="1405570">yo</span> <span m="1405740">might</span> <span m="1405980">say,</span> <span m="1406890">what</span> <span m="1407530">on</span> <span m="1407760">earth</span> <span m="1408030">is</span> <span m="1408190">going</span> <span m="1408420">on</span> <span m="1408640">here?</span> <span m="1409650">Why</span> <span m="1409870">would</span> <span m="1410050">you</span> <span m="1410160">want</span> <span m="1410410">to</span> <span m="1410490">take</span> <span m="1410710">a</span> <span m="1410790">string</span> <span m="1412500">or</span> <span m="1412660">even</span> <span m="1412940">an</span> <span m="1413060">entire</span> <span m="1413500">genome?</span> <span m="1414280">We</span> <span m="1414710">actually</span> <span m="1415080">do</span> <span m="1415260">this on</span> <span m="1415440">entire</span> <span m="1415980">genomes,</span> <span m="1417000">OK?</span> <span m="1418520">Consider</span> <span m="1418970">all</span> <span m="1419290">the</span> <span m="1419400">rotations</span> <span m="1419990">of</span> <span m="1420130">it,</span> <span m="1420920">sort</span> <span m="1421330">them,</span> <span m="1421810">and</span> <span m="1421920">then</span> <span m="1422040">take</span> <span m="1422230">the</span> <span m="1422330">last</span> <span m="1422730">column</span> <span m="1423190">of</span> <span m="1423280">that</span> <span m="1423440">matrix.</span> <span m="1425300">What</span> <span m="1425540">could</span> <span m="1425670">that</span> <span m="1425840">be</span> <span m="1425960">doing,</span> <span m="1426760">OK?</span> </p>
<p><span m="1428130">Here's</span> <span m="1428440">a</span> <span m="1428480">bit</span> <span m="1428810">of</span> <span m="1428900">intuition</span> <span m="1429440">for</span> <span m="1429660">you.</span> <span m="1430150">The</span> <span m="1430410">intuition</span> <span m="1430940">is</span> <span m="1431290">that</span> <span m="1431695">that</span> <span m="1432100">Burrows</span> <span m="1432390">Wheeler</span> <span m="1432650">Matrix</span> <span m="1433090">is</span> <span m="1433290">representing</span> <span m="1433950">all</span> <span m="1434280">of</span> <span m="1434430">the</span> <span m="1434540">suffixes</span> <span m="1435930">of</span> <span m="1436120">t.</span> <span m="1437840">OK,</span> <span m="1438120">so</span> <span m="1438250">all</span> <span m="1438510">the</span> <span m="1438680">red</span> <span m="1438940">things</span> <span m="1439700">are</span> <span m="1439860">suffixes</span> <span m="1440570">of</span> <span m="1440720">t</span> <span m="1441890">in</span> <span m="1441990">the</span> <span m="1442070">matrix.</span> <span m="1444380">And</span> <span m="1444760">when</span> <span m="1444980">we</span> <span m="1445110">are</span> <span m="1445260">going</span> <span m="1445420">to</span> <span m="1445460">be</span> <span m="1445580">matching</span> <span m="1446080">a</span> <span m="1446220">read,</span> <span m="1447150">we're</span> <span m="1447280">going</span> <span m="1447360">to</span> <span m="1447400">be</span> <span m="1447580">matched</span> <span m="1447950">it</span> <span m="1448710">from</span> <span m="1449000">its</span> <span m="1449280">end</span> <span m="1449660">going</span> <span m="1450400">towards</span> <span m="1450770">the</span> <span m="1450820">beginning</span> <span m="1451250">of</span> <span m="1451330">it,</span> <span m="1451650">so we'll</span> <span m="1451700">be</span> <span m="1451800">matching</span> <span m="1452130">suffixes</span> <span m="1452690">of</span> <span m="1452840">it.</span> <span m="1453210">And</span> <span m="1453290">I'm</span> <span m="1453360">going</span> <span m="1453530">to</span> <span m="1453580">show</span> <span m="1453780">you</span> <span m="1454010">a</span> <span m="1454030">very</span> <span m="1454420">neat</span> <span m="1454700">way</span> <span m="1455610">of</span> <span m="1455730">using</span> <span m="1456010">this</span> <span m="1456140">transform</span> <span m="1456820">to</span> <span m="1456930">do</span> <span m="1457230">matching</span> <span m="1457750">very</span> <span m="1458040">efficiently.</span> <span m="1459700">But</span> <span m="1460050">before</span> <span m="1460380">I</span> <span m="1460430">do</span> <span m="1460660">that,</span> <span m="1461740">I</span> <span m="1461760">want</span> <span m="1462040">you</span> <span m="1462190">to</span> <span m="1462530">observe</span> <span m="1463330">that</span> <span m="1464320">it's</span> <span m="1464580">not</span> <span m="1464920">complicated.</span> </p>
<p><span m="1466500">All</span> <span m="1466730">we</span> <span m="1466850">do</span> <span m="1467200">is</span> <span m="1467390">we</span> <span m="1467590">take</span> <span m="1467780">all</span> <span m="1467960">the</span> <span m="1468040">possible</span> <span m="1468400">rotations</span> <span m="1469010">and</span> <span m="1469120">we</span> <span m="1469210">sort</span> <span m="1469530">them</span> <span m="1470210">and</span> <span m="1470280">we</span> <span m="1470380">come</span> <span m="1470600">up</span> <span m="1470870">with</span> <span m="1471030">this</span> <span m="1471210">transform.</span> <span m="1473710">Yes.</span> </p>
<p><span m="1475530">AUDIENCE: What are you</span> <span m="1475760">sorting them</span> <span m="1476140">based</span> <span m="1476440">on?</span> </p>
<p><span m="1477206">PROFESSOR: OK, what</span> <span m="1477560">was your</span> <span m="1477780">name</span> <span m="1478220">again?</span> </p>
<p><span m="1478580">AUDIENCE: I'm Samona.</span> </p>
<p><span m="1479440">PROFESSOR: Samona.</span> <span m="1480740">What</span> <span m="1480910">are</span> <span m="1480960">we</span> <span m="1481070">sorting them</span> <span m="1481480">based</span> <span m="1481740">upon?</span> <span m="1482910">We're</span> <span m="1483050">just</span> <span m="1483190">sorting them</span> <span m="1483550">alphabetically.</span> </p>
<p><span m="1484576">AUDIENCE: OK.</span> </p>
<p><span m="1485290">PROFESSOR: So</span> <span m="1486100">you</span> <span m="1486260">can</span> <span m="1486400">see</span> <span m="1486710">that</span> <span m="1486880">if</span> <span m="1487160">dollar</span> <span m="1487490">sign</span> <span m="1487800">is</span> <span m="1487910">the</span> <span m="1488020">lowest</span> <span m="1488420">alphabetical</span> <span m="1488970">character,</span> <span m="1490020">that</span> <span m="1492230">if</span> <span m="1492300">you</span> <span m="1492360">consider</span> <span m="1492610">each</span> <span m="1492760">one</span> <span m="1492880">a</span> <span m="1492940">word,</span> <span m="1493300">that</span> <span m="1493360">they're</span> <span m="1493570">sorted</span> <span m="1493880">alphabetically,</span> <span m="1495190">OK?</span> <span m="1495910">So</span> <span m="1496070">we</span> <span m="1496170">have</span> <span m="1496780">seven</span> <span m="1497160">characters</span> <span m="1497670">in</span> <span m="1497770">each</span> <span m="1497960">row</span> <span m="1498740">and</span> <span m="1498860">we</span> <span m="1498960">sort</span> <span m="1499200">them</span> <span m="1499340">alphabetically.</span> <span m="1502070">Or</span> <span m="1502160">a</span> <span m="1502210">lexically.</span> <span m="1504570">Good</span> <span m="1504720">question.</span> <span m="1505520">Any</span> <span m="1505590">other</span> <span m="1505710">questions</span> <span m="1506070">like</span> <span m="1506240">that?</span> <span m="1506840">This</span> <span m="1506990">is</span> <span m="1507100">a</span> <span m="1507160">great</span> <span m="1507600">time</span> <span m="1507790">to</span> <span m="1507840">ask</span> <span m="1508020">questions,</span> <span m="1508430">because</span> <span m="1508680">what's</span> <span m="1508880">going</span> <span m="1509020">to</span> <span m="1509060">happen</span> <span m="1509850">is</span> <span m="1510030">that</span> <span m="1510740">in</span> <span m="1510890">about</span> <span m="1511120">the</span> <span m="1511200">next</span> <span m="1511540">three</span> <span m="1511820">minutes</span> <span m="1512150">if</span> <span m="1512260">you</span> <span m="1512370">lose</span> <span m="1512800">your</span> <span m="1513100">attention</span> <span m="1513510">span</span> <span m="1513760">of</span> <span m="1513810">about</span> <span m="1514040">10</span> <span m="1514230">seconds,</span> <span m="1514680">you're</span> <span m="1514700">going</span> <span m="1514820">to</span> <span m="1514860">look</span> <span m="1515040">up</span> <span m="1515150">and you'll</span> <span m="1515320">say,</span> <span m="1515510">what</span> <span m="1515680">just</span> <span m="1515920">happened?</span> <span m="1517770">Yes.</span> </p>
<p><span m="1518300">AUDIENCE: Could</span> <span m="1518780">you explain the</span> <span m="1519260">suffixes</span> <span m="1519740">of</span> <span m="1520220">t?</span> </p>
<p><span m="1521180">PROFESSOR: The</span> <span m="1521270">suffixes</span> <span m="1521760">of</span> <span m="1521930">t?</span> <span m="1522640">Sure.</span> <span m="1524530">Let's</span> <span m="1524700">talk</span> <span m="1524880">about</span> <span m="1525130">the</span> <span m="1525200">suffixes</span> <span m="1525700">of</span> <span m="1525820">tr.</span> <span m="1526650">They're</span> <span m="1526800">all</span> <span m="1527080">of the</span> <span m="1527190">things</span> <span m="1527460">that</span> <span m="1527725">end</span> <span m="1527990">t.</span> <span m="1528670">So a</span> <span m="1528880">suffix</span> <span m="1529230">of</span> <span m="1529290">t</span> <span m="1529460">would</span> <span m="1529600">be</span> <span m="1529740">G,</span> <span m="1531160">or</span> <span m="1531460">CG,</span> <span m="1532540">or</span> <span m="1532720">ACG,</span> <span m="1533970">or</span> <span m="1534420">AACG,</span> <span m="1535400">or</span> <span m="1535600">CAACG,</span> <span m="1536960">or</span> <span m="1537390">the</span> <span m="1537520">entire</span> <span m="1537810">string</span> <span m="1538090">t.</span> <span m="1538640">Those</span> <span m="1538820">are</span> <span m="1538930">all</span> <span m="1539210">of the</span> <span m="1539390">endings</span> <span m="1539850">of</span> <span m="1540210">t.</span> <span m="1540790">And if</span> <span m="1540980">you</span> <span m="1541110">look</span> <span m="1541330">over</span> <span m="1542100">on</span> <span m="1542270">the</span> <span m="1542400">right,</span> <span m="1542630">you</span> <span m="1542700">can</span> <span m="1542810">see</span> <span m="1542960">all</span> <span m="1543220">of those</span> <span m="1543350">suffixes</span> <span m="1543800">in</span> <span m="1543940">red.</span> <span m="1546760">So</span> <span m="1546940">one</span> <span m="1547140">way</span> <span m="1547260">to</span> <span m="1547360">think</span> <span m="1547600">about</span> <span m="1547870">this</span> <span m="1548130">is</span> <span m="1548290">that</span> <span m="1548420">it's</span> <span m="1548640">sorting</span> <span m="1549540">all</span> <span m="1549830">of</span> <span m="1549920">the</span> <span m="1549990">suffixes</span> <span m="1550790">of</span> <span m="1550970">t</span> <span m="1551890">in</span> <span m="1552000">that</span> <span m="1552170">matrix.</span> <span m="1554730">Because</span> <span m="1555060">the</span> <span m="1555220">rotations</span> <span m="1555840">are</span> <span m="1556000">exposing</span> <span m="1556680">the</span> <span m="1556780">suffixes,</span> <span m="1558130">right,</span> <span m="1559660">is</span> <span m="1559750">what's</span> <span m="1559920">going</span> <span m="1560130">on.</span> <span m="1561380">Does</span> <span m="1561530">that</span> <span m="1561590">make</span> <span m="1561760">sense</span> <span m="1562000">to</span> <span m="1562080">you?</span> <span m="1565390">Now keep me</span> <span m="1565720">honest</span> <span m="1566060">here in a</span> <span m="1566420">minute,</span> <span m="1566720">OK,</span> <span m="1567180">you'll</span> <span m="1567320">help</span> <span m="1567460">me</span> <span m="1567600">out?</span> <span m="1568280">Yes.</span> <span m="1569290">Your name</span> <span m="1569430">first?</span> </p>
<p><span m="1570010">AUDIENCE: [INAUDIBLE].</span> <span m="1571260">[INAUDIBLE].</span> </p>
<p><span m="1571900">PROFESSOR: [INAUDIBLE].</span> </p>
<p><span m="1572705">AUDIENCE: What is dollar</span> <span m="1573040">sign?</span> </p>
<p><span m="1573910">PROFESSOR: Dollar</span> <span m="1574160">sign</span> <span m="1574630">is</span> <span m="1574910">the</span> <span m="1575620">end of</span> <span m="1575905">string</span> <span m="1576190">character</span> <span m="1577050">which</span> <span m="1577260">has</span> <span m="1577560">the</span> <span m="1577650">lowest</span> <span m="1578060">lexical</span> <span m="1578480">sorting</span> <span m="1579100">order.</span> <span m="1580010">So</span> <span m="1580160">it's</span> <span m="1580270">marking</span> <span m="1580630">the</span> <span m="1580810">end</span> <span m="1581040">of</span> <span m="1581140">t.</span> <span m="1582690">That's</span> <span m="1582850">how</span> <span m="1582940">we</span> <span m="1583050">know</span> <span m="1583630">that</span> <span m="1583740">we're</span> <span m="1584000">at</span> <span m="1584130">the</span> <span m="1584290">end</span> <span m="1584510">of</span> <span m="1584600">t.</span> <span m="1586300">Good</span> <span m="1586420">question.</span> <span m="1586760">Yes.</span> </p>
<p><span m="1587667">AUDIENCE: Can</span> <span m="1588154">you sort</span> <span m="1588641">them</span> <span m="1589128">non-alphabetically,</span> <span m="1590102">just</span> <span m="1590589">different</span> <span m="1591076">ways to sort</span> <span m="1591563">them</span> <span m="1592050">[INAUDIBLE]</span> <span m="1593511">algorithm?</span> </p>
<p><span m="1594490">PROFESSOR: The question is,</span> <span m="1594900">can</span> <span m="1595310">you</span> <span m="1595460">sort</span> <span m="1595730">them</span> <span m="1595780">non</span> <span m="1596190">alphabetically.</span> <span m="1598440">You</span> <span m="1598610">can</span> <span m="1598770">sort</span> <span m="1599050">them</span> <span m="1599170">any way</span> <span m="1599490">as</span> <span m="1599580">long</span> <span m="1599770">as</span> <span m="1599840">it's</span> <span m="1599970">consistent,</span> <span m="1601270">OK.</span> <span m="1602076">But</span> <span m="1603320">let's</span> <span m="1603490">stick</span> <span m="1603680">with</span> <span m="1603820">alphabetical</span> <span m="1604400">lexical</span> <span m="1604740">order</span> <span m="1604980">today.</span> <span m="1605190">It's</span> <span m="1605450">really</span> <span m="1605680">simple</span> <span m="1606110">and</span> <span m="1606280">it's</span> <span m="1606400">all</span> <span m="1606590">you</span> <span m="1606680">need.</span> <span m="1607150">Yes.</span> <span m="1612460">in</span> <span m="1612954">red</span> <span m="1613448">is the</span> <span m="1613942">suffixes</span> <span m="1614436">in</span> <span m="1614930">the</span> <span m="1615424">last</span> <span m="1615918">colored</span> <span m="1616412">group</span> <span m="1616906">on the</span> <span m="1617400">right?</span> </p>
<p><span m="1618388">PROFESSOR: No, no.</span> </p>
<p><span m="1618882">AUDIENCE: What's in</span> <span m="1619376">red?</span> </p>
<p><span m="1619870">PROFESSOR: What's</span> <span m="1620364">in red</span> <span m="1620858">are all the</span> <span m="1621352">suffixes of T</span> <span m="1621860">on the very</span> <span m="1622060">far</span> <span m="1622280">left.</span> <span m="1622690">OK?</span> </p>
<p><span m="1624052">AUDIENCE: On the</span> <span m="1624524">right,</span> <span m="1624996">last</span> <span m="1625468">column</span> <span m="1625940">group?</span> </p>
<p><span m="1626412">PROFESSOR: The</span> <span m="1626884">right</span> <span m="1627356">last column</span> <span m="1627830">group.</span> <span m="1628390">That</span> <span m="1628680">last</span> <span m="1628960">column</span> <span m="1629250">in</span> <span m="1629340">red,</span> <span m="1629740">that</span> <span m="1630030">is</span> <span m="1630160">the</span> <span m="1630240">Burrows-Wheeler</span> <span m="1630810">Transform,</span> <span m="1631350">read</span> <span m="1631510">from</span> <span m="1631680">top</span> <span m="1631920">to</span> <span m="1631990">bottom.</span> <span m="1633270">OK?</span> <span m="1633940">And</span> <span m="1634090">I</span> <span m="1634150">know</span> <span m="1634290">you're</span> <span m="1634430">looking</span> <span m="1634740">at</span> <span m="1634810">that</span> <span m="1634950">and</span> <span m="1635040">saying,</span> <span m="1635360">how</span> <span m="1635580">could</span> <span m="1635710">that</span> <span m="1635840">possibly</span> <span m="1636300">be</span> <span m="1636450">useful?</span> <span m="1637300">We've</span> <span m="1637490">taken</span> <span m="1637800">our</span> <span m="1637890">genome.</span> <span m="1638610">We've</span> <span m="1638760">shifted</span> <span m="1639180">it</span> <span m="1639270">all around.</span> <span m="1639610">We've</span> <span m="1639700">sorted</span> <span m="1640160">it,</span> <span m="1640170">we</span> <span m="1640290">take</span> <span m="1640420">this</span> <span m="1640570">last</span> <span m="1640910">thing.</span> <span m="1641390">It</span> <span m="1641530">looks</span> <span m="1641730">like</span> <span m="1641930">junk</span> <span m="1642200">to</span> <span m="1642300">me,</span> <span m="1643250">right?</span> </p>
<p><span m="1644070">But</span> <span m="1644490">you're</span> <span m="1644600">going</span> <span m="1644700">to</span> <span m="1644750">find</span> <span m="1645080">out</span> <span m="1645310">that</span> <span m="1645890">all</span> <span m="1646140">of</span> <span m="1646250">the</span> <span m="1646400">information</span> <span m="1646960">in</span> <span m="1647030">the</span> <span m="1647110">genome</span> <span m="1647430">is</span> <span m="1647570">contained</span> <span m="1648170">in</span> <span m="1648260">that</span> <span m="1648420">last</span> <span m="1648710">string</span> <span m="1648970">in</span> <span m="1649060">a</span> <span m="1649120">very</span> <span m="1649480">handy</span> <span m="1649830">way.</span> <span m="1650550">Hard</span> <span m="1650850">to</span> <span m="1650910">believe</span> <span m="1651240">but</span> <span m="1651380">true.</span> <span m="1652410">Hard</span> <span m="1652700">to</span> <span m="1652770">believe</span> <span m="1652990">but true.</span> <span m="1653420">Yes.</span> <span m="1655070">Prepare</span> <span m="1655380">to</span> <span m="1655450">be</span> <span m="1655590">amazed,</span> <span m="1656190">all</span> <span m="1656270">right?</span> </p>
<p><span m="1658220">These</span> <span m="1658360">are</span> <span m="1658490">all</span> <span m="1658560">great</span> <span m="1658770">questions.</span> <span m="1659100">Any</span> <span m="1659350">other</span> <span m="1659490">questions</span> <span m="1659870">of</span> <span m="1659950">this</span> <span m="1660050">sort?</span> <span m="1661905">.</span> <span m="1662370">OK.</span> <span m="1663240">So,</span> <span m="1665780">I'm</span> <span m="1665910">going</span> <span m="1666000">to</span> <span m="1666040">make</span> <span m="1666200">a</span> <span m="1666240">very</span> <span m="1666820">important</span> <span m="1667180">observation</span> <span m="1667780">here</span> <span m="1668500">that</span> <span m="1671190">is</span> <span m="1671310">going</span> <span m="1671430">to</span> <span m="1671480">be</span> <span m="1671580">crucial</span> <span m="1672070">for</span> <span m="1672180">your</span> <span m="1672390">understanding.</span> <span m="1672960">So</span> <span m="1673060">I</span> <span m="1673190">have</span> <span m="1673410">reproduced</span> <span m="1673990">the</span> <span m="1674070">matrix</span> <span m="1675290">down</span> <span m="1675590">on</span> <span m="1675730">this</span> <span m="1675980">blackboard.</span> <span m="1677830">What?</span> <span m="1679570">That's</span> <span m="1679760">usually</span> <span m="1680130">there</span> <span m="1680430">under</span> <span m="1680470">that</span> <span m="1680870">board,</span> <span m="1681070">you</span> <span m="1681180">know</span> <span m="1681320">that.</span> <span m="1681995">You guys</span> <span m="1682440">haven't</span> <span m="1682640">checked</span> <span m="1682860">this</span> <span m="1682980">classroom</span> <span m="1683360">before,</span> <span m="1683830">have you?</span> <span m="1684250">No.</span> <span m="1684420">It's</span> <span m="1684890">always</span> <span m="1685180">there.</span> <span m="1686746">It's</span> <span m="1687180">such</span> <span m="1687370">a</span> <span m="1687440">handy</span> <span m="1687700">transform.</span> </p>
<p><span m="1689760">So</span> <span m="1690160">this</span> <span m="1690500">is</span> <span m="1690610">the</span> <span m="1690700">same</span> <span m="1690970">matrix</span> <span m="1691330">as</span> <span m="1691430">the</span> <span m="1691510">matrix</span> <span m="1691800">you</span> <span m="1691880">see</span> <span m="1692080">on</span> <span m="1692160">the</span> <span m="1692260">right.</span> <span m="1693350">I'm going to</span> <span m="1693670">make</span> <span m="1693890">a</span> <span m="1693930">very,</span> <span m="1694720">very</span> <span m="1695110">important</span> <span m="1695600">assertion</span> <span m="1696040">right</span> <span m="1696250">now.</span> <span m="1696900">OK?</span> <span m="1697410">The</span> <span m="1697870">very</span> <span m="1698220">important</span> <span m="1698630">assertion</span> <span m="1699160">is</span> <span m="1699950">that</span> <span m="1701910">if</span> <span m="1702230">you</span> <span m="1702450">consider</span> <span m="1705220">that</span> <span m="1705470">this</span> <span m="1705930">is</span> <span m="1706150">the</span> <span m="1706240">first</span> <span m="1706750">a</span> <span m="1707880">in</span> <span m="1708030">the</span> <span m="1708150">last</span> <span m="1708490">column</span> <span m="1709820">that</span> <span m="1710040">is</span> <span m="1710190">the</span> <span m="1710310">same</span> <span m="1710960">textual</span> <span m="1711500">occurrence</span> <span m="1712020">in</span> <span m="1712150">the</span> <span m="1712240">string</span> <span m="1713210">as</span> <span m="1713680">the</span> <span m="1713790">first</span> <span m="1714150">a</span> <span m="1714850">in</span> <span m="1715410">the</span> <span m="1715510">first</span> <span m="1715840">column.</span> <span m="1717720">And</span> <span m="1718070">this</span> <span m="1718350">is</span> <span m="1718480">the</span> <span m="1718600">second</span> <span m="1719250">a</span> <span m="1719560">in</span> <span m="1719870">the</span> <span m="1720200">last</span> <span m="1720490">column,</span> <span m="1721230">that's</span> <span m="1721460">the</span> <span m="1721560">same</span> <span m="1721960">as</span> <span m="1722130">the</span> <span m="1722220">second</span> <span m="1722530">a</span> <span m="1722660">in</span> <span m="1722780">the</span> <span m="1722850">first</span> <span m="1723130">column.</span> <span m="1723930">And you're</span> <span m="1724100">going to</span> <span m="1724210">say,</span> <span m="1724310">what</span> <span m="1724550">does</span> <span m="1724710">he</span> <span m="1724820">mean</span> <span m="1725140">by</span> <span m="1725310">that?</span> </p>
<p><span m="1726010">OK,</span> <span m="1726870">do</span> <span m="1726990">the</span> <span m="1727100">following</span> <span m="1727560">thought</span> <span m="1727900">experiment.</span> <span m="1729200">Look</span> <span m="1729440">at</span> <span m="1729530">the</span> <span m="1729610">matrix.</span> <span m="1731090">OK?</span> <span m="1731760">And</span> <span m="1731940">in</span> <span m="1732070">your</span> <span m="1732200">mind,</span> <span m="1732700">shift</span> <span m="1733100">it</span> <span m="1733190">left</span> <span m="1733520">and</span> <span m="1733620">put</span> <span m="1733790">all</span> <span m="1734010">the</span> <span m="1734080">characters</span> <span m="1734530">on</span> <span m="1734630">the</span> <span m="1734720">right</span> <span m="1734880">hand</span> <span m="1735090">side.</span> <span m="1736190">OK?</span> <span m="1737130">When</span> <span m="1737360">you</span> <span m="1737490">do</span> <span m="1737750">that,</span> <span m="1738660">what</span> <span m="1738810">will</span> <span m="1738940">happen</span> <span m="1739890">is</span> <span m="1740120">that</span> <span m="1741040">these</span> <span m="1742600">things</span> <span m="1743510">will</span> <span m="1743730">be</span> <span m="1743870">used</span> <span m="1744180">to</span> <span m="1744260">sort</span> <span m="1745320">the</span> <span m="1745440">occurrences</span> <span m="1745783">a</span> <span m="1746470">on</span> <span m="1746630">the</span> <span m="1746730">right</span> <span m="1746930">hand</span> <span m="1747170">side.</span> </p>
<p><span m="1749390">Once</span> <span m="1749590">again,</span> <span m="1750360">if</span> <span m="1750550">you</span> <span m="1750650">shift</span> <span m="1751010">this</span> <span m="1751150">whole</span> <span m="1751360">thing</span> <span m="1751590">left</span> <span m="1751870">and</span> <span m="1751950">these</span> <span m="1752150">pop</span> <span m="1752430">over</span> <span m="1752630">to</span> <span m="1752720">the</span> <span m="1752850">right,</span> <span m="1754210">then</span> <span m="1754470">the</span> <span m="1754610">occurrence</span> <span m="1755070">of</span> <span m="1755210">these</span> <span m="1755440">a's</span> <span m="1755900">will</span> <span m="1756020">be</span> <span m="1756130">sorted</span> <span m="1756580">by</span> <span m="1756740">these</span> <span m="1757980">rows</span> <span m="1759550">from</span> <span m="1759730">here</span> <span m="1760000">over.</span> <span m="1761140">But</span> <span m="1761290">these</span> <span m="1761690">are</span> <span m="1761790">alphabetical.</span> <span m="1764320">And</span> <span m="1764480">therefore</span> <span m="1764770">they're</span> <span m="1764900">going</span> <span m="1765010">to</span> <span m="1765080">certain</span> <span m="1765470">alphabetical</span> <span m="1766130">order.</span> <span m="1767160">And</span> <span m="1767440">therefore</span> <span m="1767700">these</span> <span m="1768090">a's</span> <span m="1768480">will</span> <span m="1768630">sort</span> <span m="1769170">in</span> <span m="1769300">the</span> <span m="1769390">same</span> <span m="1769750">order</span> <span m="1770240">here</span> <span m="1770710">as</span> <span m="1770900">they</span> <span m="1771050">are</span> <span m="1771330">over</span> <span m="1771510">there.</span> </p>
<p><span m="1774360">So</span> <span m="1774390">that</span> <span m="1774580">means</span> <span m="1774980">that</span> <span m="1776760">when</span> <span m="1777020">we</span> <span m="1777120">do</span> <span m="1777420">this</span> <span m="1777720">rotation,</span> <span m="1778850">that</span> <span m="1779040">this</span> <span m="1779250">textual</span> <span m="1779740">occurrence</span> <span m="1780130">of</span> <span m="1780250">a</span> <span m="1780980">will</span> <span m="1781170">have</span> <span m="1781380">the</span> <span m="1781480">same</span> <span m="1781850">rank</span> <span m="1782330">in</span> <span m="1782530">the</span> <span m="1782620">first</span> <span m="1782960">column</span> <span m="1783480">and</span> <span m="1783710">in</span> <span m="1783840">the</span> <span m="1783930">last</span> <span m="1784290">column.</span> <span m="1785570">And</span> <span m="1785750">you</span> <span m="1785870">can</span> <span m="1785990">see</span> <span m="1786150">I've</span> <span m="1786330">annotated</span> <span m="1787520">the</span> <span m="1787660">various</span> <span m="1790210">bases</span> <span m="1790760">here</span> <span m="1791220">with</span> <span m="1791480">their</span> <span m="1791710">ranks.</span> <span m="1792580">This</span> <span m="1792740">is</span> <span m="1792870">the</span> <span m="1792970">first</span> <span m="1793410">g,</span> <span m="1793670">the</span> <span m="1793770">first</span> <span m="1794230">c,</span> <span m="1794480">the</span> <span m="1794580">first</span> <span m="1794950">end</span> <span m="1795130">of</span> <span m="1795230">line,</span> <span m="1795570">end of string</span> <span m="1796010">character.</span> <span m="1796730">First</span> <span m="1797010">a,</span> <span m="1797250">second</span> <span m="1797570">a,</span> <span m="1797800">third</span> <span m="1798150">a,</span> <span m="1798940">second</span> <span m="1799300">c.</span> <span m="1800180">And</span> <span m="1800610">correspondingly</span> <span m="1801490">I</span> <span m="1801610">have</span> <span m="1801850">the</span> <span m="1802100">same</span> <span m="1802370">annotations</span> <span m="1802910">over</span> <span m="1803100">here</span> <span m="1804010">and</span> <span m="1804160">thus</span> <span m="1804480">the</span> <span m="1804870">third</span> <span m="1805470">a</span> <span m="1805780">here</span> <span m="1809730">is</span> <span m="1809930">the</span> <span m="1810020">same</span> <span m="1810330">lexical</span> <span m="1810840">occurrence</span> <span m="1811530">as</span> <span m="1811860">the</span> <span m="1812750">third</span> <span m="1813260">a</span> <span m="1813540">on</span> <span m="1813750">the</span> <span m="1813830">left</span> <span m="1816280">in</span> <span m="1816450">the</span> <span m="1816540">string,</span> <span m="1816870">same</span> <span m="1817550">text</span> <span m="1817780">occurrence.</span> </p>
<p><span m="1819810">Now</span> <span m="1819910">I'm</span> <span m="1820070">going to let</span> <span m="1820260">that</span> <span m="1820440">sink</span> <span m="1820700">in</span> <span m="1820840">for</span> <span m="1820990">a</span> <span m="1821050">second,</span> <span m="1822050">and</span> <span m="1822180">then</span> <span m="1822280">when</span> <span m="1822380">somebody</span> <span m="1822640">asks</span> <span m="1822950">a</span> <span m="1823010">question,</span> <span m="1823400">I'm going to</span> <span m="1823590">explain it</span> <span m="1823990">again</span> <span m="1824360">because</span> <span m="1824730">it's</span> <span m="1824890">a</span> <span m="1824950">little</span> <span m="1825170">bit</span> <span m="1825350">counterintuitive.</span> <span m="1827340">But the</span> <span m="1827510">very</span> <span m="1827940">important</span> <span m="1828420">thing</span> <span m="1829090">is</span> <span m="1829240">if</span> <span m="1829320">we</span> <span m="1829440">think</span> <span m="1829650">about</span> <span m="1829940">textual</span> <span m="1830410">recurrences</span> <span m="1831510">of</span> <span m="1831650">characters</span> <span m="1832190">in</span> <span m="1832280">that</span> <span m="1832480">string</span> <span m="1832800">t</span> <span m="1834070">and</span> <span m="1834180">we</span> <span m="1834300">put</span> <span m="1834480">them</span> <span m="1834620">in</span> <span m="1834680">this</span> <span m="1835320">framework,</span> <span m="1836750">that</span> <span m="1837040">the</span> <span m="1838440">rank</span> <span m="1839240">allows</span> <span m="1839600">us</span> <span m="1839680">to</span> <span m="1839760">identify</span> <span m="1840470">identical</span> <span m="1841060">textual</span> <span m="1841480">recurrences</span> <span m="1841950">of</span> <span m="1842020">a</span> <span m="1842100">character.</span> </p>
<p><span m="1845430">Would</span> <span m="1845650">somebody</span> <span m="1846010">like</span> <span m="1846240">to</span> <span m="1846340">ask</span> <span m="1846640">a</span> <span m="1846700">question?</span> <span m="1847080">Yes.</span> <span m="1847340">Say your</span> <span m="1847490">name</span> <span m="1847850">and the</span> <span m="1848236">question, please.</span> </p>
<p><span m="1849010">AUDIENCE: Dan.</span> </p>
<p><span m="1849353">PROFESSOR: Dan.</span> </p>
<p><span m="1850040">AUDIENCE: So</span> <span m="1850590">in</span> <span m="1850710">your</span> <span m="1850870">original</span> <span m="1851370">string</span> <span m="1851910">though</span> <span m="1852630">those</span> <span m="1852980">won't</span> <span m="1853330">correspond</span> <span m="1854090">to</span> <span m="1854200">the</span> <span m="1854320">same</span> <span m="1854810">order</span> <span m="1856190">in</span> <span m="1857280">the</span> <span m="1857390">transformed</span> <span m="1857800">string.</span> <span m="1859070">So</span> <span m="1859220">like</span> <span m="1859350">the</span> <span m="1859570">a's</span> <span m="1859906">in</span> <span m="1860242">the</span> <span m="1860580">original</span> <span m="1860890">string</span> <span m="1861215">in</span> <span m="1861540">their</span> <span m="1861870">order,</span> <span m="1862650">they</span> <span m="1862790">don't</span> <span m="1863170">correspond</span> <span m="1863520">numerically</span> <span m="1863870">to</span> <span m="1864390">the</span> <span m="1865450">transformed</span> <span m="1865740">string.</span> </p>
<p><span m="1866030">PROFESSOR: That's</span> <span m="1866280">correct.</span> <span m="1867860">Is</span> <span m="1868200">that</span> <span m="1868390">OK?</span> <span m="1869200">The</span> <span m="1869810">comment</span> <span m="1870220">was</span> <span m="1870580">that</span> <span m="1870780">the</span> <span m="1871380">order</span> <span m="1871760">in</span> <span m="1873070">BWT,</span> <span m="1873450">the</span> <span m="1873650">transform</span> <span m="1874240">is</span> <span m="1874380">not</span> <span m="1874630">the</span> <span m="1874710">same</span> <span m="1874910">as</span> <span m="1875000">the</span> <span m="1875110">order</span> <span m="1875430">in</span> <span m="1875500">the</span> <span m="1875620">original</span> <span m="1876060">string.</span> <span m="1877020">And</span> <span m="1877180">all</span> <span m="1877340">I'm</span> <span m="1877480">saying</span> <span m="1877970">is</span> <span m="1878220">that</span> <span m="1878440">in</span> <span m="1878560">this</span> <span m="1878730">particular</span> <span m="1879220">matrix</span> <span m="1879700">form,</span> <span m="1880460">that</span> <span m="1880590">the</span> <span m="1880710">order</span> <span m="1881290">on</span> <span m="1881390">the</span> <span m="1881480">last</span> <span m="1881770">column</span> <span m="1882090">is</span> <span m="1882200">the</span> <span m="1882300">same</span> <span m="1882590">as</span> <span m="1882680">the</span> <span m="1882790">order</span> <span m="1883060">in</span> <span m="1883110">the</span> <span m="1883200">first</span> <span m="1883440">column</span> <span m="1883660">for</span> <span m="1883800">a</span> <span m="1883850">particular</span> <span m="1884370">character.</span> <span m="1885030">And</span> <span m="1885130">furthermore,</span> <span m="1886100">that</span> <span m="1886320">these</span> <span m="1886660">are</span> <span m="1886830">matching</span> <span m="1887350">textual</span> <span m="1887830">occurrences,</span> <span m="1888420">right?</span> </p>
<p><span m="1890120">Now</span> <span m="1890280">if</span> <span m="1890380">I</span> <span m="1890450">look</span> <span m="1890690">at</span> <span m="1890800">a2</span> <span m="1892800">here,</span> <span m="1895510">we</span> <span m="1895630">know</span> <span m="1895800">that</span> <span m="1896000">c</span> <span m="1896250">comes</span> <span m="1896520">after</span> <span m="1896920">it,</span> <span m="1897060">then</span> <span m="1897200">a, then</span> <span m="1897590">a,</span> <span m="1897855">and</span> <span m="1898120">c and</span> <span m="1898230">g,</span> <span m="1898460">right?</span> <span m="1902360">Right.</span> <span m="1902670">OK,</span> <span m="1902940">so</span> <span m="1904346">did</span> <span m="1904830">that</span> <span m="1905070">answer</span> <span m="1905310">your</span> <span m="1905390">question</span> <span m="1905800">that</span> <span m="1905870">they're</span> <span m="1905970">not</span> <span m="1906140">exactly</span> <span m="1906500">the</span> <span m="1906620">same?</span> </p>
<p><span m="1907870">AUDIENCE: Yes.</span> <span m="1908030">I</span> <span m="1908080">don't</span> <span m="1908310">understand</span> <span m="1908590">how</span> <span m="1908870">they're</span> <span m="1909320">useful</span> <span m="1909570">yet.</span> </p>
<p><span m="1910440">PROFESSOR: You don't</span> <span m="1910890">understand</span> <span m="1911090">how it's</span> <span m="1911290">useful</span> <span m="1911450">yet.</span> <span m="1912770">OK.</span> <span m="1914032">Well,</span> <span m="1914390">maybe</span> <span m="1914580">we</span> <span m="1914660">better</span> <span m="1914830">get</span> <span m="1914990">to the</span> <span m="1915130">useful</span> <span m="1915470">part</span> <span m="1915760">and</span> <span m="1915850">then</span> <span m="1915950">you</span> <span m="1916030">can--</span> <span m="1917760">OK.</span> <span m="1918180">So</span> <span m="1918590">let</span> <span m="1918850">us</span> <span m="1919000">suppose</span> <span m="1920950">that</span> <span m="1921190">we</span> <span m="1921510">want</span> <span m="1921850">to,</span> <span m="1922650">from</span> <span m="1922910">this,</span> <span m="1924020">reconstruct</span> <span m="1925140">the</span> <span m="1925300">original</span> <span m="1925750">string.</span> <span m="1927950">Does</span> <span m="1928070">anybody</span> <span m="1928440">have</span> <span m="1928670">any</span> <span m="1928830">ideas</span> <span m="1929200">about</span> <span m="1929370">how</span> <span m="1929540">to</span> <span m="1929660">do</span> <span m="1929820">that?</span> <span m="1940200">OK.</span> </p>
<p><span m="1942030">Let me</span> <span m="1942150">ask</span> <span m="1942350">a</span> <span m="1942400">different</span> <span m="1942650">question.</span> <span m="1944320">If</span> <span m="1944370">we</span> <span m="1944460">look</span> <span m="1944680">at</span> <span m="1945330">this</span> <span m="1946190">g1,</span> <span m="1947040">right?</span> <span m="1948960">And</span> <span m="1949120">then</span> <span m="1949380">this</span> <span m="1949670">is</span> <span m="1949790">the</span> <span m="1949880">same</span> <span m="1950100">textual</span> <span m="1950470">occurrence,</span> <span m="1950940">right?</span> <span m="1952400">And</span> <span m="1952560">we</span> <span m="1952680">know</span> <span m="1952950">that</span> <span m="1953200">this</span> <span m="1953420">g1</span> <span m="1954210">comes</span> <span m="1954530">right</span> <span m="1954890">before</span> <span m="1955670">the</span> <span m="1955840">end</span> <span m="1956040">of</span> <span m="1956110">character,</span> <span m="1956980">in</span> <span m="1957160">end of</span> <span m="1957270">string</span> <span m="1957540">terminator,</span> <span m="1957930">right?</span> <span m="1959200">So</span> <span m="1959320">if we</span> <span m="1959470">look</span> <span m="1959640">at</span> <span m="1959730">the</span> <span m="1959830">first</span> <span m="1960330">row,</span> <span m="1960950">we</span> <span m="1961150">always</span> <span m="1961420">know</span> <span m="1961860">what</span> <span m="1962010">the</span> <span m="1962110">last</span> <span m="1962590">character</span> <span m="1963160">was</span> <span m="1963920">in</span> <span m="1964020">the</span> <span m="1964130">original</span> <span m="1964480">string.</span> <span m="1965530">The</span> <span m="1965620">last</span> <span m="1965920">character</span> <span m="1968400">is</span> <span m="1970820">g1,</span> <span m="1971550">right?</span> <span m="1974370">Fair</span> <span m="1974540">enough?</span> <span m="1976290">OK</span> </p>
<p><span m="1976500">Where</span> <span m="1976730">does</span> <span m="1976910">g1</span> <span m="1977080">would</span> <span m="1977220">occur</span> <span m="1977490">over</span> <span m="1977640">here?</span> <span m="1978600">Right</span> <span m="1978710">over</span> <span m="1978840">here,</span> <span m="1979040">right?</span> <span m="1980440">What's</span> <span m="1980660">the</span> <span m="1980750">character</span> <span m="1981020">before</span> <span m="1981330">g1?</span> <span m="1983380">c2.</span> <span m="1985960">where</span> <span m="1986170">is c2</span> <span m="1986660">over</span> <span m="1986880">here?</span> <span m="1988380">What's</span> <span m="1988570">the</span> <span m="1988660">character</span> <span m="1988940">before</span> <span m="1989040">c2?</span> <span m="1990608">a3.</span> <span m="1993100">What's</span> <span m="1993380">the</span> <span m="1993470">character</span> <span m="1993840">before</span> <span m="1994230">a3?</span> <span m="1996610">a1.</span> <span m="1999020">Uh, oh.</span> </p>
<p><span m="2002010">Let</span> <span m="2002180">me</span> <span m="2002290">just</span> <span m="2003900">cheat</span> <span m="2004190">a little bit</span> <span m="2004440">here.</span> <span m="2004740">a1</span> <span m="2006260">a3</span> <span m="2006680">c2</span> <span m="2007076">g1</span> <span m="2007472">$.</span> <span m="2013460">So</span> <span m="2013650">we're</span> <span m="2013930">at</span> <span m="2014100">a1,</span> <span m="2014410">right?</span> <span m="2015740">What's</span> <span m="2015980">the</span> <span m="2016020">character</span> <span m="2016350">before</span> <span m="2016550">a1?</span> <span m="2019330">c1,</span> <span m="2019810">right?</span> <span m="2022350">What's</span> <span m="2022580">the</span> <span m="2022680">character</span> <span m="2023110">before</span> <span m="2023490">c1?</span> <span m="2028640">a2.</span> <span m="2031400">And</span> <span m="2032820">what's</span> <span m="2033050">the</span> <span m="2033100">character</span> <span m="2033400">before</span> <span m="2033590">a2?</span> <span m="2036690">That's</span> <span m="2036880">the</span> <span m="2036980">end of</span> <span m="2037325">string.</span> <span m="2038200">Is</span> <span m="2038310">that</span> <span m="2038500">the</span> <span m="2038600">original</span> <span m="2038980">string</span> <span m="2039230">that</span> <span m="2039310">we</span> <span m="2039420">had?</span> <span m="2041210">Magic.</span> <span m="2042480">OK?</span> <span m="2043040">Yes.</span> </p>
<p><span m="2044980">AUDIENCE: Wouldn't it</span> <span m="2045460">be</span> <span m="2045940">simpler</span> <span m="2046420">to look</span> <span m="2046900">at--</span> <span m="2047380">to just</span> <span m="2047860">remove</span> <span m="2048340">the</span> <span m="2048820">dollar sign</span> <span m="2049780">[INAUDIBLE]</span> <span m="2052570">or</span> <span m="2053139">do</span> <span m="2053300">you</span> <span m="2053780">mean reconstruct</span> <span m="2054227">from</span> <span m="2054674">only</span> <span m="2055121">the</span> <span m="2055570">transformed?</span> </p>
<p><span m="2056510">PROFESSOR: We're</span> <span m="2057000">only</span> <span m="2057490">using</span> <span m="2057980">this.</span> <span m="2058672">This</span> <span m="2059020">is</span> <span m="2059130">all</span> <span m="2059429">we</span> <span m="2059580">have.</span> <span m="2062310">Because</span> <span m="2062590">I</span> <span m="2062719">actually</span> <span m="2062989">didn't</span> <span m="2063230">use</span> <span m="2063480">any</span> <span m="2063620">of</span> <span m="2063659">these</span> <span m="2063790">characters.</span> <span m="2065210">I</span> <span m="2065320">was</span> <span m="2065460">only</span> <span m="2065830">doing</span> <span m="2066110">the</span> <span m="2066210">matching</span> <span m="2066800">so</span> <span m="2066840">we</span> <span m="2066949">would</span> <span m="2067150">go</span> <span m="2067320">to</span> <span m="2067380">the</span> <span m="2067489">right</span> <span m="2067730">row.</span> <span m="2069870">Right?</span> <span m="2070659">I</span> <span m="2070750">didn't</span> <span m="2070940">use</span> <span m="2071150">any</span> <span m="2071370">of</span> <span m="2071429">this.</span> <span m="2075190">And</span> <span m="2075440">so,</span> <span m="2077520">but</span> <span m="2077760">do</span> <span m="2077840">people</span> <span m="2078090">understand</span> <span m="2078530">what's</span> <span m="2078699">going</span> <span m="2078870">on</span> <span m="2079050">here?</span> <span m="2079260">If</span> <span m="2079409">anybody</span> <span m="2079800">has</span> <span m="2080020">any</span> <span m="2080230">questions,</span> <span m="2080699">now</span> <span m="2080770">is a</span> <span m="2080840">great</span> <span m="2081520">time</span> <span m="2081830">to</span> <span m="2081969">raise</span> <span m="2082179">your</span> <span m="2082320">hand</span> <span m="2082620">and</span> <span m="2082760">say--</span> <span m="2083639">here</span> <span m="2083949">we</span> <span m="2084080">go.</span> <span m="2084365">We</span> <span m="2084650">have</span> <span m="2084790">a</span> <span m="2084850">customer.</span> <span m="2085460">Say</span> <span m="2085590">your</span> <span m="2085710">name</span> <span m="2085909">and</span> <span m="2085980">the</span> <span m="2086030">question,</span> <span m="2086310">please.</span> </p>
<p><span m="2086595">AUDIENCE: My name is</span> <span m="2086880">Eric.</span> </p>
<p><span m="2087754">PROFESSOR: Thanks,</span> <span m="2088191">Eric.</span> </p>
<p><span m="2088628">AUDIENCE: Can you</span> <span m="2089065">illustrate</span> <span m="2089502">how you would do</span> <span m="2089940">this</span> <span m="2090159">without</span> <span m="2090940">using</span> <span m="2091214">any</span> <span m="2091489">of</span> <span m="2091986">the</span> <span m="2092980">elements</span> <span m="2093275">to</span> <span m="2093570">the left</span> <span m="2093982">of the</span> <span m="2094394">box?</span> </p>
<p><span m="2095630">PROFESSOR: Absolutely,</span> <span m="2096210">Eric.</span> <span m="2096639">I'm</span> <span m="2096889">so glad</span> <span m="2097219">you</span> <span m="2097550">asked that</span> <span m="2097960">question.</span> <span m="2098370">That's the</span> <span m="2098760">next thing we're going to</span> <span m="2099150">talk</span> <span m="2099650">about.</span> <span m="2100880">OK, but</span> <span m="2101290">before</span> <span m="2101720">I</span> <span m="2101740">get</span> <span m="2102130">to there,</span> <span m="2103160">I</span> <span m="2103210">want</span> <span m="2103320">to</span> <span m="2103370">make</span> <span m="2103540">sure,</span> <span m="2103750">are</span> <span m="2103830">you</span> <span m="2103930">comfortable</span> <span m="2104300">doing</span> <span m="2104520">it</span> <span m="2104620">with</span> <span m="2104730">all</span> <span m="2104900">the</span> <span m="2104960">stuff</span> <span m="2105190">on</span> <span m="2105290">the</span> <span m="2105370">left</span> <span m="2105550">hand</span> <span m="2105710">side?</span> <span m="2106720">You're</span> <span m="2106840">happy</span> <span m="2107140">about</span> <span m="2107380">that?</span> <span m="2108265">OK.</span> <span m="2108670">if</span> <span m="2108960">anyone</span> <span m="2109110">was</span> <span m="2109270">unhappy</span> <span m="2109950">about</span> <span m="2110220">that,</span> <span m="2111120">now</span> <span m="2111290">would be</span> <span m="2111440">the</span> <span m="2111520">time</span> <span m="2111750">to</span> <span m="2111820">say,</span> <span m="2112420">I'm</span> <span m="2112670">unhappy,</span> <span m="2113660">help</span> <span m="2113930">me.</span> <span m="2115230">How about</span> <span m="2115370">the</span> <span m="2115460">details?</span> <span m="2116890">Everybody's</span> <span m="2117300">happy?</span> <span m="2117980">Yes.</span> </p>
<p><span m="2119600">AUDIENCE: So,</span> <span m="2121270">you</span> <span m="2121430">have</span> <span m="2121890">your</span> <span m="2122130">original</span> <span m="2122510">string in the</span> <span m="2123000">first</span> <span m="2123290">place,</span> <span m="2123620">though,</span> <span m="2123870">so</span> <span m="2124100">why</span> <span m="2124350">do</span> <span m="2124430">you</span> <span m="2124620">want</span> <span m="2124860">to</span> <span m="2124980">create</span> <span m="2125730">another</span> <span m="2126050">string of</span> <span m="2126390">the</span> <span m="2126470">same</span> <span m="2126750">length?</span> <span m="2127485">Like,</span> <span m="2129385">how does</span> <span m="2129860">this help</span> <span m="2130335">you</span> <span m="2130810">match your read?</span> </p>
<p><span m="2131950">PROFESSOR: How does</span> <span m="2132090">this help</span> <span m="2132340">you</span> <span m="2132660">match your</span> <span m="2133050">read?</span> <span m="2134600">How</span> <span m="2134720">does</span> <span m="2135150">this help</span> <span m="2135270">you</span> <span m="2135500">match your read,</span> <span m="2135580">was the question.</span> <span m="2136020">What</span> <span m="2136040">is</span> <span m="2136090">was your</span> <span m="2136200">name?</span> </p>
<p><span m="2136710">AUDIENCE: Dan.</span> </p>
<p><span m="2136780">PROFESSOR: That's</span> <span m="2137035">right,</span> <span m="2137290">Dan.</span> <span m="2140040">That's</span> <span m="2140230">a</span> <span m="2140330">great</span> <span m="2141070">question.</span> <span m="2141520">I'm</span> <span m="2141690">so</span> <span m="2141940">glad</span> <span m="2142150">you</span> <span m="2142240">asked</span> <span m="2142460">it.</span> <span m="2142610">First</span> <span m="2143000">we'll</span> <span m="2143120">get to</span> <span m="2143320">Eric's</span> <span m="2143710">question</span> <span m="2144160">and</span> <span m="2144320">then</span> <span m="2144430">we'll</span> <span m="2144530">get</span> <span m="2144700">to</span> <span m="2144760">yours.</span> <span m="2145510">Because</span> <span m="2146250">I</span> <span m="2146380">know</span> <span m="2146670">if</span> <span m="2146810">I</span> <span m="2146880">don't</span> <span m="2147110">give</span> <span m="2147250">you</span> <span m="2147370">a good</span> <span m="2147640">answer that</span> <span m="2147720">you're</span> <span m="2147850">going to</span> <span m="2147960">be</span> <span m="2148070">very</span> <span m="2148420">mad,</span> <span m="2148800">right?</span> <span m="2150300">OK?</span> </p>
<p><span m="2151700">Let's</span> <span m="2152050">talk</span> <span m="2152300">about</span> <span m="2153720">the</span> <span m="2153840">question</span> <span m="2154310">of</span> <span m="2154430">how to</span> <span m="2154580">do</span> <span m="2154680">this</span> <span m="2154790">without</span> <span m="2155030">the</span> <span m="2155150">other</span> <span m="2155320">things.</span> <span m="2156550">So</span> <span m="2157120">we're</span> <span m="2157390">going</span> <span m="2157490">to</span> <span m="2157580">create</span> <span m="2157940">something</span> <span m="2158050">called</span> <span m="2158220">the</span> <span m="2158320">last</span> <span m="2158670">to first</span> <span m="2159070">function</span> <span m="2160060">that</span> <span m="2160210">maps</span> <span m="2161660">a</span> <span m="2161760">character</span> <span m="2162440">in</span> <span m="2162590">the</span> <span m="2162700">last</span> <span m="2163420">row,</span> <span m="2164570">column,</span> <span m="2165020">I</span> <span m="2165120">should</span> <span m="2165210">say,</span> <span m="2165850">to</span> <span m="2166290">the</span> <span m="2166350">first</span> <span m="2166580">column.</span> <span m="2167890">And</span> <span m="2168260">there</span> <span m="2168470">is</span> <span m="2168570">the</span> <span m="2168620">function</span> <span m="2168960">right</span> <span m="2169220">there.</span> <span m="2169400">It's</span> <span m="2169510">called</span> <span m="2169740">LF.</span> </p>
<p><span m="2170700">You</span> <span m="2170820">give</span> <span m="2171060">it</span> <span m="2171190">a</span> <span m="2171340">row</span> <span m="2171530">number.</span> <span m="2171850">The</span> <span m="2172000">rows</span> <span m="2172370">are</span> <span m="2172590">zero</span> <span m="2172950">origined.</span> <span m="2174400">And</span> <span m="2174610">you</span> <span m="2174710">give</span> <span m="2174950">it</span> <span m="2175100">a</span> <span m="2175170">character</span> <span m="2176230">and</span> <span m="2176340">it</span> <span m="2176470">tells</span> <span m="2176740">you</span> <span m="2176830">what</span> <span m="2176940">the</span> <span m="2177020">corresponding</span> <span m="2178490">place</span> <span m="2178795">is</span> <span m="2179100">in</span> <span m="2179340">the</span> <span m="2179650">first</span> <span m="2179890">column.</span> <span m="2181370">And</span> <span m="2181610">it</span> <span m="2181890">has</span> <span m="2182220">two</span> <span m="2182390">components.</span> <span m="2183650">The</span> <span m="2183670">first</span> <span m="2184150">is</span> <span m="2184520">Occ,</span> <span m="2185680">which</span> <span m="2185890">tells</span> <span m="2186110">you</span> <span m="2186230">how</span> <span m="2186430">many</span> <span m="2186590">characters</span> <span m="2186990">are</span> <span m="2187070">smaller</span> <span m="2187680">than</span> <span m="2187840">that</span> <span m="2188040">character</span> <span m="2188410">lexically.</span> <span m="2189440">So</span> <span m="2189580">tells</span> <span m="2189930">you</span> <span m="2190120">where,</span> <span m="2190460">for</span> <span m="2190590">example,</span> <span m="2191380">the</span> <span m="2191530">a's</span> <span m="2191860">start,</span> <span m="2192190">the</span> <span m="2192270">c's</span> <span m="2192550">start,</span> <span m="2192880">or</span> <span m="2192930">the</span> <span m="2193020">g's</span> <span m="2193425">start.</span> </p>
<p><span m="2196410">So</span> <span m="2197710">in</span> <span m="2197930">this</span> <span m="2198180">case,</span> <span m="2198650">for</span> <span m="2198730">example</span> <span m="2199860">Occ</span> <span m="2200200">of</span> <span m="2200360">c</span> <span m="2200600">is</span> <span m="2200760">4.</span> <span m="2201220">That</span> <span m="2201380">is</span> <span m="2201520">the</span> <span m="2201610">c's</span> <span m="2201940">start</span> <span m="2202510">at</span> <span m="2202830">0,</span> <span m="2203183">1,2,</span> <span m="2203890">3,</span> <span m="2204480">the</span> <span m="2204590">fourth</span> <span m="2204980">row.</span> <span m="2205900">OK?</span> <span m="2208110">And</span> <span m="2208300">then</span> <span m="2209490">count</span> <span m="2210330">tells</span> <span m="2210540">you</span> <span m="2210650">the</span> <span m="2210870">rank</span> <span m="2211230">of</span> <span m="2211340">c</span> <span m="2211660">minus</span> <span m="2212000">1.</span> <span m="2213520">So</span> <span m="2213780">it's</span> <span m="2213940">going</span> <span m="2214140">to</span> <span m="2214400">essentially</span> <span m="2214960">count</span> <span m="2215930">how</span> <span m="2216170">many</span> <span m="2216370">times</span> <span m="2216770">c</span> <span m="2217080">occurs</span> <span m="2218080">before</span> <span m="2218840">the c</span> <span m="2219310">at</span> <span m="2219780">the</span> <span m="2219900">row</span> <span m="2220090">you're</span> <span m="2220180">pointing</span> <span m="2220610">at.</span> <span m="2221460">In</span> <span m="2221580">this</span> <span m="2221760">case,</span> <span m="2222110">the</span> <span m="2222160">answer</span> <span m="2222510">is</span> <span m="2223480">1</span> <span m="2224470">and</span> <span m="2224570">you</span> <span m="2224690">add</span> <span m="2224980">1</span> <span m="2225700">and</span> <span m="2225850">that</span> <span m="2226070">gets</span> <span m="2226280">you</span> <span m="2226420">to</span> <span m="2227250">5,</span> <span m="2228390">which</span> <span m="2228630">is</span> <span m="2229520">this</span> <span m="2229820">row.</span> </p>
<p><span m="2231370">So</span> <span m="2232030">this</span> <span m="2232810">c2</span> <span m="2233650">maps</span> <span m="2234390">here</span> <span m="2234920">to</span> <span m="2235020">c2</span> <span m="2236080">as we</span> <span m="2236350">already</span> <span m="2236620">discussed.</span> <span m="2238120">So</span> <span m="2238280">this LF</span> <span m="2238530">function</span> <span m="2239850">is</span> <span m="2240020">a</span> <span m="2240090">way</span> <span m="2240360">to</span> <span m="2240500">map</span> <span m="2241420">from</span> <span m="2241720">the</span> <span m="2242340">last</span> <span m="2242690">row</span> <span m="2243050">to</span> <span m="2243140">the</span> <span m="2243240">first</span> <span m="2243540">row.</span> <span m="2247240">And</span> <span m="2247440">we</span> <span m="2247520">need</span> <span m="2247740">to</span> <span m="2247780">have</span> <span m="2247920">two</span> <span m="2248050">components.</span> <span m="2248320">So</span> <span m="2248590">we</span> <span m="2248710">need</span> <span m="2248900">to</span> <span m="2248960">know</span> <span m="2249750">Occ,</span> <span m="2250290">which</span> <span m="2250430">is</span> <span m="2250540">very</span> <span m="2250890">trivial</span> <span m="2251220">to</span> <span m="2251290">compute.</span> <span m="2252390">There are</span> <span m="2252630">only</span> <span m="2253100">five</span> <span m="2253500">elements,</span> <span m="2254020">one</span> <span m="2254270">for</span> <span m="2254420">each</span> <span m="2254650">base</span> <span m="2255370">and</span> <span m="2255550">one</span> <span m="2255720">for</span> <span m="2255810">the</span> <span m="2255940">end</span> <span m="2256130">of</span> <span m="2257040">line</span> <span m="2257290">terminator,</span> <span m="2257800">which</span> <span m="2257860">is</span> <span m="2257950">actually</span> <span m="2258190">zero.</span> <span m="2259390">So</span> <span m="2260150">it will</span> <span m="2260600">only</span> <span m="2261035">have</span> <span m="2261800">integers</span> <span m="2263520">and</span> <span m="2264130">count,</span> <span m="2264900">which</span> <span m="2265080">is</span> <span m="2265190">going</span> <span m="2265300">to</span> <span m="2265420">tell us</span> <span m="2265700">the</span> <span m="2265830">rank</span> <span m="2266510">in</span> <span m="2266670">the</span> <span m="2266740">BWT</span> <span m="2267190">transform</span> <span m="2267900">and</span> <span m="2268000">we'll</span> <span m="2268090">talk</span> <span m="2268260">about</span> <span m="2268420">how</span> <span m="2268520">to</span> <span m="2268610">do</span> <span m="2268720">that</span> <span m="2268910">presently.</span> </p>
<p><span m="2271540">OK.</span> <span m="2272420">So</span> <span m="2272740">did</span> <span m="2273060">that</span> <span m="2273280">answer</span> <span m="2273460">your</span> <span m="2273540">question,</span> <span m="2274010">how</span> <span m="2274130">to do</span> <span m="2274360">this without</span> <span m="2274510">the</span> <span m="2274590">rest</span> <span m="2274760">of</span> <span m="2274810">the</span> <span m="2274850">matrix?</span> <span m="2275640">Eric?</span> </p>
<p><span m="2276170">AUDIENCE: Could you</span> <span m="2276654">show</span> <span m="2277138">us step by</span> <span m="2277622">step on</span> <span m="2278106">the blackboard</span> <span m="2280042">how you</span> <span m="2280526">would</span> <span m="2281010">reconstruct</span> <span m="2281494">it?</span> </p>
<p><span m="2283430">PROFESSOR: How</span> <span m="2283610">do</span> <span m="2283800">we</span> <span m="2284010">reconstruct it?</span> </p>
<p><span m="2285040">AUDIENCE: Yeah.</span> </p>
<p><span m="2286030">PROFESSOR: You</span> <span m="2286150">mean</span> <span m="2286740">something</span> <span m="2287110">like</span> <span m="2287350">this?</span> <span m="2289490">Is this</span> <span m="2289920">what</span> <span m="2290020">you're</span> <span m="2290140">suggesting?</span> </p>
<p><span m="2291936">AUDIENCE:</span> <span m="2293412">Somehow</span> <span m="2293904">I get</span> <span m="2294396">a feeling</span> <span m="2294888">that</span> <span m="2295380">the</span> <span m="2295880">first</span> <span m="2296340">column</span> <span m="2298134">doesn't help</span> <span m="2298622">us in</span> <span m="2299110">understanding</span> <span m="2299598">how the</span> <span m="2300086">algorithm</span> <span m="2300580">work</span> <span m="2300980">only</span> <span m="2301360">using</span> <span m="2301620">the</span> <span m="2301880">last</span> <span m="2302340">column.</span> </p>
<p><span m="2304640">PROFESSOR: OK.</span> <span m="2305560">Your</span> <span m="2306020">comment,</span> <span m="2306450">Eric,</span> <span m="2306650">is</span> <span m="2306770">that</span> <span m="2306880">you</span> <span m="2307000">feel</span> <span m="2307190">like</span> <span m="2307400">the</span> <span m="2308630">first</span> <span m="2308910">column</span> <span m="2309280">doesn't</span> <span m="2309380">help</span> <span m="2309630">us</span> <span m="2309760">understand</span> <span m="2310140">how</span> <span m="2310250">the</span> <span m="2310510">algorithm works,</span> <span m="2310850">only</span> <span m="2311090">using</span> <span m="2311350">the</span> <span m="2311440">last</span> <span m="2311800">column,</span> <span m="2312120">right?</span> <span m="2313730">OK.</span> </p>
<p><span m="2316536">AUDIENCE: [INAUDIBLE]</span> <span m="2318390">going</span> <span m="2318590">back</span> <span m="2318855">to the</span> <span m="2319120">first</span> <span m="2319590">column</span> <span m="2321000">of</span> <span m="2321470">data.</span> </p>
<p><span m="2322880">PROFESSOR: OK.</span> <span m="2326810">Well</span> <span m="2327190">let's</span> <span m="2330830">compute</span> <span m="2336370">the</span> <span m="2336580">LF</span> <span m="2337140">function</span> <span m="2338360">of</span> <span m="2340230">the</span> <span m="2340310">character</span> <span m="2341180">and</span> <span m="2341340">the</span> <span m="2341470">row</span> <span m="2342500">for</span> <span m="2342730">each</span> <span m="2342960">one</span> <span m="2343210">of</span> <span m="2343300">these</span> <span m="2343550">things,</span> <span m="2343910">OK?</span> <span m="2345160">And</span> <span m="2345300">that</span> <span m="2345450">might</span> <span m="2345630">help</span> <span m="2345890">you,</span> <span m="2346690">all</span> <span m="2346750">right?</span> <span m="2347530">Because</span> <span m="2347980">that's</span> <span m="2348310">the</span> <span m="2348400">central</span> <span m="2348910">part</span> <span m="2349760">of</span> <span m="2349900">being</span> <span m="2350090">able</span> <span m="2350210">to</span> <span m="2350300">reverse</span> <span m="2350680">this</span> <span m="2350810">transform.</span> <span m="2352590">So</span> <span m="2352780">this</span> <span m="2352990">is,</span> <span m="2353830">to</span> <span m="2353930">be</span> <span m="2354060">more</span> <span m="2354260">clear,</span> <span m="2355390">I'll</span> <span m="2355710">make</span> <span m="2355890">it</span> <span m="2356010">more</span> <span m="2356180">explicit.</span> <span m="2356720">This</span> <span m="2356890">is</span> <span m="2357240">LF</span> <span m="2358215">of</span> <span m="2358520">I</span> <span m="2359510">and</span> <span m="2360090">BWT</span> <span m="2362170">of</span> <span m="2362550">i,</span> <span m="2364090">where</span> <span m="2364230">i</span> <span m="2364390">goes</span> <span m="2364620">from</span> <span m="2364740">0</span> <span m="2364980">to</span> <span m="2365060">6.</span> <span m="2367810">So</span> <span m="2368400">what</span> <span m="2368730">is</span> <span m="2368910">that</span> <span m="2369130">value</span> <span m="2369500">for</span> <span m="2369620">this</span> <span m="2369840">one</span> <span m="2370010">right</span> <span m="2370180">here?</span> <span m="2372340">Anybody</span> <span m="2372590">know?</span> <span m="2375880">Well</span> <span m="2377610">it</span> <span m="2377720">would</span> <span m="2377870">be</span> <span m="2378400">Occ</span> <span m="2378950">of</span> <span m="2379040">g,</span> <span m="2379390">which</span> <span m="2379630">is</span> <span m="2380970">6,</span> <span m="2381850">right?</span> <span m="2383310">Plus</span> <span m="2384010">count</span> <span m="2385020">of</span> <span m="2390560">of</span> <span m="2390770">6</span> <span m="2391080">n</span> <span m="2392550">g,</span> <span m="2394090">which</span> <span m="2394280">is</span> <span m="2394370">going</span> <span m="2394540">to</span> <span m="2394590">be</span> <span m="2394740">0.</span> </p>
<p><span m="2397220">Or I can</span> <span m="2397720">look</span> <span m="2397940">right</span> <span m="2398090">over</span> <span m="2398250">here</span> <span m="2398570">and</span> <span m="2398680">see</span> <span m="2398820">that</span> <span m="2399000">in fact it's</span> <span m="2399470">6,</span> <span m="2399830">right?</span> <span m="2400020">Because</span> <span m="2400400">this</span> <span m="2400560">occurrence</span> <span m="2400920">of</span> <span m="2400990">g1</span> <span m="2401310">is</span> <span m="2401410">right</span> <span m="2401590">here.</span> <span m="2403450">So</span> <span m="2404180">this</span> <span m="2404560">LF</span> <span m="2404860">value</span> <span m="2405250">is,</span> <span m="2405650">it's</span> <span m="2406030">6</span> <span m="2408402">4</span> <span m="2410850">0</span> <span m="2412350">a1</span> <span m="2412840">is</span> <span m="2413010">in</span> <span m="2413440">1,</span> <span m="2414430">a2</span> <span m="2414760">is</span> <span m="2414910">in</span> <span m="2415366">2,</span> <span m="2416280">a3</span> <span m="2416880">is</span> <span m="2417020">in</span> <span m="2418010">3,</span> <span m="2419255">c2</span> <span m="2419670">is</span> <span m="2419820">in</span> <span m="2421190">5.</span> <span m="2422660">So</span> <span m="2423290">this</span> <span m="2423520">is</span> <span m="2423630">the LF</span> <span m="2423750">function,</span> <span m="2424390">6</span> <span m="2424832">4</span> <span m="2425274">0</span> <span m="2425716">1</span> <span m="2426158">2</span> <span m="2426600">3</span> <span m="2427022">5.</span> <span m="2428710">And</span> <span m="2429040">I</span> <span m="2429220">don't</span> <span m="2429550">need</span> <span m="2429940">any</span> <span m="2430150">of</span> <span m="2430210">this</span> <span m="2430340">to</span> <span m="2430430">compute</span> <span m="2430780">it.</span> <span m="2431670">Because</span> <span m="2432930">it</span> <span m="2433100">simply</span> <span m="2433540">is</span> <span m="2433680">equal</span> <span m="2433990">to,</span> <span m="2434260">going</span> <span m="2434490">back</span> <span m="2434860">one</span> <span m="2435120">slide,</span> <span m="2436920">it's</span> <span m="2437110">equal</span> <span m="2437380">to</span> <span m="2437740">Occ</span> <span m="2438390">of</span> <span m="2438470">c</span> <span m="2438740">plus</span> <span m="2439030">count.</span> <span m="2439450">So</span> <span m="2439610">it'</span> <span m="2439720">going</span> <span m="2439820">to</span> <span m="2439860">be</span> <span m="2439970">equal</span> <span m="2440150">to</span> <span m="2440260">where</span> <span m="2440990">that</span> <span m="2441140">particular</span> <span m="2441510">character</span> <span m="2441960">starts</span> <span m="2443690">on</span> <span m="2443850">the</span> <span m="2443910">left</span> <span m="2444120">hand</span> <span m="2444320">side</span> <span m="2445350">and</span> <span m="2446080">its</span> <span m="2446730">rank</span> <span m="2447050">minus</span> <span m="2447370">1.</span> </p>
<p><span m="2450330">And</span> <span m="2450440">so</span> <span m="2450540">these</span> <span m="2450740">are</span> <span m="2450780">the</span> <span m="2450890">values</span> <span m="2451210">for</span> <span m="2451320">LF.</span> <span m="2453100">This</span> <span m="2453520">is</span> <span m="2453620">what</span> <span m="2453810">I</span> <span m="2453900">need</span> <span m="2454780">to</span> <span m="2454900">be</span> <span m="2455050">able</span> <span m="2455180">to</span> <span m="2455240">take</span> <span m="2455500">this</span> <span m="2455710">string</span> <span m="2456530">and</span> <span m="2456770">recompute</span> <span m="2457280">the</span> <span m="2457420">original</span> <span m="2457810">string.</span> <span m="2459630">If</span> <span m="2459800">I</span> <span m="2459880">can</span> <span m="2460040">compute</span> <span m="2460400">this,</span> <span m="2461310">I</span> <span m="2461430">don't</span> <span m="2461670">need</span> <span m="2461860">any</span> <span m="2462090">of</span> <span m="2462170">that.</span> <span m="2464170">And</span> <span m="2464410">to</span> <span m="2464480">compute</span> <span m="2464870">this,</span> <span m="2465340">I</span> <span m="2465410">need</span> <span m="2465680">two</span> <span m="2465860">things.</span> <span m="2467000">I</span> <span m="2467120">need</span> <span m="2468550">Occ</span> <span m="2469020">and</span> <span m="2469490">I need</span> <span m="2469870">count.</span> <span m="2473000">All</span> <span m="2473090">right?</span> <span m="2473990">Now,</span> <span m="2474590">I</span> <span m="2474680">can</span> <span m="2474870">tell</span> <span m="2475130">you're</span> <span m="2475280">not</span> <span m="2475620">quite</span> <span m="2475920">completely</span> <span m="2476570">satisfied</span> <span m="2477260">yet.</span> <span m="2478310">So</span> <span m="2478450">maybe</span> <span m="2478700">you can</span> <span m="2478880">ask</span> <span m="2479100">me</span> <span m="2479190">another</span> <span m="2479410">question</span> <span m="2480020">and</span> <span m="2480100">it would be</span> <span m="2480200">very</span> <span m="2480440">helpful</span> <span m="2480820">to</span> <span m="2480900">me.</span> </p>
<p><span m="2481655">AUDIENCE: How</span> <span m="2482100">did you</span> <span m="2482545">get</span> <span m="2484020">G1's</span> <span m="2486730">last and</span> <span m="2487045">first</span> <span m="2487360">functions</span> <span m="2487530">score</span> <span m="2487968">being</span> <span m="2488406">6?</span> </p>
<p><span m="2489720">PROFESSOR: OK.</span> <span m="2490770">Let's</span> <span m="2491080">take</span> <span m="2491290">that</span> <span m="2491680">apart.</span> <span m="2500260">We</span> <span m="2500460">want</span> <span m="2500670">to</span> <span m="2500720">know</span> <span m="2501060">what</span> <span m="2501770">LF</span> <span m="2503530">of</span> <span m="2506830">6</span> <span m="2507490">and</span> <span m="2508880">where</span> <span m="2509070">was</span> <span m="2509230">that</span> <span m="2509430">G1?</span> <span m="2510040">G1</span> <span m="2510140">is</span> <span m="2510590">1</span> <span m="2510750">and</span> <span m="2510860">0,</span> <span m="2511080">right?</span> <span m="2511590">Sorry.</span> <span m="2512270">LF</span> <span m="2512535">of</span> <span m="2512800">1</span> <span m="2514100">and</span> <span m="2515120">g</span> <span m="2515680">is</span> <span m="2515840">equal</span> <span m="2516070">to,</span> <span m="2516270">right?</span> <span m="2518490">Is</span> <span m="2518640">that</span> <span m="2518860">g</span> <span m="2519050">and</span> <span m="2519130">1</span> <span m="2519340">or</span> <span m="2519410">0?</span> <span m="2520640">Oop,</span> <span m="2520790">sorry</span> <span m="2521070">it's in</span> <span m="2521130">0.</span> <span m="2522940">So</span> <span m="2523120">this</span> <span m="2523350">is</span> <span m="2523410">what</span> <span m="2523570">you</span> <span m="2523650">like</span> <span m="2523820">me</span> <span m="2523890">to</span> <span m="2523960">compute,</span> <span m="2524410">right?</span> </p>
<p><span m="2525720">OK</span> <span m="2526240">what's</span> <span m="2526740">Occ</span> <span m="2527162">of</span> <span m="2527584">g?</span> <span m="2529160">It's</span> <span m="2529320">how</span> <span m="2529480">many</span> <span m="2529670">characters</span> <span m="2530140">are</span> <span m="2530350">less</span> <span m="2530600">than</span> <span m="2530740">g</span> <span m="2531140">in</span> <span m="2531230">the</span> <span m="2531340">original</span> <span m="2531740">string?</span> <span m="2539050">I'll</span> <span m="2539190">give you</span> <span m="2539340">a</span> <span m="2539450">clue.</span> <span m="2540156">It's</span> <span m="2540510">1,</span> <span m="2540820">2,</span> <span m="2541130">3,</span> <span m="2541400">4,</span> <span m="2541720">5,</span> <span m="2542080">6.</span> </p>
<p><span m="2542680">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2547330">PROFESSOR: No,</span> <span m="2547590">it's</span> <span m="2547840">how many</span> <span m="2547890">characters</span> <span m="2548175">are</span> <span m="2548460">less</span> <span m="2548730">than</span> <span m="2549000">g</span> <span m="2549430">in the</span> <span m="2549640">original</span> <span m="2550116">string.</span> <span m="2550592">How many things</span> <span m="2551070">are going to distort</span> <span m="2551540">underneath</span> <span m="2552020">it?</span> <span m="2552560">Where do the</span> <span m="2552980">g's</span> <span m="2553330">begin</span> <span m="2553800">in</span> <span m="2553880">the</span> <span m="2553950">sorted</span> <span m="2554200">version?</span> <span m="2556270">The</span> <span m="2556580">g's</span> <span m="2556860">begin in</span> <span m="2557150">row 6.</span> <span m="2559380">OK?</span> <span m="2560840">So</span> <span m="2561400">OCC</span> <span m="2561725">of</span> <span m="2562050">g</span> <span m="2562476">is</span> <span m="2562902">6.</span> <span m="2565560">Is</span> <span m="2565670">that--</span> <span m="2566090">are you</span> <span m="2566500">getting</span> <span m="2566890">hung</span> <span m="2567080">up</span> <span m="2567220">on</span> <span m="2567300">that</span> <span m="2567580">point?</span> </p>
<p><span m="2568354">AUDIENCE: Yes.</span> <span m="2568848">How do</span> <span m="2569342">you know</span> <span m="2569836">that without</span> <span m="2570330">ever</span> <span m="2570824">referencing</span> <span m="2571318">back</span> <span m="2571812">to</span> <span m="2572306">the</span> <span m="2572800">first</span> <span m="2573300">5</span> <span m="2573971">columns?</span> </p>
<p><span m="2574422">PROFESSOR: Because</span> <span m="2574873">when we</span> <span m="2575324">build</span> <span m="2575775">the index</span> <span m="2576226">we</span> <span m="2576680">remember.</span> </p>
<p><span m="2577486">AUDIENCE: Oh,</span> <span m="2577890">OK.</span> </p>
<p><span m="2579790">PROFESSOR: So</span> <span m="2580290">we</span> <span m="2580490">have</span> <span m="2580690">to,</span> <span m="2581350">I</span> <span m="2581810">haven't</span> <span m="2582160">told</span> <span m="2582390">you</span> <span m="2582460">this,</span> <span m="2582630">but</span> <span m="2582750">I</span> <span m="2582850">need</span> <span m="2583050">to</span> <span m="2583200">compute,</span> <span m="2583800">I</span> <span m="2584020">need</span> <span m="2584240">to</span> <span m="2584350">remember</span> <span m="2585380">ways</span> <span m="2585720">to</span> <span m="2585820">compute</span> <span m="2586190">Occ</span> <span m="2586440">and</span> <span m="2586720">count</span> <span m="2587020">really</span> <span m="2587340">quickly.</span> <span m="2588830">Occ</span> <span m="2589360">is</span> <span m="2589440">represented</span> <span m="2589950">by</span> <span m="2590060">four</span> <span m="2590460">values</span> <span m="2590920">only.</span> <span m="2592250">They're</span> <span m="2592400">where</span> <span m="2592520">the</span> <span m="2592690">a's</span> <span m="2593130">start,</span> <span m="2593570">the c's</span> <span m="2593660">start,</span> <span m="2594220">the</span> <span m="2594310">t's</span> <span m="2594570">start,</span> <span m="2594870">and the g's</span> <span m="2595230">start.</span> <span m="2595790">That's</span> <span m="2595940">all</span> <span m="2596120">I</span> <span m="2596190">need</span> <span m="2596360">to</span> <span m="2596440">know,</span> <span m="2596600">four</span> <span m="2596870">integers.</span> <span m="2597950">OK?</span> <span m="2601360">Are</span> <span m="2601680">you</span> <span m="2601840">happy</span> <span m="2602090">with</span> <span m="2602230">that?</span> </p>
<p><span m="2605070">Occ,</span> <span m="2606250">the a's</span> <span m="2606460">start</span> <span m="2606730">at</span> <span m="2606830">1.</span> <span m="2607140">The</span> <span m="2607210">c's</span> <span m="2607420">start</span> <span m="2607790">at 4</span> <span m="2608110">and the g's</span> <span m="2608460">start at</span> <span m="2608780">6.</span> <span m="2610310">OK?</span> <span m="2610540">That's</span> <span m="2610710">all</span> <span m="2610790">I</span> <span m="2610850">need</span> <span m="2611000">to</span> <span m="2611070">remember.</span> <span m="2612880">But</span> <span m="2612980">I</span> <span m="2613610">precompute</span> <span m="2614280">that.</span> <span m="2615420">OK?</span> <span m="2615600">Remember</span> <span m="2615875">it.</span> <span m="2616575">Are</span> <span m="2617000">you</span> <span m="2617120">happy</span> <span m="2617380">with</span> <span m="2617500">that</span> <span m="2617790">no?</span> </p>
<p><span m="2618200">AUDIENCE: Yes.</span> </p>
<p><span m="2618550">PROFESSOR: OK.</span> <span m="2619270">And</span> <span m="2619440">then</span> <span m="2620070">this</span> <span m="2620280">business</span> <span m="2620610">over</span> <span m="2620840">here</span> <span m="2621150">of</span> <span m="2625960">count</span> <span m="2629570">of</span> <span m="2630910">zero</span> <span m="2631660">and</span> <span m="2632820">g.</span> <span m="2633580">Right?</span> <span m="2636900">Which</span> <span m="2637000">is</span> <span m="2637480">how</span> <span m="2637710">many</span> <span m="2637990">g's,</span> <span m="2638880">what's</span> <span m="2639110">the</span> <span m="2639230">rank</span> <span m="2639500">of</span> <span m="2639580">this</span> <span m="2639790">g</span> <span m="2639990">in</span> <span m="2640090">the</span> <span m="2640180">right</span> <span m="2640340">hand</span> <span m="2640550">side?</span> <span m="2645160">1.</span> <span m="2646320">Minus</span> <span m="2646660">1</span> <span m="2646910">is</span> <span m="2647070">0.</span> <span m="2648170">So</span> <span m="2649620">that's</span> <span m="2649810">0.</span> <span m="2652810">That's</span> <span m="2652950">how</span> <span m="2653020">we</span> <span m="2653140">computed</span> <span m="2653420">it.</span> <span m="2654250">OK?</span> </p>
<p><span m="2657360">These</span> <span m="2657510">are</span> <span m="2657600">great</span> <span m="2657870">questions</span> <span m="2658530">because</span> <span m="2658690">I</span> <span m="2658760">think</span> <span m="2658940">they're</span> <span m="2659030">foundational.</span> <span m="2660460">Yeah.</span> </p>
<p><span m="2662248">AUDIENCE: Occ</span> <span m="2662747">and count</span> <span m="2663246">are both</span> <span m="2663745">precomputed</span> <span m="2664244">as you're</span> <span m="2664743">building</span> <span m="2665741">on</span> <span m="2666240">this</span> <span m="2666739">last</span> <span m="2667238">column</span> <span m="2668236">[INAUDIBLE].</span> </p>
<p><span m="2670731">PROFESSOR: They</span> <span m="2671240">are precomputed</span> <span m="2671690">and</span> <span m="2672860">well, I</span> <span m="2673140">have</span> <span m="2673330">not</span> <span m="2673560">told</span> <span m="2673820">you,</span> <span m="2674140">see,</span> <span m="2674750">you're</span> <span m="2674890">sort</span> <span m="2675040">of</span> <span m="2676280">ahead</span> <span m="2676620">of</span> <span m="2676680">things</span> <span m="2676890">a</span> <span m="2677000">little</span> <span m="2677240">bit</span> <span m="2677530">in</span> <span m="2677670">that</span> <span m="2677940">I'd</span> <span m="2678300">hoped</span> <span m="2678700">to</span> <span m="2678760">suspend</span> <span m="2679570">disbelief</span> <span m="2680420">and that</span> <span m="2680670">I</span> <span m="2680720">could</span> <span m="2680890">actually</span> <span m="2681090">build</span> <span m="2681350">these</span> <span m="2681500">very</span> <span m="2681710">efficiently.</span> <span m="2682140">But</span> <span m="2682260">yes,</span> <span m="2682540">they're</span> <span m="2682700">built</span> <span m="2682920">at</span> <span m="2682960">the</span> <span m="2683100">same</span> <span m="2683420">time as</span> <span m="2683670">the</span> <span m="2683790">index</span> <span m="2684070">is</span> <span m="2684170">built.</span> <span m="2685090">OK?</span> <span m="2685590">But</span> <span m="2685960">yes.</span> </p>
<p><span m="2687490">OK</span> <span m="2688130">and</span> <span m="2688320">if</span> <span m="2688440">I</span> <span m="2688530">have</span> <span m="2688870">Occ</span> <span m="2688980">and</span> <span m="2689350">count</span> <span m="2689530">and</span> <span m="2689650">I</span> <span m="2689710">have</span> <span m="2689970">the</span> <span m="2690050">string,</span> <span m="2690990">then</span> <span m="2691220">I</span> <span m="2691280">can</span> <span m="2691440">get</span> <span m="2691560">this.</span> <span m="2691690">But I can</span> <span m="2691830">still</span> <span m="2692000">need</span> <span m="2692150">to</span> <span m="2692220">get</span> <span m="2692380">to</span> <span m="2692460">Dan's</span> <span m="2692810">question</span> <span m="2693130">because</span> <span m="2693280">he has</span> <span m="2693450">been</span> <span m="2693705">very</span> <span m="2693960">patient</span> <span m="2694350">over</span> <span m="2694560">there.</span> <span m="2695140">He</span> <span m="2695290">wants</span> <span m="2695680">to</span> <span m="2695780">know</span> <span m="2695980">how</span> <span m="2696160">I</span> <span m="2696270">can</span> <span m="2696470">use</span> <span m="2696720">this</span> <span m="2696840">to</span> <span m="2696970">find</span> <span m="2698300">sequence</span> <span m="2698920">region</span> <span m="2699260">of</span> <span m="2699380">genome.</span> <span m="2699880">And</span> <span m="2699980">he's</span> <span m="2700190">just</span> <span m="2700370">being</span> <span m="2700590">so</span> <span m="2700800">good</span> <span m="2701060">over</span> <span m="2701220">there.</span> <span m="2701620">I</span> <span m="2701720">really</span> <span m="2701860">appreciate</span> <span m="2702320">that,</span> <span m="2702480">Dan.</span> <span m="2702780">Thanks</span> <span m="2702900">so</span> <span m="2703010">much</span> <span m="2703830">for</span> <span m="2703910">that.</span> <span m="2705620">Are</span> <span m="2705810">you</span> <span m="2706010">happier?</span> <span m="2707170">OK</span> <span m="2707460">you're</span> <span m="2707580">good.</span> <span m="2707930">All</span> <span m="2708110">right.</span> </p>
<p><span m="2708690">So</span> <span m="2710430">and</span> <span m="2710950">this</span> <span m="2711230">is</span> <span m="2711300">what</span> <span m="2711460">we</span> <span m="2711570">just</span> <span m="2711830">did.</span> <span m="2712600">The</span> <span m="2712700">walk</span> <span m="2713060">left</span> <span m="2713410">algorithm</span> <span m="2714540">actually</span> <span m="2714920">inverts</span> <span m="2715220">the</span> <span m="2715520">BWT</span> <span m="2716580">by</span> <span m="2716880">using</span> <span m="2717300">this</span> <span m="2717530">function</span> <span m="2717940">to</span> <span m="2718040">walk</span> <span m="2718400">left</span> <span m="2719340">and</span> <span m="2719650">using</span> <span m="2720160">that</span> <span m="2720380">Python</span> <span m="2720850">code</span> <span m="2721090">up</span> <span m="2721220">there,</span> <span m="2722020">you</span> <span m="2722160">can</span> <span m="2722280">actually</span> <span m="2722640">reconstruct</span> <span m="2723330">the</span> <span m="2723460">original</span> <span m="2724120">string</span> <span m="2724440">you</span> <span m="2724520">started</span> <span m="2724880">with.</span> <span m="2727310">So</span> <span m="2728070">it's</span> <span m="2728320">just</span> <span m="2728490">very</span> <span m="2728750">simple.</span> <span m="2730390">And</span> <span m="2730560">we</span> <span m="2730670">went</span> <span m="2730890">through</span> <span m="2731080">it on</span> <span m="2731180">the</span> <span m="2731250">board.</span> <span m="2733790">Are</span> <span m="2733910">there</span> <span m="2734020">any</span> <span m="2734130">questions</span> <span m="2734540">about</span> <span m="2734780">it</span> <span m="2734870">at all?</span> </p>
<p><span m="2737170">AUDIENCE: Yes.</span> <span m="2737700">Can you</span> <span m="2738195">actually</span> <span m="2738690">do this</span> <span m="2739680">any</span> <span m="2740175">column?</span> <span m="2742155">Like,</span> <span m="2742650">why are you</span> <span m="2743145">using the</span> <span m="2743640">last column</span> <span m="2744790">instead</span> <span m="2745140">of</span> <span m="2745470">like,</span> <span m="2745900">why</span> <span m="2746010">can't</span> <span m="2746330">you</span> <span m="2747138">just</span> <span m="2747626">change</span> <span m="2748114">it</span> <span m="2748602">like</span> <span m="2749578">the</span> <span m="2750066">[INAUDIBLE],</span> <span m="2753490">the</span> <span m="2754420">equation</span> <span m="2754680">and</span> <span m="2755115">make it</span> <span m="2755550">work</span> <span m="2755985">for--</span> </p>
<p><span m="2756420">PROFESSOR: Because</span> <span m="2756970">a very</span> <span m="2757250">important</span> <span m="2757590">thing</span> <span m="2757760">is</span> <span m="2757870">that</span> <span m="2758030">this</span> <span m="2758280">is</span> <span m="2758420">actually</span> <span m="2758870">a</span> <span m="2758910">very</span> <span m="2759270">important</span> <span m="2759680">property</span> <span m="2760060">right?</span> <span m="2760200">Which</span> <span m="2760330">is</span> <span m="2760430">all</span> <span m="2760630">the</span> <span m="2760720">suffixes</span> <span m="2761250">are</span> <span m="2761370">sorted</span> <span m="2761820">here.</span> <span m="2763200">And</span> <span m="2763380">if</span> <span m="2763500">we</span> <span m="2763610">didn't</span> <span m="2763990">do</span> <span m="2764120">that</span> <span m="2764430">though,</span> <span m="2764530">I</span> <span m="2764610">couldn't</span> <span m="2764900">answer</span> <span m="2765160">Dan's</span> <span m="2765450">question.</span> <span m="2768300">And</span> <span m="2768520">he'd</span> <span m="2768640">be</span> <span m="2768760">very</span> <span m="2769120">upset.</span> <span m="2769650">So</span> <span m="2770350">please</span> <span m="2770820">be</span> <span m="2770960">respectful</span> <span m="2771710">of</span> <span m="2771790">his</span> <span m="2772630">interest</span> <span m="2773070">here.</span> <span m="2774200">Now,</span> <span m="2774710">the</span> <span m="2774830">thing</span> <span m="2775140">is,</span> <span m="2776450">the</span> <span m="2776560">beauty</span> <span m="2777000">of</span> <span m="2777080">this</span> <span m="2777280">is, is</span> <span m="2777620">that</span> <span m="2777740">I</span> <span m="2777810">have</span> <span m="2777980">all</span> <span m="2778090">these</span> <span m="2778220">suffixes</span> <span m="2778580">sorted</span> <span m="2779080">and</span> <span m="2779180">what</span> <span m="2779310">you're</span> <span m="2779400">about</span> <span m="2779590">to</span> <span m="2779660">see</span> <span m="2779880">is</span> <span m="2779990">the</span> <span m="2780080">most</span> <span m="2780320">amazing</span> <span m="2780820">thing,</span> <span m="2781180">which</span> <span m="2781210">is</span> <span m="2781310">that</span> <span m="2781450">we're</span> <span m="2781570">going</span> <span m="2781660">to</span> <span m="2781700">snap</span> <span m="2781970">our</span> <span m="2782090">fingers</span> <span m="2782420">and,</span> <span m="2782570">bang,</span> <span m="2782880">we</span> <span m="2782970">can</span> <span m="2783090">map</span> <span m="2783330">200</span> <span m="2783540">million</span> <span m="2783840">reads in</span> <span m="2784110">no</span> <span m="2784220">time</span> <span m="2784460">at</span> <span m="2784500">all.</span> </p>
<p><span m="2787630">You</span> <span m="2787640">like</span> <span m="2787780">that?</span> <span m="2789560">You're</span> <span m="2789690">laughing.</span> <span m="2790315">Oh, oh,</span> <span m="2790580">that's</span> <span m="2790920">not a</span> <span m="2791280">good</span> <span m="2791730">That's not a good</span> <span m="2792180">sign.</span> </p>
<p><span m="2795190">Let's</span> <span m="2795420">press</span> <span m="2795640">ahead</span> <span m="2795890">fearlessly,</span> <span m="2796360">OK?</span> <span m="2797640">And</span> <span m="2797810">talk</span> <span m="2798030">about</span> <span m="2798200">how</span> <span m="2798320">we're</span> <span m="2798410">going</span> <span m="2798510">to</span> <span m="2798550">use</span> <span m="2798820">this</span> <span m="2799140">to</span> <span m="2799240">map</span> <span m="2799520">read.</span> <span m="2799870">So</span> <span m="2800030">we're</span> <span m="2800180">going</span> <span m="2800280">to</span> <span m="2800820">figure</span> <span m="2801120">out</span> <span m="2801160">how</span> <span m="2801420">to</span> <span m="2801480">use</span> <span m="2801720">this</span> <span m="2801850">index</span> <span m="2802940">and</span> <span m="2803180">this</span> <span m="2803320">transform</span> <span m="2803890">to</span> <span m="2804030">rapidly</span> <span m="2804470">aligned</span> <span m="2804780">reads</span> <span m="2804980">to a</span> <span m="2805160">reference</span> <span m="2805550">genome.</span> <span m="2806050">And we're</span> <span m="2806090">not</span> <span m="2806240">talking</span> <span m="2806510">about</span> <span m="2806740">one</span> <span m="2807010">read</span> <span m="2807375">or</span> <span m="2807740">10</span> <span m="2807930">reads</span> <span m="2808110">or 1</span> <span m="2808190">million</span> <span m="2808520">reads.</span> <span m="2808770">We're</span> <span m="2808950">talking</span> <span m="2809120">about</span> <span m="2809435">hundreds</span> <span m="2809750">of</span> <span m="2809850">millions</span> <span m="2810240">of</span> <span m="2810360">reads.</span> <span m="2810780">So it</span> <span m="2810880">has</span> <span m="2810950">be</span> <span m="2811060">very</span> <span m="2811530">efficient</span> <span m="2811930">indeed,</span> <span m="2812390">OK?</span> </p>
<p><span m="2815270">So</span> <span m="2816360">here's</span> <span m="2816680">the</span> <span m="2816790">essential</span> <span m="2817270">idea.</span> <span m="2818720">There's</span> <span m="2819170">the</span> <span m="2819260">core</span> <span m="2819530">algorithm</span> <span m="2820090">on</span> <span m="2820260">the</span> <span m="2820330">slide.</span> <span m="2821710">Which</span> <span m="2821880">is</span> <span m="2822020">that</span> <span m="2822600">what</span> <span m="2822780">we</span> <span m="2822910">do</span> <span m="2823150">is</span> <span m="2823250">we</span> <span m="2823380">take</span> <span m="2823620">the</span> <span m="2823800">original</span> <span m="2825810">query</span> <span m="2826260">that</span> <span m="2826380">we</span> <span m="2826510">have</span> <span m="2826800">the</span> <span m="2826950">read</span> <span m="2827220">that</span> <span m="2827300">we're</span> <span m="2827410">trying</span> <span m="2827700">to</span> <span m="2827770">match</span> <span m="2829200">and</span> <span m="2829390">we're</span> <span m="2829500">going</span> <span m="2829580">to</span> <span m="2829640">process</span> <span m="2830160">it</span> <span m="2830290">backwards</span> <span m="2830950">from</span> <span m="2831100">the</span> <span m="2831250">end</span> <span m="2831460">of</span> <span m="2831530">the</span> <span m="2831660">read</span> <span m="2832280">forwards.</span> <span m="2834700">And</span> <span m="2834900">we</span> <span m="2835040">begin</span> <span m="2835520">by</span> <span m="2835650">considering</span> <span m="2836150">all</span> <span m="2836380">possible</span> <span m="2836860">suffixes</span> <span m="2837800">from</span> <span m="2838250">row</span> <span m="2838600">zero</span> <span m="2839050">to,</span> <span m="2839860">in</span> <span m="2839970">this</span> <span m="2840140">case,</span> <span m="2840480">it</span> <span m="2840570">would</span> <span m="2840690">be</span> <span m="2840830">row</span> <span m="2841020">seven.</span> <span m="2844620">Which</span> <span m="2844830">is</span> <span m="2845080">the</span> <span m="2845680">length</span> <span m="2846160">of</span> <span m="2846340">the</span> <span m="2846450">entire</span> <span m="2846810">transform.</span> </p>
<p><span m="2848760">And</span> <span m="2849230">we</span> <span m="2849980">iterate</span> <span m="2851350">and</span> <span m="2854550">in</span> <span m="2854740">each</span> <span m="2855040">iteration</span> <span m="2856120">we</span> <span m="2856330">consider</span> <span m="2857540">suffixes</span> <span m="2859320">that</span> <span m="2859680">match</span> <span m="2860370">the</span> <span m="2860520">query.</span> <span m="2861320">So</span> <span m="2861530">in</span> <span m="2861650">the</span> <span m="2861740">first</span> <span m="2862140">step,</span> <span m="2863150">right</span> <span m="2863410">here,</span> <span m="2863810">let</span> <span m="2863940">me see</span> <span m="2864030">if</span> <span m="2864120">I can</span> <span m="2864360">get</span> <span m="2864420">my</span> <span m="2864540">point</span> <span m="2864830">working,</span> <span m="2868010">there we</span> <span m="2868130">are.</span> <span m="2869060">So</span> <span m="2869280">in</span> <span m="2869380">the</span> <span m="2869460">first</span> <span m="2869900">step</span> <span m="2870170">here,</span> <span m="2871010">we</span> <span m="2871230">matching</span> <span m="2871640">this</span> <span m="2872060">c.</span> <span m="2872790">OK?</span> <span m="2874450">And</span> <span m="2874600">we</span> <span m="2874720">compute</span> <span m="2875290">the</span> <span m="2875490">LF</span> <span m="2875860">of</span> <span m="2875970">the</span> <span m="2876110">top,</span> <span m="2876890">which</span> <span m="2877070">is</span> <span m="2877230">this</span> <span m="2877470">row</span> <span m="2878480">and</span> <span m="2878820">of</span> <span m="2879300">the</span> <span m="2879500">bottom,</span> <span m="2880000">which</span> <span m="2880040">is</span> <span m="2880140">down</span> <span m="2880410">here</span> <span m="2880590">pointing</span> <span m="2880870">off</span> <span m="2881020">the</span> <span m="2881140">end,</span> <span m="2882150">and</span> <span m="2882290">that</span> <span m="2882490">takes</span> <span m="2882730">us</span> <span m="2883080">to</span> <span m="2883200">the</span> <span m="2883290">first</span> <span m="2883780">d</span> <span m="2884080">here</span> <span m="2885010">and</span> <span m="2885230">to</span> <span m="2885310">this</span> <span m="2885540">point.</span> </p>
<p><span m="2886740">Here</span> <span m="2887110">are</span> <span m="2887260">the</span> <span m="2887420">two</span> <span m="2887660">c's</span> <span m="2889020">that</span> <span m="2889370">could</span> <span m="2889490">be</span> <span m="2889620">possible</span> <span m="2890990">matches</span> <span m="2891540">to</span> <span m="2891660">our</span> <span m="2891810">query,</span> <span m="2892760">which</span> <span m="2893040">ends</span> <span m="2893390">in</span> <span m="2893580">a</span> <span m="2893650">c.</span> <span m="2896880">We</span> <span m="2897080">then</span> <span m="2897380">say,</span> <span m="2899320">oh,</span> <span m="2899940">the</span> <span m="2900040">next</span> <span m="2900220">character</span> <span m="2900520">we</span> <span m="2900610">have</span> <span m="2900760">to</span> <span m="2900850">match</span> <span m="2901350">is</span> <span m="2901530">an</span> <span m="2901670">a.</span> <span m="2903150">So</span> <span m="2903360">we</span> <span m="2904420">look</span> <span m="2904590">here</span> <span m="2905050">at</span> <span m="2905220">the</span> <span m="2905370">a</span> <span m="2905670">we</span> <span m="2905810">need</span> <span m="2906000">to</span> <span m="2906070">match,</span> <span m="2907820">and</span> <span m="2908180">starting</span> <span m="2908760">from</span> <span m="2909400">this</span> <span m="2909940">row,</span> <span m="2912000">which</span> <span m="2912180">is</span> <span m="2912380">row</span> <span m="2912790">four,</span> <span m="2913740">and</span> <span m="2913920">this</span> <span m="2914120">row,</span> <span m="2914800">which</span> <span m="2915040">is</span> <span m="2915150">row</span> <span m="2915410">six,</span> <span m="2916840">we</span> <span m="2917020">compute</span> <span m="2917430">the</span> <span m="2917720">LF</span> <span m="2918150">of</span> <span m="2918250">each</span> <span m="2918460">one</span> <span m="2918650">of</span> <span m="2918750">these</span> <span m="2919840">to</span> <span m="2919980">figure</span> <span m="2920300">out</span> <span m="2920930">what</span> <span m="2921680">rows</span> <span m="2922350">in</span> <span m="2922600">a</span> <span m="2923170">precedes</span> <span m="2924180">these</span> <span m="2924960">c's.</span> </p>
<p><span m="2929530">And</span> <span m="2930110">the</span> <span m="2930220">way</span> <span m="2930420">we</span> <span m="2930570">compute</span> <span m="2931090">the</span> <span m="2931430">LF</span> <span m="2932310">is</span> <span m="2932470">that</span> <span m="2932520">we</span> <span m="2932660">use</span> <span m="2932900">the</span> <span m="2932990">character</span> <span m="2933260">a</span> <span m="2933530">to</span> <span m="2934040">be</span> <span m="2934280">able</span> <span m="2934470">to</span> <span m="2934530">figure</span> <span m="2934810">out</span> <span m="2934920">which</span> <span m="2935200">rows</span> <span m="2936010">have</span> <span m="2936290">the</span> <span m="2936570">a</span> <span m="2936740">preceding</span> <span m="2937280">the</span> <span m="2937390">c.</span> <span m="2939630">You</span> <span m="2939770">can</span> <span m="2939910">see,</span> <span m="2940230">when</span> <span m="2940330">we</span> <span m="2940460">compute</span> <span m="2941070">those</span> <span m="2941430">LF</span> <span m="2941650">functions,</span> <span m="2942820">what</span> <span m="2942940">we</span> <span m="2943060">wind</span> <span m="2943360">up</span> <span m="2943510">with</span> <span m="2944950">are</span> <span m="2945120">these</span> <span m="2945460">rows</span> <span m="2946300">where</span> <span m="2946530">we</span> <span m="2946640">have</span> <span m="2946930">a</span> <span m="2947270">followed</span> <span m="2947570">by</span> <span m="2947750">c.</span> <span m="2949150">So</span> <span m="2949570">we're</span> <span m="2949650">beginning</span> <span m="2949860">to</span> <span m="2950010">match</span> <span m="2951160">the</span> <span m="2951350">end</span> <span m="2951800">of</span> <span m="2951960">our</span> <span m="2952800">read,</span> <span m="2953530">as</span> <span m="2953680">we</span> <span m="2953790">go</span> <span m="2953980">from</span> <span m="2954270">right</span> <span m="2954930">to</span> <span m="2955080">left.</span> </p>
<p><span m="2956970">We</span> <span m="2957040">then</span> <span m="2957240">compute</span> <span m="2958170">the</span> <span m="2958280">same</span> <span m="2958480">thing</span> <span m="2958780">once</span> <span m="2958890">again,</span> <span m="2959220">considering</span> <span m="2959630">the</span> <span m="2959720">first</span> <span m="2960110">a</span> <span m="2960830">and</span> <span m="2960980">ask</span> <span m="2961450">what</span> <span m="2961880">rows</span> <span m="2968370">are</span> <span m="2968550">going</span> <span m="2968820">to</span> <span m="2969090">allow</span> <span m="2969330">us</span> <span m="2969440">to</span> <span m="2969540">put</span> <span m="2969720">this</span> <span m="2969890">a</span> <span m="2970145">in</span> <span m="2970400">front</span> <span m="2970740">of</span> <span m="2970860">the</span> <span m="2971010">ac</span> <span m="2972520">to</span> <span m="2972690">form</span> <span m="2973890">our</span> <span m="2975870">entire</span> <span m="2976360">read.</span> <span m="2977170">And</span> <span m="2977310">we</span> <span m="2977430">compute</span> <span m="2977780">the</span> <span m="2977890">LF</span> <span m="2978310">once</span> <span m="2978550">again</span> <span m="2980160">of</span> <span m="2980300">these</span> <span m="2980530">things.</span> <span m="2981600">And</span> <span m="2981650">you</span> <span m="2981760">can</span> <span m="2981890">see</span> <span m="2982090">that</span> <span m="2982210">here</span> <span m="2982780">it</span> <span m="2982890">takes</span> <span m="2983100">us</span> <span m="2983230">to</span> <span m="2983340">this</span> <span m="2983700">specific</span> <span m="2984230">row</span> <span m="2986490">aac.</span> <span m="2988770">So</span> <span m="2989510">that</span> <span m="2992600">row</span> <span m="2993000">represents</span> <span m="2993450">a</span> <span m="2993550">suffix</span> <span m="2994030">that</span> <span m="2994150">is</span> <span m="2994330">matching</span> <span m="2995430">our</span> <span m="2995640">query</span> <span m="2996070">exactly.</span> </p>
<p><span m="2998590">So</span> <span m="2998710">we</span> <span m="2998930">iterate</span> <span m="3001030">this</span> <span m="3001360">loop</span> <span m="3002380">to</span> <span m="3002470">be</span> <span m="3002600">able</span> <span m="3002730">to</span> <span m="3002850">match</span> <span m="3004570">a</span> <span m="3004750">read</span> <span m="3005430">against</span> <span m="3006390">the</span> <span m="3006570">index.</span> <span m="3008850">And</span> <span m="3009110">we're</span> <span m="3009230">using</span> <span m="3009570">the LF</span> <span m="3009700">function</span> <span m="3010470">to</span> <span m="3010570">do</span> <span m="3010780">it.</span> <span m="3013210">And</span> <span m="3013430">it's</span> <span m="3014480">a</span> <span m="3014630">really</span> <span m="3014870">beautiful</span> <span m="3015350">algorithm.</span> <span m="3016640">And</span> <span m="3016840">remember,</span> <span m="3018180">we</span> <span m="3018370">only</span> <span m="3018740">have</span> <span m="3019220">the</span> <span m="3019390">transform.</span> <span m="3019810">We</span> <span m="3019900">don't</span> <span m="3020050">have</span> <span m="3020180">the</span> <span m="3020260">rest</span> <span m="3020460">of</span> <span m="3020500">this</span> <span m="3020630">matrix.</span> </p>
<p><span m="3023890">So</span> <span m="3024080">before</span> <span m="3024740">I</span> <span m="3025410">press</span> <span m="3025700">ahead</span> <span m="3026270">and</span> <span m="3026440">talk</span> <span m="3026640">about</span> <span m="3028230">other</span> <span m="3028450">details,</span> <span m="3030050">I</span> <span m="3030130">think</span> <span m="3030370">it's</span> <span m="3030510">important</span> <span m="3030940">to</span> <span m="3031020">observe</span> <span m="3031390">a</span> <span m="3031460">couple</span> <span m="3031770">of</span> <span m="3031900">things</span> <span m="3032240">that</span> <span m="3032340">are</span> <span m="3032460">a</span> <span m="3032520">little</span> <span m="3032690">bit</span> <span m="3032860">counterintuitive</span> <span m="3033720">about</span> <span m="3034060">this.</span> <span m="3035480">One</span> <span m="3035740">counterintuitive</span> <span m="3036550">aspect</span> <span m="3037010">of</span> <span m="3037140">it</span> <span m="3037230">is,</span> <span m="3038100">that</span> <span m="3038740">when</span> <span m="3038920">I'm</span> <span m="3039080">over</span> <span m="3039370">here</span> <span m="3039710">for</span> <span m="3039890">example,</span> <span m="3042030">and</span> <span m="3042240">for</span> <span m="3042360">example</span> <span m="3042820">when I'm</span> <span m="3042940">computing</span> <span m="3043370">the</span> <span m="3043440">LF</span> <span m="3043910">here,</span> <span m="3045010">I'm</span> <span m="3045180">computing</span> <span m="3045720">the</span> <span m="3045900">LF</span> <span m="3046940">of</span> <span m="3047140">row</span> <span m="3047430">two</span> <span m="3048000">with</span> <span m="3048160">respect</span> <span m="3048810">to</span> <span m="3049120">a.</span> <span m="3050470">But</span> <span m="3050620">there's a</span> <span m="3050760">dollar</span> <span m="3051220">sign</span> <span m="3051470">there.</span> <span m="3053060">Right?</span> </p>
<p><span m="3054260">So</span> <span m="3054560">I'm</span> <span m="3055230">using</span> <span m="3055860">this</span> <span m="3056916">to</span> <span m="3057810">the LF</span> <span m="3057940">function,</span> <span m="3058880">to</span> <span m="3059070">tell</span> <span m="3059420">me</span> <span m="3059750">where</span> <span m="3060700">a</span> <span m="3061810">suffix</span> <span m="3062310">would</span> <span m="3062490">be</span> <span m="3064660">that</span> <span m="3065450">actually</span> <span m="3066450">follows</span> <span m="3067060">my</span> <span m="3067380">constraint</span> <span m="3067790">of having</span> <span m="3068010">to</span> <span m="3068140">have</span> <span m="3068320">an</span> <span m="3068620">a</span> <span m="3068963">be</span> <span m="3069306">the</span> <span m="3069650">prefix</span> <span m="3070130">of</span> <span m="3070280">ac,</span> <span m="3070660">where</span> <span m="3070860">I</span> <span m="3070890">am</span> <span m="3071040">right</span> <span m="3071240">now.</span> <span m="3073710">This</span> <span m="3073980">code</span> <span m="3074740">is</span> <span m="3075380">actually</span> <span m="3075830">not</span> <span m="3076130">fake</span> <span m="3076420">code.</span> <span m="3076750">It's the</span> <span m="3076870">actual</span> <span m="3077290">code</span> <span m="3077700">that's</span> <span m="3077870">in</span> <span m="3078350">a</span> <span m="3078430">matcher,</span> <span m="3079970">for</span> <span m="3080100">matching</span> <span m="3081000">a</span> <span m="3082250">read</span> <span m="3082770">against</span> <span m="3083800">the</span> <span m="3083930">index.</span> </p>
<p><span m="3086830">Now</span> <span m="3087140">let</span> <span m="3087290">me</span> <span m="3087400">just</span> <span m="3087540">stop</span> <span m="3087910">right</span> <span m="3088080">here</span> <span m="3088290">for</span> <span m="3088420">a</span> <span m="3088480">second</span> <span m="3088830">and</span> <span m="3088980">see</span> <span m="3089140">if</span> <span m="3089220">there</span> <span m="3089370">any</span> <span m="3089580">other</span> <span m="3089710">questions.</span> <span m="3090140">Dan</span> <span m="3090570">is</span> <span m="3090740">getting</span> <span m="3090990">now</span> <span m="3091280">his</span> <span m="3091470">answer</span> <span m="3091810">to</span> <span m="3091890">his</span> <span m="3092010">question,</span> <span m="3092390">right?</span> <span m="3092640">About</span> <span m="3092830">how</span> <span m="3092980">you</span> <span m="3093090">actually</span> <span m="3093340">use</span> <span m="3093510">this</span> <span m="3093670">for</span> <span m="3093760">matching</span> <span m="3094110">reads.</span> <span m="3095200">You</span> <span m="3095310">do</span> <span m="3095470">this</span> <span m="3095690">once</span> <span m="3096490">for</span> <span m="3096650">every</span> <span m="3096930">read.</span> <span m="3097800">And</span> <span m="3098090">it</span> <span m="3098290">is</span> <span m="3099620">linear</span> <span m="3100040">time.</span> <span m="3101660">Right?</span> <span m="3102510">It's</span> <span m="3102630">the</span> <span m="3102720">length</span> <span m="3103050">of</span> <span m="3103270">the</span> <span m="3104050">read</span> <span m="3104380">itself</span> <span m="3104750">is</span> <span m="3104840">all</span> <span m="3105020">the</span> <span m="3105080">time</span> <span m="3105320">it</span> <span m="3105400">takes</span> <span m="3105610">to</span> <span m="3105700">match</span> <span m="3106530">in</span> <span m="3106660">a</span> <span m="3106720">huge</span> <span m="3107040">genome.</span> </p>
<p><span m="3108410">So</span> <span m="3109040">once</span> <span m="3109330">we've</span> <span m="3109470">built</span> <span m="3109760">the</span> <span m="3109880">index</span> <span m="3110210">of</span> <span m="3110290">the</span> <span m="3110370">genome,</span> <span m="3111120">in</span> <span m="3111280">fact,</span> <span m="3111980">most</span> <span m="3112340">of</span> <span m="3112390">the</span> <span m="3112490">time</span> <span m="3113260">when</span> <span m="3113440">you're</span> <span m="3113530">doing</span> <span m="3113740">this</span> <span m="3113860">sort</span> <span m="3114010">of</span> <span m="3114230">mapping,</span> <span m="3115100">you</span> <span m="3115260">don't</span> <span m="3115420">build</span> <span m="3115640">the</span> <span m="3115770">index.</span> <span m="3116130">You</span> <span m="3116240">download</span> <span m="3116820">the</span> <span m="3116960">index</span> <span m="3117630">off of</span> <span m="3117880">a</span> <span m="3117940">website.</span> <span m="3119620">And</span> <span m="3119770">so</span> <span m="3119840">you</span> <span m="3119960">don't</span> <span m="3120080">have</span> <span m="3120200">to</span> <span m="3120300">pay</span> <span m="3120630">for</span> <span m="3120770">the</span> <span m="3120900">time</span> <span m="3121170">to</span> <span m="3121260">build</span> <span m="3121640">this</span> <span m="3122000">index.</span> <span m="3122760">You</span> <span m="3122880">just</span> <span m="3123000">download</span> <span m="3123410">the</span> <span m="3123510">index</span> <span m="3123930">and</span> <span m="3124060">you</span> <span m="3124110">take</span> <span m="3124320">your</span> <span m="3124510">reads</span> <span m="3125330">and</span> <span m="3125520">the</span> <span m="3125630">time</span> <span m="3126030">to</span> <span m="3126150">match</span> <span m="3126750">all</span> <span m="3127000">of</span> <span m="3127110">your</span> <span m="3127230">sequencing</span> <span m="3127720">reads</span> <span m="3128090">against</span> <span m="3128820">a</span> <span m="3128930">certain</span> <span m="3129190">build</span> <span m="3129690">of</span> <span m="3129820">whatever</span> <span m="3130110">genome</span> <span m="3130350">you're</span> <span m="3130500">using</span> <span m="3130930">is</span> <span m="3131340">simply</span> <span m="3131710">linear</span> <span m="3132350">in</span> <span m="3132480">the</span> <span m="3132750">number</span> <span m="3133040">of bases</span> <span m="3133370">you</span> <span m="3133470">have.</span> <span m="3135730">Questions?</span> <span m="3137030">Yes.</span> <span m="3137460">And</span> <span m="3137580">say</span> <span m="3137670">your</span> <span m="3137770">name</span> <span m="3137990">and the</span> <span m="3138070">question,</span> <span m="3138410">please.</span> </p>
<p><span m="3139805">AUDIENCE: How</span> <span m="3140270">did</span> <span m="3140735">[INAUDIBLE]</span> <span m="3141200">come up with</span> <span m="3141665">intuition</span> <span m="3142130">[INAUDIBLE]?</span> <span m="3142595">It</span> <span m="3143060">seems like</span> <span m="3143525">they just</span> <span m="3143990">pulled it out</span> <span m="3144455">of a hat.</span> </p>
<p><span m="3144930">PROFESSOR:</span> <span m="3145350">You know,</span> <span m="3145770">I asked Mike</span> <span m="3146170">that the other</span> <span m="3146630">day.</span> <span m="3147090">I</span> <span m="3147220">saw</span> <span m="3147450">him</span> <span m="3147560">in</span> <span m="3147640">a</span> <span m="3147680">meeting</span> <span m="3148030">and</span> <span m="3148100">he</span> <span m="3148250">sort</span> <span m="3148470">of</span> <span m="3148870">surprised</span> <span m="3149470">at</span> <span m="3149520">how</span> <span m="3150390">this</span> <span m="3150540">has</span> <span m="3150690">taken</span> <span m="3151060">off.</span> <span m="3153450">And</span> <span m="3155960">he</span> <span m="3156970">told</span> <span m="3157180">me</span> <span m="3157270">some</span> <span m="3157450">other</span> <span m="3158590">interesting</span> <span m="3159020">facts</span> <span m="3159340">about</span> <span m="3159610">this,</span> <span m="3159820">which</span> <span m="3160130">you</span> <span m="3160270">probably</span> <span m="3160530">could</span> <span m="3160710">deduce.</span> <span m="3161050">Which</span> <span m="3161220">is</span> <span m="3161360">that</span> <span m="3162190">if</span> <span m="3162380">you</span> <span m="3162510">only</span> <span m="3162810">want</span> <span m="3163040">to</span> <span m="3163090">match</span> <span m="3163420">reads</span> <span m="3163860">that</span> <span m="3164000">are</span> <span m="3164210">four</span> <span m="3164620">long,</span> <span m="3164970">you</span> <span m="3165090">only</span> <span m="3165250">have</span> <span m="3165350">to</span> <span m="3165460">sort</span> <span m="3165800">this</span> <span m="3166250">matrix</span> <span m="3167300">by</span> <span m="3167430">the</span> <span m="3167550">first</span> <span m="3167860">four</span> <span m="3168070">characters.</span> <span m="3170810">But</span> <span m="3170930">there</span> <span m="3171050">are</span> <span m="3171110">other</span> <span m="3171340">little</span> <span m="3171570">tricks</span> <span m="3171880">you</span> <span m="3171980">can play</span> <span m="3172380">here.</span> </p>
<p><span m="3174260">Any</span> <span m="3174470">other</span> <span m="3174610">questions?</span> <span m="3175500">Yes.</span> </p>
<p><span m="3176290">AUDIENCE: I'm</span> <span m="3176640">Deborah.</span> <span m="3177300">What</span> <span m="3177530">is</span> <span m="3177760">the</span> <span m="3177860">FM</span> <span m="3178630">index?</span> </p>
<p><span m="3180370">PROFESSOR: What</span> <span m="3180640">is</span> <span m="3180890">the</span> <span m="3181280">FM index.</span> <span m="3184070">Well,</span> <span m="3184520">the</span> <span m="3184680">guys</span> <span m="3184970">who</span> <span m="3185060">thought</span> <span m="3185310">this</span> <span m="3185480">up</span> <span m="3185640">have</span> <span m="3185860">the</span> <span m="3185930">last</span> <span m="3186210">initials</span> <span m="3186270">of</span> <span m="3186620">F</span> <span m="3186810">and M,</span> <span m="3186920">but</span> <span m="3187250">that's</span> <span m="3187730">not</span> <span m="3188020">what</span> <span m="3188150">it</span> <span m="3188220">stands</span> <span m="3188560">for,</span> <span m="3189720">contrary</span> <span m="3190020">to</span> <span m="3190110">popular</span> <span m="3190480">opinion.</span> <span m="3191360">It</span> <span m="3191540">stands</span> <span m="3191890">for</span> <span m="3193180">full</span> <span m="3193650">text</span> <span m="3194320">minute</span> <span m="3194940">size.</span> <span m="3196900">That's what</span> <span m="3197020">they</span> <span m="3197130">claim.</span> <span m="3198090">So</span> <span m="3198960">if</span> <span m="3199100">you</span> <span m="3199200">hear</span> <span m="3199380">people</span> <span m="3199650">talking about</span> <span m="3199990">full</span> <span m="3200310">text</span> <span m="3200630">minute</span> <span m="3200900">size</span> <span m="3201200">indices,</span> <span m="3202080">or</span> <span m="3202220">FM</span> <span m="3202570">indices,</span> <span m="3203740">the</span> <span m="3203900">Fm</span> <span m="3204360">index</span> <span m="3204800">is</span> <span m="3204920">actually</span> <span m="3205230">the</span> <span m="3207050">part</span> <span m="3207320">that</span> <span m="3207440">was</span> <span m="3207580">being</span> <span m="3207810">asked</span> <span m="3208190">over</span> <span m="3208410">here,</span> <span m="3209330">the</span> <span m="3209520">Occ</span> <span m="3210060">part</span> <span m="3210430">and</span> <span m="3210610">the</span> <span m="3210890">LF</span> <span m="3211230">part,</span> <span m="3211530">how</span> <span m="3211710">you</span> <span m="3211830">actually</span> <span m="3212070">compute</span> <span m="3212360">those</span> <span m="3212510">quickly.</span> </p>
<p><span m="3213830">That</span> <span m="3213980">was</span> <span m="3214110">what</span> <span m="3214420">FNM</span> <span m="3214930">contributed</span> <span m="3215480">to</span> <span m="3215570">this</span> <span m="3215930">but,</span> <span m="3217190">generically</span> <span m="3217800">when</span> <span m="3217910">we're</span> <span m="3218030">talking</span> <span m="3218320">about</span> <span m="3218480">this</span> <span m="3218730">style</span> <span m="3219370">of</span> <span m="3219990">indexing,</span> <span m="3220780">it's</span> <span m="3220940">called</span> <span m="3221540">FM</span> <span m="3221890">indexing</span> <span m="3222320">or you</span> <span m="3222570">might</span> <span m="3222690">hear,</span> <span m="3223050">I'm</span> <span m="3223140">using</span> <span m="3223400">a</span> <span m="3223450">BWT.</span> <span m="3224420">Some</span> <span m="3224640">people</span> <span m="3224950">will</span> <span m="3225070">say</span> <span m="3225280">that.</span> <span m="3226460">But</span> <span m="3226860">that's</span> <span m="3227070">what</span> <span m="3227210">FM</span> <span m="3227470">stands</span> <span m="3227790">for.</span> <span m="3230350">Does that</span> <span m="3231840">answer</span> <span m="3232090">your</span> <span m="3232210">question?</span> </p>
<p><span m="3233130">Excellent.</span> <span m="3233620">OK.</span> <span m="3235010">All</span> <span m="3235090">right.</span> <span m="3235980">Any--</span> <span m="3236190">these</span> <span m="3236300">are all</span> <span m="3236600">great</span> <span m="3236790">questions.</span> <span m="3237270">Yes.</span> </p>
<p><span m="3239618">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="3248780">PROFESSOR: Oh,</span> <span m="3249450">you</span> <span m="3249980">don't</span> <span m="3250290">know</span> <span m="3250460">that</span> <span m="3250610">a and</span> <span m="3250890">c are</span> <span m="3251170">there,</span> <span m="3251910">except</span> <span m="3252340">that</span> <span m="3254090">remember,</span> <span m="3255220">if</span> <span m="3255370">you</span> <span m="3255750">look</span> <span m="3256050">at</span> <span m="3258370">the</span> <span m="3258780">way</span> <span m="3258980">that</span> <span m="3259120">this</span> <span m="3259290">is</span> <span m="3259410">working,</span> <span m="3260440">is</span> <span m="3261240">that</span> <span m="3261600">you're not actually</span> <span m="3261940">reconstructing</span> <span m="3264270">strings,</span> <span m="3264660">you're only</span> <span m="3264820">trying</span> <span m="3265040">to</span> <span m="3265100">find</span> <span m="3265520">them.</span> <span m="3267300">Right?</span> <span m="3267580">And</span> <span m="3267730">so</span> <span m="3267920">at</span> <span m="3268030">the end,</span> <span m="3268190">top</span> <span m="3268820">and</span> <span m="3268940">bottom</span> <span m="3269230">are</span> <span m="3269280">going</span> <span m="3269390">to</span> <span m="3269450">point</span> <span m="3269550">to</span> <span m="3271360">the</span> <span m="3271640">row</span> <span m="3272610">that</span> <span m="3272740">contains</span> <span m="3273060">the</span> <span m="3273170">suffix</span> <span m="3273570">where</span> <span m="3273760">your</span> <span m="3274150">original</span> <span m="3274520">read</span> <span m="3274730">was.</span> </p>
<p><span m="3275310">And</span> <span m="3275490">now</span> <span m="3275620">your</span> <span m="3275760">next</span> <span m="3276070">question</span> <span m="3276390">is</span> <span m="3276490">going</span> <span m="3276610">to</span> <span m="3276670">be,</span> <span m="3277310">where</span> <span m="3277540">is</span> <span m="3277630">that</span> <span m="3277800">in</span> <span m="3277890">the</span> <span m="3277970">genome?</span> <span m="3278910">This</span> <span m="3279070">doesn't</span> <span m="3279330">do</span> <span m="3279460">me</span> <span m="3279600">any</span> <span m="3279730">good.</span> <span m="3280110">I</span> <span m="3280190">mean,</span> <span m="3280770">the</span> <span m="3280880">number</span> <span m="3281160">1</span> <span m="3281640">doesn't</span> <span m="3281890">help</span> <span m="3282140">me</span> <span m="3282260">out</span> <span m="3282430">here,</span> <span m="3283300">doesn't</span> <span m="3283600">mean</span> <span m="3283760">anything.</span> <span m="3286530">Not</span> <span m="3286630">good,</span> <span m="3286940">right?</span> <span m="3288410">So</span> <span m="3288650">where</span> <span m="3288930">is</span> <span m="3289030">it</span> <span m="3289120">in</span> <span m="3289190">the</span> <span m="3289270">genome</span> <span m="3290340">is</span> <span m="3290500">the</span> <span m="3290580">next</span> <span m="3290800">question.</span> </p>
<p><span m="3292230">So</span> <span m="3293680">we'll</span> <span m="3293970">get</span> <span m="3294130">to</span> <span m="3294190">that</span> <span m="3294360">in</span> <span m="3294470">a</span> <span m="3294530">second.</span> <span m="3295390">What</span> <span m="3295610">happens</span> <span m="3295960">if</span> <span m="3296780">you</span> <span m="3296920">give</span> <span m="3297120">me</span> <span m="3297300">a</span> <span m="3297380">read</span> <span m="3297620">that</span> <span m="3297700">doesn't</span> <span m="3297980">match</span> <span m="3299360">anywhere</span> <span m="3299820">in</span> <span m="3299880">this</span> <span m="3300010">index?</span> <span m="3301220">Well</span> <span m="3301430">if</span> <span m="3301530">you</span> <span m="3301620">give</span> <span m="3301810">me</span> <span m="3301980">a</span> <span m="3302040">read</span> <span m="3302240">that</span> <span m="3302300">doesn't</span> <span m="3302530">match</span> <span m="3302730">anywhere</span> <span m="3303010">in</span> <span m="3303060">this</span> <span m="3303190">index,</span> <span m="3303650">what</span> <span m="3303810">happens</span> <span m="3304260">is</span> <span m="3304920">the</span> <span m="3305080">top</span> <span m="3305340">and</span> <span m="3305450">bottom</span> <span m="3305720">become</span> <span m="3306020">the</span> <span m="3306100">same.</span> <span m="3308010">So</span> <span m="3308140">on</span> <span m="3308240">top</span> <span m="3308450">and</span> <span m="3308540">bottom</span> <span m="3308760">become</span> <span m="3309040">the</span> <span m="3309120">same,</span> <span m="3309560">it's</span> <span m="3309720">a</span> <span m="3309770">failed</span> <span m="3310550">look</span> <span m="3310720">up.</span> <span m="3312710">All</span> <span m="3312750">right?</span> </p>
<p><span m="3316000">And</span> <span m="3317950">that's</span> <span m="3318200">because</span> <span m="3318480">the</span> <span m="3318570">suffix</span> <span m="3318970">doesn't</span> <span m="3319270">exist</span> <span m="3319620">in</span> <span m="3319690">the</span> <span m="3319790">index.</span> <span m="3322290">And</span> <span m="3322500">once</span> <span m="3323080">top</span> <span m="3323300">and</span> <span m="3323400">bottom</span> <span m="3324030">become</span> <span m="3324320">the</span> <span m="3324390">same,</span> <span m="3325120">they</span> <span m="3325210">remain</span> <span m="3325490">the</span> <span m="3325570">same</span> <span m="3325830">throughout</span> <span m="3326110">that</span> <span m="3326280">loop.</span> <span m="3327980">Yes.</span> </p>
<p><span m="3329070">AUDIENCE: I'm</span> <span m="3329553">Sally.</span> <span m="3330519">My main</span> <span m="3331002">question is</span> <span m="3331485">that</span> <span m="3331968">this doesn't</span> <span m="3332451">provide</span> <span m="3332934">any</span> <span m="3333417">leeway</span> <span m="3333900">for</span> <span m="3334383">errors.</span> <span m="3334866">You kind of</span> <span m="3335349">have to</span> <span m="3335832">be able</span> <span m="3336315">to present</span> <span m="3337281">all</span> <span m="3337764">of</span> <span m="3338247">your</span> <span m="3338730">rates.</span> </p>
<p><span m="3339220">PROFESSOR: Sally,</span> <span m="3339515">you're</span> <span m="3339810">absolutely</span> <span m="3340300">correct.</span> <span m="3340640">I'm so glad</span> <span m="3340980">you asked</span> <span m="3341200">that</span> <span m="3341700">question.</span> <span m="3342100">Your</span> <span m="3343420">observation</span> <span m="3343725">is it</span> <span m="3344030">does</span> <span m="3344420">not</span> <span m="3344590">provide</span> <span m="3344960">any</span> <span m="3345160">leeway</span> <span m="3345450">for</span> <span m="3345600">mismatches.</span> <span m="3346880">And</span> <span m="3347140">so</span> <span m="3347760">unlike</span> <span m="3348150">all</span> <span m="3348340">the</span> <span m="3348440">other</span> <span m="3348680">algorithms</span> <span m="3349060">we</span> <span m="3349180">study,</span> <span m="3349420">which</span> <span m="3349560">had</span> <span m="3349690">these</span> <span m="3349840">very</span> <span m="3350080">nice</span> <span m="3350300">matrices</span> <span m="3350890">and</span> <span m="3351020">ability</span> <span m="3351360">to</span> <span m="3351490">assign</span> <span m="3352850">weights</span> <span m="3353190">to</span> <span m="3353270">mismatches,</span> <span m="3354220">this</span> <span m="3354400">is</span> <span m="3354500">only</span> <span m="3354720">doing</span> <span m="3354940">exact</span> <span m="3355450">matching.</span> </p>
<p><span m="3356440">And</span> <span m="3356610">so</span> <span m="3356740">what</span> <span m="3356880">you</span> <span m="3356990">need</span> <span m="3357160">help</span> <span m="3357360">understanding</span> <span m="3357860">is,</span> <span m="3357960">how</span> <span m="3358320">we</span> <span m="3358470">can</span> <span m="3358620">deal</span> <span m="3358980">with</span> <span m="3359620">mismatches</span> <span m="3360320">in</span> <span m="3360420">the</span> <span m="3360510">presence</span> <span m="3360890">of</span> <span m="3360960">this.</span> <span m="3361570">And</span> <span m="3361800">I'll</span> <span m="3361970">get</span> <span m="3362230">to</span> <span m="3362310">that</span> <span m="3362980">in</span> <span m="3363780">less</span> <span m="3364120">than</span> <span m="3364290">10</span> <span m="3364490">minutes.</span> <span m="3365390">And</span> <span m="3367710">it</span> <span m="3367870">won't</span> <span m="3368110">be</span> <span m="3368220">quite</span> <span m="3368590">as</span> <span m="3368750">elegant</span> <span m="3369230">as</span> <span m="3369390">what</span> <span m="3369540">you</span> <span m="3369650">saw</span> <span m="3369970">from</span> <span m="3370170">Professor</span> <span m="3370570">Berg</span> <span m="3371050">but</span> <span m="3371180">it's</span> <span m="3371280">what</span> <span m="3371450">everybody</span> <span m="3371860">does.</span> <span m="3372530">So</span> <span m="3374010">that's</span> <span m="3374260">my</span> <span m="3374430">only</span> <span m="3374760">excuse</span> <span m="3375210">for</span> <span m="3375470">it</span> <span m="3375530">OK?</span> <span m="3378250">Yes.</span> </p>
<p><span m="3379240">AUDIENCE: What</span> <span m="3379620">is</span> <span m="3379800">the</span> <span m="3379930">bottom</span> <span m="3380760">set of</span> <span m="3380980">arrows</span> <span m="3381510">doing?</span> <span m="3382890">What's its</span> <span m="3383230">significance?</span> </p>
<p><span m="3384260">PROFESSOR: The</span> <span m="3384740">significance</span> <span m="3385220">of top and bottom,</span> <span m="3385700">that's a</span> <span m="3386180">great</span> <span m="3386420">question.</span> <span m="3387470">What</span> <span m="3387660">the</span> <span m="3387770">significance</span> <span m="3387940">of</span> <span m="3388270">top</span> <span m="3388490">and</span> <span m="3388590">bottom?</span> <span m="3389270">Top</span> <span m="3389560">and</span> <span m="3389690">bottom</span> <span m="3390360">bracket</span> <span m="3392650">in</span> <span m="3392840">that</span> <span m="3392990">original</span> <span m="3393390">matrix,</span> <span m="3393890">the</span> <span m="3393990">suffixes</span> <span m="3394710">that</span> <span m="3394880">are</span> <span m="3395260">matching</span> <span m="3396310">the</span> <span m="3396660">original</span> <span m="3397080">query.</span> <span m="3398080">OK?</span> <span m="3399000">And</span> <span m="3399200">so</span> <span m="3399990">between</span> <span m="3400640">top</span> <span m="3401040">and</span> <span m="3401260">bottom</span> <span m="3401620">minus</span> <span m="3402020">1</span> <span m="3402795">are</span> <span m="3403060">all</span> <span m="3403580">of</span> <span m="3403900">the</span> <span m="3404400">rows</span> <span m="3405020">that</span> <span m="3405140">have</span> <span m="3405320">a</span> <span m="3405380">suffix</span> <span m="3405870">that</span> <span m="3406000">match</span> <span m="3406300">our</span> <span m="3406490">original</span> <span m="3406900">query.</span> <span m="3408870">And if</span> <span m="3409080">top</span> <span m="3409610">equals</span> <span m="3410020">bottom,</span> <span m="3410490">there</span> <span m="3410730">are</span> <span m="3411010">no</span> <span m="3411940">matching</span> <span m="3412270">suffixes.</span> <span m="3413250">But</span> <span m="3413450">assuming</span> <span m="3413820">there are matching</span> <span m="3414260">suffixes,</span> <span m="3415120">those</span> <span m="3415570">are</span> <span m="3415750">rows that</span> <span m="3415980">contain</span> <span m="3416300">a</span> <span m="3416340">matching</span> <span m="3416630">suffix.</span> <span m="3417020">And</span> <span m="3417150">as</span> <span m="3417340">we</span> <span m="3417490">progress</span> <span m="3417970">along,</span> <span m="3419390">top</span> <span m="3419620">and</span> <span m="3419720">bottom</span> <span m="3419990">change</span> <span m="3420480">as</span> <span m="3420880">the</span> <span m="3420940">suffixes</span> <span m="3421540">change as</span> <span m="3421890">we</span> <span m="3422060">expand</span> <span m="3422950">the</span> <span m="3423030">suffix</span> <span m="3423410">to</span> <span m="3423510">contain</span> <span m="3423830">more</span> <span m="3424200">and</span> <span m="3424280">more</span> <span m="3424480">bases.</span> </p>
<p><span m="3425790">OK?</span> <span m="3427720">OK.</span> <span m="3429150">Any</span> <span m="3429330">other</span> <span m="3429450">questions?</span> <span m="3431380">OK.</span> <span m="3432140">So</span> <span m="3434160">now</span> <span m="3434540">back</span> <span m="3434770">to</span> <span m="3434850">the</span> <span m="3434940">question</span> <span m="3435350">over</span> <span m="3435550">here,</span> <span m="3436260">which</span> <span m="3436330">is</span> <span m="3436440">that</span> <span m="3437020">OK,</span> <span m="3437410">I</span> <span m="3437530">know</span> <span m="3438400">that</span> <span m="3439880">we've</span> <span m="3440070">matched,</span> <span m="3440710">and</span> <span m="3440930">I</span> <span m="3440990">know</span> <span m="3441230">that</span> <span m="3441330">we</span> <span m="3441430">have</span> <span m="3441630">this</span> <span m="3441770">hit.</span> <span m="3442970">The</span> <span m="3443090">question</span> <span m="3443460">is,</span> <span m="3444030">where</span> <span m="3444300">is</span> <span m="3444430">it</span> <span m="3444550">in</span> <span m="3444700">the</span> <span m="3444780">Genome</span> <span m="3446230">because</span> <span m="3447040">the</span> <span m="3447130">fact</span> <span m="3447460">that</span> <span m="3447560">it</span> <span m="3447670">matched</span> <span m="3449050">row</span> <span m="3449490">one</span> <span m="3449970">of</span> <span m="3450180">my</span> <span m="3450550">BWT</span> <span m="3451140">matrix</span> <span m="3451510">does</span> <span m="3451690">me</span> <span m="3451850">absolutely</span> <span m="3452300">no</span> <span m="3452450">good</span> <span m="3452610">at</span> <span m="3452680">all.</span> <span m="3454640">Right?</span> </p>
<p><span m="3455360">Anybody</span> <span m="3455740">have</span> <span m="3455920">any</span> <span m="3456090">ideas</span> <span m="3456390">about</span> <span m="3456530">how</span> <span m="3456650">we could</span> <span m="3456730">figure</span> <span m="3457110">out</span> <span m="3457390">where it</span> <span m="3457490">is</span> <span m="3457560">the</span> <span m="3457640">genome?</span> <span m="3459010">Given</span> <span m="3459310">what</span> <span m="3459420">I've</span> <span m="3459510">told</span> <span m="3459740">you</span> <span m="3459840">so</span> <span m="3460060">far,</span> <span m="3460330">which</span> <span m="3460490">is</span> <span m="3460590">that</span> <span m="3460670">you</span> <span m="3460760">have</span> <span m="3461160">the</span> <span m="3461230">BWT,</span> <span m="3462850">you</span> <span m="3462970">have</span> <span m="3463630">Occ,</span> <span m="3464770">and</span> <span m="3464880">you</span> <span m="3464960">have</span> <span m="3465130">count,</span> <span m="3465520">and</span> <span m="3465590">you</span> <span m="3465680">can</span> <span m="3465820">compute</span> <span m="3466120">the LF</span> <span m="3466210">function.</span> <span m="3469620">Any</span> <span m="3469910">ideas?</span> <span m="3472400">Doesn't</span> <span m="3472660">matter</span> <span m="3472910">how</span> <span m="3473060">slow</span> <span m="3473390">it</span> <span m="3473460">is.</span> </p>
<p><span m="3481110">OK</span> <span m="3482770">well</span> <span m="3483280">how</span> <span m="3483560">could</span> <span m="3483690">I</span> <span m="3483740">figure</span> <span m="3484060">out</span> <span m="3484140">what</span> <span m="3484330">came</span> <span m="3484580">before</span> <span m="3485020">aac</span> <span m="3485710">in</span> <span m="3485780">the</span> <span m="3485860">genome?</span> <span m="3486470">Yes.</span> </p>
<p><span m="3487330">AUDIENCE: So,</span> <span m="3487810">for,</span> <span m="3488075">like at the</span> <span m="3488340">beginning,</span> <span m="3489063">we</span> <span m="3489476">rebuilt</span> <span m="3490130">this</span> <span m="3490460">whole</span> <span m="3490650">string,</span> <span m="3491400">starting</span> <span m="3491840">at</span> <span m="3492254">the</span> <span m="3492668">end.</span> <span m="3493082">You could</span> <span m="3493496">rebuild</span> <span m="3493910">the whole</span> <span m="3494090">string starting</span> <span m="3494530">at,</span> <span m="3495814">rebuild</span> <span m="3496242">the</span> <span m="3496670">whole</span> <span m="3497100">genome</span> <span m="3497430">starting</span> <span m="3497700">at</span> <span m="3498183">the 1</span> <span m="3498666">and see--</span> </p>
<p><span m="3499150">PROFESSOR: You</span> <span m="3499280">could</span> <span m="3499680">rebuild</span> <span m="3500120">the</span> <span m="3500280">entire</span> <span m="3500665">genome</span> <span m="3501770">that</span> <span m="3502090">prepends</span> <span m="3502970">or</span> <span m="3503240">occurs</span> <span m="3503700">before</span> <span m="3503980">aac,</span> <span m="3504740">right?</span> </p>
<p><span m="3505020">AUDIENCE: Exactly.</span> </p>
<p><span m="3505660">PROFESSOR: Exactly.</span> <span m="3506190">So</span> <span m="3506330">that's</span> <span m="3506550">what</span> <span m="3506660">we</span> <span m="3506790">can</span> <span m="3506940">do.</span> <span m="3507530">We</span> <span m="3507690">could</span> <span m="3507870">actually</span> <span m="3509690">do</span> <span m="3510920">our</span> <span m="3511150">walk</span> <span m="3511450">left</span> <span m="3511710">algorithm.</span> <span m="3512730">We</span> <span m="3512890">can</span> <span m="3513060">walk</span> <span m="3513450">left</span> <span m="3513970">from</span> <span m="3514080">there,</span> <span m="3514720">find</span> <span m="3515080">out</span> <span m="3515230">that</span> <span m="3515300">we</span> <span m="3515430">go</span> <span m="3515560">two</span> <span m="3515810">steps</span> <span m="3516170">until</span> <span m="3516410">we</span> <span m="3516530">hit</span> <span m="3516670">dollar</span> <span m="3517030">sign,</span> <span m="3518020">and</span> <span m="3518230">therefore,</span> <span m="3519480">the</span> <span m="3519620">offset</span> <span m="3520080">is</span> <span m="3520260">two,</span> <span m="3520530">where</span> <span m="3520800">it</span> <span m="3521070">occurs</span> <span m="3521520">in</span> <span m="3521590">the</span> <span m="3521670">genome.</span> <span m="3523070">So</span> <span m="3523150">we</span> <span m="3523260">can</span> <span m="3523410">give</span> <span m="3524030">a</span> <span m="3524080">match</span> <span m="3524390">position</span> <span m="3524770">by</span> <span m="3524890">walking</span> <span m="3525300">left.</span> <span m="3527590">Does</span> <span m="3527920">everybody</span> <span m="3528060">see</span> <span m="3528240">that,</span> <span m="3528430">that we</span> <span m="3528600">could</span> <span m="3528720">walk</span> <span m="3529050">left</span> <span m="3529780">to</span> <span m="3529860">figure</span> <span m="3530170">where</span> <span m="3530380">it</span> <span m="3530420">is?</span> <span m="3532160">It's</span> <span m="3532390">not</span> <span m="3532640">fast,</span> <span m="3533070">but</span> <span m="3533150">it</span> <span m="3533210">works.</span> <span m="3533700">Yes.</span> </p>
<p><span m="3534870">AUDIENCE: I'm</span> <span m="3535255">Ted.</span> </p>
<p><span m="3535640">PROFESSOR: Hi,</span> <span m="3535740">Ted.</span> </p>
<p><span m="3536290">AUDIENCE: So</span> <span m="3537090">now</span> <span m="3537463">our</span> <span m="3537836">function</span> <span m="3539701">first has</span> <span m="3540198">to take</span> <span m="3541192">the</span> <span m="3541689">read</span> <span m="3542186">and it</span> <span m="3542683">has to</span> <span m="3543180">align</span> <span m="3543677">it</span> <span m="3544180">and</span> <span m="3544655">the</span> <span m="3545130">same,</span> <span m="3546210">where</span> <span m="3546655">the</span> <span m="3547100">position</span> <span m="3548582">is</span> <span m="3549076">built</span> <span m="3549570">into the</span> <span m="3550064">end</span> <span m="3550558">of</span> <span m="3551052">the</span> <span m="3551546">function,</span> <span m="3553028">the</span> <span m="3553522">speed of</span> <span m="3554016">the</span> <span m="3554510">function</span> <span m="3555004">is now</span> <span m="3555992">dependent</span> <span m="3556486">on</span> <span m="3557480">position</span> <span m="3557745">as</span> <span m="3558010">well.</span> <span m="3558873">Is that</span> <span m="3559326">right?</span> <span m="3559779">Because the</span> <span m="3560232">longer</span> <span m="3561591">it takes,</span> </p>
<p><span m="3562050">PROFESSOR: I</span> <span m="3562320">was</span> <span m="3562590">being</span> <span m="3562690">a</span> <span m="3563098">little</span> <span m="3563506">bit glib</span> <span m="3563914">find if</span> <span m="3564322">it matches</span> <span m="3564730">or not this</span> <span m="3565090">linear</span> <span m="3565460">time.</span> <span m="3565720">Now</span> <span m="3565910">you're</span> <span m="3566060">saying,</span> <span m="3566290">hey,</span> <span m="3566400">wait</span> <span m="3566610">a</span> <span m="3566650">minute.</span> <span m="3566840">I</span> <span m="3566880">want</span> <span m="3567130">to know</span> <span m="3567200">where</span> <span m="3567470">it is</span> <span m="3567610">in</span> <span m="3567680">the</span> <span m="3567770">genome.</span> <span m="3568320">That's</span> <span m="3568800">a</span> <span m="3568850">big</span> <span m="3569100">bonus,</span> <span m="3569500">right?</span> <span m="3569760">And</span> <span m="3569920">so</span> <span m="3570090">you'd like</span> <span m="3570240">to</span> <span m="3570500">know</span> <span m="3570640">where</span> <span m="3570730">that</span> <span m="3570910">is?</span> <span m="3571500">Yes.</span> <span m="3572280">But</span> <span m="3572470">I</span> <span m="3572540">still</span> <span m="3572730">can</span> <span m="3572840">do</span> <span m="3572940">that</span> <span m="3573050">in</span> <span m="3573120">linear</span> <span m="3573420">time.</span> <span m="3574320">And</span> <span m="3574450">we'll</span> <span m="3574560">show</span> <span m="3574740">you</span> <span m="3574830">how</span> <span m="3574930">to</span> <span m="3575010">do</span> <span m="3575120">that</span> <span m="3575250">in</span> <span m="3575310">a</span> <span m="3575360">second.</span> <span m="3575780">This</span> <span m="3575880">is</span> <span m="3576010">not</span> <span m="3576150">linear</span> <span m="3576430">time.</span> </p>
<p><span m="3577970">This</span> <span m="3578510">actually</span> <span m="3578830">needs to</span> <span m="3579020">walk</span> <span m="3579300">back,</span> <span m="3579660">order the length</span> <span m="3580270">of</span> <span m="3580350">genome</span> <span m="3580670">for</span> <span m="3580790">every</span> <span m="3580990">single</span> <span m="3581250">query.</span> <span m="3581550">That's</span> <span m="3581760">not</span> <span m="3581930">good.</span> <span m="3583660">All</span> <span m="3583720">right?</span> <span m="3585630">Well,</span> </p>
<p><span m="3585850">What</span> <span m="3586010">we</span> <span m="3586120">could</span> <span m="3586360">do</span> <span m="3586730">is,</span> <span m="3586880">we</span> <span m="3587030">could</span> <span m="3587200">store</span> <span m="3588490">what's</span> <span m="3588650">called</span> <span m="3588840">a</span> <span m="3588890">suffix</span> <span m="3589320">array</span> <span m="3589670">with</span> <span m="3589860">each</span> <span m="3590090">row</span> <span m="3590480">and</span> <span m="3590620">say,</span> <span m="3591020">where</span> <span m="3591330">in</span> <span m="3591390">the</span> <span m="3591460">genome</span> <span m="3591970">that</span> <span m="3592160">position</span> <span m="3592710">is.</span> <span m="3594070">Where</span> <span m="3594530">that</span> <span m="3594990">row</span> <span m="3595230">starts.</span> <span m="3596780">And</span> <span m="3596890">then</span> <span m="3597000">maybe a</span> <span m="3597080">simple</span> <span m="3597410">look-up.</span> <span m="3598370">That</span> <span m="3598510">when you</span> <span m="3598610">actually</span> <span m="3598910">have</span> <span m="3599020">a</span> <span m="3599070">hit</span> <span m="3599410">in</span> <span m="3599550">row</span> <span m="3599810">one,</span> <span m="3600500">ah,</span> <span m="3600820">OK,</span> <span m="3601070">start</span> <span m="3601250">your</span> <span m="3601340">position</span> <span m="3601710">two</span> <span m="3601930">of the</span> <span m="3602020">genome.</span> </p>
<p><span m="3604940">But</span> <span m="3605470">then</span> <span m="3605910">the</span> <span m="3606500">problem</span> <span m="3606860">with</span> <span m="3607020">that</span> <span m="3607580">is</span> <span m="3607810">that</span> <span m="3610760">it</span> <span m="3611200">actually</span> <span m="3611480">takes</span> <span m="3611620">a</span> <span m="3611660">lot</span> <span m="3611790">of</span> <span m="3611840">space.</span> <span m="3613170">And</span> <span m="3613340">we want to</span> <span m="3613460">have</span> <span m="3613540">compact</span> <span m="3613970">indices.</span> <span m="3615900">So</span> <span m="3616650">the</span> <span m="3616780">trick</span> <span m="3617180">is</span> <span m="3617360">what</span> <span m="3617510">we</span> <span m="3617630">do</span> <span m="3617810">is,</span> <span m="3617910">instead</span> <span m="3618190">of</span> <span m="3618250">storing</span> <span m="3618800">that</span> <span m="3619060">entire</span> <span m="3619520">suffix</span> <span m="3619910">array,</span> <span m="3620810">we</span> <span m="3620920">store</span> <span m="3621280">every</span> <span m="3621640">so</span> <span m="3621860">many</span> <span m="3622620">rows,</span> <span m="3622880">like</span> <span m="3623030">every</span> <span m="3623240">25</span> <span m="3623750">rows.</span> <span m="3624630">And</span> <span m="3624780">all</span> <span m="3624920">we</span> <span m="3625030">do</span> <span m="3625160">is,</span> <span m="3625250">we</span> <span m="3625370">walk</span> <span m="3625730">left</span> <span m="3626070">until</span> <span m="3626280">we</span> <span m="3626370">hit</span> <span m="3626570">a</span> <span m="3626660">row</span> <span m="3626860">that</span> <span m="3627020">actually</span> <span m="3627330">has</span> <span m="3627980">the</span> <span m="3628450">value,</span> <span m="3629250">and</span> <span m="3629450">then</span> <span m="3629640">we</span> <span m="3630040">add</span> <span m="3630300">how</span> <span m="3630500">many</span> <span m="3630670">times</span> <span m="3630870">we</span> <span m="3630950">walked</span> <span m="3631240">left,</span> <span m="3631800">plus</span> <span m="3632040">the</span> <span m="3632130">value</span> <span m="3632860">and</span> <span m="3632960">we</span> <span m="3633050">know</span> <span m="3633170">where</span> <span m="3633290">we</span> <span m="3633450">are</span> <span m="3633720">in</span> <span m="3633840">the</span> <span m="3633910">genome.</span> </p>
<p><span m="3636380">So</span> <span m="3636880">we</span> <span m="3637090">can</span> <span m="3637320">sample</span> <span m="3638240">the</span> <span m="3638360">suffix</span> <span m="3638790">array,</span> <span m="3640120">and</span> <span m="3640420">by</span> <span m="3640550">sampling</span> <span m="3640990">the</span> <span m="3641060">suffix</span> <span m="3641470">array,</span> <span m="3641780">we</span> <span m="3642140">cut</span> <span m="3642360">down</span> <span m="3642640">our</span> <span m="3642750">storage</span> <span m="3644460">hugely</span> <span m="3645740">and</span> <span m="3646160">it's</span> <span m="3646310">still</span> <span m="3646540">pretty</span> <span m="3646760">efficient.</span> <span m="3647180">Because</span> <span m="3647410">what</span> <span m="3647550">we</span> <span m="3647670">can</span> <span m="3647800">do</span> <span m="3647920">is,</span> <span m="3648000">we</span> <span m="3648090">just</span> <span m="3648230">walk</span> <span m="3648590">left</span> <span m="3649360">until</span> <span m="3649580">we</span> <span m="3649680">hit</span> <span m="3650490">a</span> <span m="3650580">sample</span> <span m="3650990">suffix</span> <span m="3651320">array</span> <span m="3651390">location</span> <span m="3651775">and then</span> <span m="3652160">add</span> <span m="3652300">the</span> <span m="3652370">two</span> <span m="3652480">numbers</span> <span m="3652750">together.</span> <span m="3655490">All</span> <span m="3655560">right?</span> </p>
<p><span m="3658880">So</span> <span m="3659990">that's</span> <span m="3660220">how</span> <span m="3660410">it's</span> <span m="3660560">done.</span> <span m="3661250">OK?</span> <span m="3663500">So</span> <span m="3663640">that's</span> <span m="3663880">how</span> <span m="3664080">we</span> <span m="3664230">actually</span> <span m="3664490">do</span> <span m="3665350">the</span> <span m="3668100">alignment</span> <span m="3668750">and</span> <span m="3668990">figure out</span> <span m="3669110">where</span> <span m="3669280">things</span> <span m="3669510">are.</span> <span m="3670320">The</span> <span m="3670420">one</span> <span m="3670630">thing</span> <span m="3670830">I</span> <span m="3670890">haven't</span> <span m="3671210">told</span> <span m="3671500">you</span> <span m="3671650">about</span> <span m="3672440">is</span> <span m="3672610">how</span> <span m="3672780">to</span> <span m="3672880">compute</span> <span m="3673650">count</span> <span m="3673930">efficiently.</span> <span m="3676170">Now remember</span> <span m="3676520">what count</span> <span m="3676960">does.</span> <span m="3678160">Count</span> <span m="3679210">is</span> <span m="3679360">a</span> <span m="3679430">function--</span> <span m="3681520">but</span> <span m="3681830">this</span> <span m="3681980">is</span> <span m="3682140">putting</span> <span m="3682350">it</span> <span m="3682450">all</span> <span m="3682500">together</span> <span m="3682910">where</span> <span m="3684140">we're</span> <span m="3684350">matching</span> <span m="3684720">this</span> <span m="3684870">query,</span> <span m="3685610">we</span> <span m="3685750">do</span> <span m="3685890">the</span> <span m="3686000">steps.</span> <span m="3686980">We</span> <span m="3687410">get</span> <span m="3687620">the</span> <span m="3687680">match.</span> <span m="3688400">Then</span> <span m="3688550">we</span> <span m="3689230">do</span> <span m="3689390">walk</span> <span m="3689690">left</span> <span m="3689930">once</span> <span m="3690650">and</span> <span m="3690800">then</span> <span m="3690890">we</span> <span m="3691200">look</span> <span m="3691390">at</span> <span m="3691510">the</span> <span m="3691570">suffix</span> <span m="3691930">to</span> <span m="3692170">figure out</span> <span m="3692380">where</span> <span m="3692540">we</span> <span m="3692670">are,</span> <span m="3692840">right?</span> </p>
<p><span m="3696360">The</span> <span m="3696500">business</span> <span m="3696870">about</span> <span m="3697230">count</span> <span m="3698320">is</span> <span m="3698530">that</span> <span m="3699160">what</span> <span m="3699460">we</span> <span m="3699590">need</span> <span m="3699800">to</span> <span m="3699880">do</span> <span m="3700880">is</span> <span m="3701010">to</span> <span m="3701110">figure</span> <span m="3701430">out</span> <span m="3701610">the</span> <span m="3701780">rank</span> <span m="3702230">of</span> <span m="3702360">a</span> <span m="3702430">particular</span> <span m="3703960">base</span> <span m="3704930">in</span> <span m="3705190">a</span> <span m="3705370">position</span> <span m="3706000">in</span> <span m="3706150">the</span> <span m="3706340">transform.</span> <span m="3707780">And</span> <span m="3707930">one</span> <span m="3708080">way</span> <span m="3708190">to do</span> <span m="3708380">that</span> <span m="3708550">is</span> <span m="3708660">to</span> <span m="3708750">go</span> <span m="3708920">backwards</span> <span m="3709370">to</span> <span m="3709440">the</span> <span m="3709510">whole</span> <span m="3709650">transform,</span> <span m="3710090">counting</span> <span m="3710500">how</span> <span m="3710680">many</span> <span m="3710910">g;s</span> <span m="3711240">occur</span> <span m="3711530">before</span> <span m="3711830">this</span> <span m="3712010">one,</span> <span m="3713100">and</span> <span m="3713240">that's</span> <span m="3713440">very</span> <span m="3713760">expensive,</span> <span m="3715990">to</span> <span m="3716090">compute</span> <span m="3716400">the</span> <span m="3716510">rank</span> <span m="3716730">of</span> <span m="3716800">this</span> <span m="3716950">particular</span> <span m="3717390">g.</span> <span m="3717600">Remember</span> <span m="3717820">the</span> <span m="3717980">rank</span> <span m="3718260">is</span> <span m="3718360">simply</span> <span m="3718720">the</span> <span m="3718840">number</span> <span m="3719170">of</span> <span m="3719250">g's that</span> <span m="3719660">occur</span> <span m="3719940">before</span> <span m="3720340">this</span> <span m="3720560">one</span> <span m="3720960">in</span> <span m="3721290">the</span> <span m="3721680">BWT.</span> <span m="3723110">Very</span> <span m="3723320">simple</span> <span m="3723630">metric.</span> </p>
<p><span m="3725300">So</span> <span m="3725460">instead</span> <span m="3725780">of</span> <span m="3725870">doing</span> <span m="3726180">that,</span> <span m="3726930">what</span> <span m="3727130">we</span> <span m="3727250">can</span> <span m="3727430">do</span> <span m="3727710">is,</span> <span m="3727950">we</span> <span m="3728120">can</span> <span m="3729340">build</span> <span m="3730110">a</span> <span m="3730340">data</span> <span m="3730600">structure</span> <span m="3731600">that</span> <span m="3731830">every</span> <span m="3732160">once</span> <span m="3732500">in</span> <span m="3732570">awhile,</span> <span m="3733330">counts</span> <span m="3733670">how</span> <span m="3733850">many</span> <span m="3734100">a's,</span> <span m="3734400">c's,</span> <span m="3734750">g's,</span> <span m="3735000">and</span> <span m="3735080">t's</span> <span m="3735250">have</span> <span m="3735340">occurred</span> <span m="3735630">before</span> <span m="3735990">now</span> <span m="3736260">in</span> <span m="3736320">the</span> <span m="3736400">BWT.</span> <span m="3739000">And</span> <span m="3739190">so</span> <span m="3739260">we're</span> <span m="3739390">going</span> <span m="3739540">to</span> <span m="3739620">sample</span> <span m="3740130">this</span> <span m="3740435">with</span> <span m="3740740">these</span> <span m="3740970">checkpoints,</span> <span m="3742400">and</span> <span m="3742650">then</span> <span m="3742800">when</span> <span m="3742900">you</span> <span m="3742990">want</span> <span m="3743140">to</span> <span m="3743200">compute</span> <span m="3744350">count</span> <span m="3744820">at</span> <span m="3744940">any</span> <span m="3745180">point,</span> <span m="3746040">you</span> <span m="3746120">can</span> <span m="3746250">go</span> <span m="3746380">to</span> <span m="3746490">the</span> <span m="3746580">nearest</span> <span m="3746960">checkpoint,</span> <span m="3747400">wherever</span> <span m="3747640">that</span> <span m="3747810">is,</span> <span m="3749240">and</span> <span m="3749980">make</span> <span m="3750250">an</span> <span m="3750310">adjustment</span> <span m="3750810">by</span> <span m="3750900">counting</span> <span m="3751340">the</span> <span m="3751410">number</span> <span m="3751640">of</span> <span m="3751710">characters</span> <span m="3752240">between</span> <span m="3752680">you</span> <span m="3752920">and</span> <span m="3753010">that</span> <span m="3753170">checkpoint.</span> <span m="3755240">Very</span> <span m="3755510">straightforward.</span> <span m="3756810">All</span> <span m="3756870">Right</span> </p>
<p><span m="3758380">So</span> <span m="3758540">this,</span> <span m="3759390">coming</span> <span m="3759580">back</span> <span m="3759760">to</span> <span m="3759860">question,</span> <span m="3760955">it's</span> <span m="3761430">Time,</span> <span m="3761590">right?</span> <span m="3763840">--asked</span> <span m="3764640">you</span> <span m="3764760">need</span> <span m="3764990">to</span> <span m="3765050">build</span> <span m="3765490">this</span> <span m="3765920">checkpointing</span> <span m="3766470">mechanism</span> <span m="3766980">at</span> <span m="3767070">the</span> <span m="3767160">same</span> <span m="3767410">time</span> <span m="3767620">you</span> <span m="3767710">build</span> <span m="3767940">the</span> <span m="3768030">index,</span> <span m="3768900">as</span> <span m="3769070">well</span> <span m="3769420">as</span> <span m="3769510">the</span> <span m="3769610">sampling</span> <span m="3770030">of the</span> <span m="3770170">suffix</span> <span m="3770580">array.</span> <span m="3771880">So</span> <span m="3772080">a</span> <span m="3772120">full</span> <span m="3772470">index</span> <span m="3772880">consists</span> <span m="3773700">of</span> <span m="3774250">the</span> <span m="3774470">transform</span> <span m="3774960">itself,</span> <span m="3776010">which</span> <span m="3776150">is</span> <span m="3776330">the</span> <span m="3776430">genome</span> <span m="3776900">transformed</span> <span m="3777570">into</span> <span m="3778250">its</span> <span m="3778430">BWT.</span> <span m="3781250">And</span> <span m="3781410">they</span> <span m="3781560">literally</span> <span m="3782050">take</span> <span m="3782240">the</span> <span m="3782370">entire</span> <span m="3782670">genome</span> <span m="3783020">and</span> <span m="3783110">do</span> <span m="3783260">this.</span> </p>
<p><span m="3784620">Typically</span> <span m="3784970">they'll put</span> <span m="3785110">dollar</span> <span m="3785500">signs</span> <span m="3785900">between</span> <span m="3786380">the</span> <span m="3786480">chromosomes.</span> <span m="3788910">So they'll</span> <span m="3789080">transform</span> <span m="3789520">the</span> <span m="3789590">whole</span> <span m="3789810">thing.</span> <span m="3790620">It</span> <span m="3790880">takes</span> <span m="3791600">a</span> <span m="3791680">sampling</span> <span m="3792150">of</span> <span m="3792220">the</span> <span m="3792280">suffix</span> <span m="3792660">array</span> <span m="3792850">we</span> <span m="3792980">just</span> <span m="3793220">saw</span> <span m="3794230">and</span> <span m="3794360">it</span> <span m="3794510">takes</span> <span m="3795360">the</span> <span m="3795500">checkpointing</span> <span m="3796920">of</span> <span m="3798330">the LF</span> <span m="3798550">function</span> <span m="3799310">to</span> <span m="3799380">make</span> <span m="3799570">a</span> <span m="3799640">constant</span> <span m="3800080">time.</span> <span m="3801650">And</span> <span m="3801810">that's</span> <span m="3802070">what</span> <span m="3802300">is</span> <span m="3802780">inside</span> <span m="3803470">of</span> <span m="3804250">an</span> <span m="3804380">FM</span> <span m="3804770">index.</span> <span m="3806090">OK?</span> </p>
<p><span m="3808550">Now</span> <span m="3810840">it's</span> <span m="3811090">small,</span> <span m="3811600">which</span> <span m="3811720">is</span> <span m="3811810">one of</span> <span m="3811960">the</span> <span m="3812020">nice</span> <span m="3812220">things,</span> <span m="3812450">compared</span> <span m="3813290">to</span> <span m="3814170">things</span> <span m="3814450">like</span> <span m="3814770">suffix</span> <span m="3815190">tree,</span> <span m="3815560">suffix</span> <span m="3815970">arrays,</span> <span m="3816440">or</span> <span m="3816560">even</span> <span m="3817140">other</span> <span m="3817350">kinds</span> <span m="3817830">of</span> <span m="3818690">hash</span> <span m="3819000">structures</span> <span m="3819610">for</span> <span m="3819850">looking</span> <span m="3820150">for</span> <span m="3820270">seeds,</span> <span m="3821080">it</span> <span m="3821290">really</span> <span m="3821590">is</span> <span m="3822340">not</span> <span m="3822500">even</span> <span m="3822700">twice</span> <span m="3823040">the</span> <span m="3823130">size</span> <span m="3823450">of</span> <span m="3823510">the</span> <span m="3823600">genome.</span> <span m="3824810">So</span> <span m="3824900">it's</span> <span m="3825000">a</span> <span m="3825040">very</span> <span m="3825580">compact</span> <span m="3826050">index</span> <span m="3826750">that</span> <span m="3826950">is</span> <span m="3827090">very,</span> <span m="3827560">very</span> <span m="3827740">efficient.</span> <span m="3829770">And</span> <span m="3829960">so</span> <span m="3830080">it's</span> <span m="3830170">a</span> <span m="3830240">wonderful</span> <span m="3830650">data</span> <span m="3830850">structure</span> <span m="3831250">for</span> <span m="3831350">doing</span> <span m="3831520">what</span> <span m="3831640">we're</span> <span m="3831730">doing,</span> <span m="3832230">except</span> <span m="3833100">we</span> <span m="3833220">have</span> <span m="3833370">not</span> <span m="3833530">dealt</span> <span m="3833730">with</span> <span m="3834020">mismatches</span> <span m="3834385">yet,</span> <span m="3835010">right?</span> </p>
<p><span m="3836850">And</span> <span m="3837110">so</span> <span m="3838120">once</span> <span m="3838390">again,</span> <span m="3838550">I</span> <span m="3838570">want</span> <span m="3838700">to</span> <span m="3838740">put</span> <span m="3838870">a</span> <span m="3838930">plug in</span> <span m="3839500">for</span> <span m="3839800">BWA</span> <span m="3840500">which</span> <span m="3840690">is</span> <span m="3840800">really</span> <span m="3841010">a</span> <span m="3841090">marvelous</span> <span m="3841580">aligner.</span> <span m="3842250">And</span> <span m="3842860">we'll</span> <span m="3842970">talk</span> <span m="3843190">about</span> <span m="3843400">tomorrow</span> <span m="3843770">in</span> <span m="3843870">recitation</span> <span m="3845360">if</span> <span m="3845520">you</span> <span m="3845620">want</span> <span m="3845790">to</span> <span m="3845840">know</span> <span m="3846220">all</span> <span m="3846600">of</span> <span m="3846740">the</span> <span m="3846840">details</span> <span m="3847400">of</span> <span m="3847500">what</span> <span m="3847820">it</span> <span m="3847920">actually</span> <span m="3848140">takes</span> <span m="3848330">to</span> <span m="3848400">make</span> <span m="3848540">this</span> <span m="3848650">work</span> <span m="3848840">in</span> <span m="3848930">practice.</span> <span m="3851350">Now,</span> <span m="3853140">it</span> <span m="3853190">finds</span> <span m="3855050">exactness</span> <span m="3855620">matches</span> <span m="3856230">quickly,</span> <span m="3857160">but it</span> <span m="3857300">doesn't</span> <span m="3857560">really</span> <span m="3857750">have</span> <span m="3858000">any</span> <span m="3858660">allowances</span> <span m="3859860">for</span> <span m="3860000">mismatches.</span> <span m="3861300">And</span> <span m="3862270">the</span> <span m="3862390">way</span> <span m="3862660">that</span> <span m="3863010">bow</span> <span m="3863300">tie</span> <span m="3863570">and</span> <span m="3863760">other</span> <span m="3864000">aligners</span> <span m="3864600">deal</span> <span m="3864800">with</span> <span m="3864940">this,</span> <span m="3865260">and</span> <span m="3865410">they're</span> <span m="3865560">all</span> <span m="3865770">pretty</span> <span m="3865950">consistent,</span> <span m="3866910">is</span> <span m="3867170">in</span> <span m="3867290">the</span> <span m="3867370">following</span> <span m="3867830">way,</span> <span m="3868630">which</span> <span m="3868780">is</span> <span m="3868940">that</span> <span m="3869580">they</span> <span m="3869680">do</span> <span m="3869820">backtracking.</span> </p>
<p><span m="3871130">Here's</span> <span m="3871350">the</span> <span m="3871480">idea.</span> <span m="3873210">You</span> <span m="3873380">try</span> <span m="3873790">and</span> <span m="3874660">match</span> <span m="3875290">something</span> <span m="3876810">or</span> <span m="3876920">match</span> <span m="3877410">a</span> <span m="3877550">read</span> <span m="3879440">and</span> <span m="3879740">you</span> <span m="3880420">get</span> <span m="3880580">to</span> <span m="3880630">a</span> <span m="3880690">particular</span> <span m="3881090">point</span> <span m="3881360">in</span> <span m="3881450">the</span> <span m="3881550">read,</span> <span m="3882280">and</span> <span m="3882380">you</span> <span m="3882490">can't</span> <span m="3882770">go</span> <span m="3882930">any</span> <span m="3883060">further.</span> <span m="3883480">Top</span> <span m="3883720">is</span> <span m="3883830">equal</span> <span m="3884020">to</span> <span m="3884070">bottom.</span> <span m="3886770">So</span> <span m="3886890">you</span> <span m="3887010">know</span> <span m="3887290">that</span> <span m="3887660">there's</span> <span m="3887890">no</span> <span m="3888140">suffix</span> <span m="3888750">in</span> <span m="3889070">the</span> <span m="3889140">genome</span> <span m="3889810">that</span> <span m="3889990">matches</span> <span m="3890300">your</span> <span m="3890420">query.</span> <span m="3892370">So</span> <span m="3892580">what</span> <span m="3892760">do you</span> <span m="3892920">do?</span> </p>
<p><span m="3894830">Well,</span> <span m="3895440">what</span> <span m="3895670">you</span> <span m="3895770">can</span> <span m="3895920">do</span> <span m="3896190">is</span> <span m="3896320">you</span> <span m="3896420">can</span> <span m="3896530">try</span> <span m="3896750">all</span> <span m="3897160">of</span> <span m="3897280">the</span> <span m="3897390">different</span> <span m="3897750">bases</span> <span m="3898130">at</span> <span m="3898210">that</span> <span m="3898400">position</span> <span m="3899350">besides</span> <span m="3899720">the</span> <span m="3899830">one</span> <span m="3899990">you</span> <span m="3900110">tried</span> <span m="3900980">to</span> <span m="3901070">see</span> <span m="3901210">whether</span> <span m="3901450">it</span> <span m="3901580">matches</span> <span m="3901900">or</span> <span m="3901960">not.</span> <span m="3902110">I</span> <span m="3902210">can see</span> <span m="3902625">the</span> <span m="3903040">horror</span> <span m="3903590">coming</span> <span m="3903880">over</span> <span m="3904110">people.</span> <span m="3904450">Oh,</span> <span m="3904680">no,</span> <span m="3905020">not</span> <span m="3905280">backtracking,</span> <span m="3905810">not</span> <span m="3906060">that.</span> <span m="3906940">But</span> <span m="3910130">sometimes</span> <span m="3910670">it</span> <span m="3910750">actually</span> <span m="3911060">works.</span> </p>
<p><span m="3912640">And</span> <span m="3913560">just</span> <span m="3913680">to</span> <span m="3913750">give</span> <span m="3913930">you</span> <span m="3914040">order</span> <span m="3914320">of</span> <span m="3914420">magnitude</span> <span m="3914920">idea</span> <span m="3915220">about</span> <span m="3915410">how</span> <span m="3915580">this</span> <span m="3915760">works</span> <span m="3916030">in</span> <span m="3916140">practice,</span> <span m="3917150">when</span> <span m="3917390">reads</span> <span m="3917750">don't</span> <span m="3917940">match,</span> <span m="3918370">they</span> <span m="3918490">limit</span> <span m="3918780">backtracking</span> <span m="3919330">to</span> <span m="3919380">about</span> <span m="3919510">125</span> <span m="3920350">times</span> <span m="3920700">in</span> <span m="3920770">these</span> <span m="3920900">aligners.</span> <span m="3922390">so</span> <span m="3922500">they</span> <span m="3922630">try</span> <span m="3922940">pretty</span> <span m="3923230">hard</span> <span m="3923620">to</span> <span m="3923710">actually</span> <span m="3924090">match</span> <span m="3924420">things.</span> <span m="3925070">And</span> <span m="3925480">yes,</span> <span m="3927000">it</span> <span m="3927160">is</span> <span m="3927410">true</span> <span m="3927840">that</span> <span m="3928000">even</span> <span m="3928350">with</span> <span m="3928480">this</span> <span m="3928620">backtracking,</span> <span m="3929260">it's</span> <span m="3929440">still</span> <span m="3929800">a</span> <span m="3929890">great</span> <span m="3930230">approach.</span> <span m="3932450">And</span> <span m="3932850">sometimes</span> <span m="3933390">the</span> <span m="3933480">first</span> <span m="3933820">thing</span> <span m="3933950">you</span> <span m="3934050">try</span> <span m="3934300">doesn't</span> <span m="3934640">work,</span> <span m="3935700">and</span> <span m="3935880">you</span> <span m="3935960">have</span> <span m="3936190">to</span> <span m="3936290">backtrack,</span> <span m="3937120">trying</span> <span m="3937880">multiple</span> <span m="3938380">bases</span> <span m="3938840">at</span> <span m="3938920">that</span> <span m="3939110">location</span> <span m="3939800">until</span> <span m="3939870">you</span> <span m="3940030">get</span> <span m="3940200">one</span> <span m="3940350">that</span> <span m="3940440">matches.</span> <span m="3941560">And</span> <span m="3941710">then</span> <span m="3941810">you</span> <span m="3941920">can</span> <span m="3942030">proceed.</span> <span m="3943210">OK</span> <span m="3944390">And</span> <span m="3944870">you</span> <span m="3945200">eventually</span> <span m="3945690">wind</span> <span m="3945920">up</span> <span m="3946010">at</span> <span m="3946070">the</span> <span m="3946190">alignment</span> <span m="3946670">you</span> <span m="3946990">see</span> <span m="3947100">in</span> <span m="3947170">the</span> <span m="3947250">lower</span> <span m="3947480">right</span> <span m="3947660">hand</span> <span m="3947830">corner,</span> <span m="3948590">where</span> <span m="3948830">you're</span> <span m="3949030">substituting</span> <span m="3949810">a</span> <span m="3951030">g</span> <span m="3951320">for</span> <span m="3951500">an</span> <span m="3951890">a,</span> <span m="3952670">an</span> <span m="3953060">a</span> <span m="3953180">for a</span> <span m="3953615">g,</span> <span m="3954050">excuse me,</span> <span m="3954170">to make</span> <span m="3954350">it</span> <span m="3954810">go</span> <span m="3954960">forward.</span> </p>
<p><span m="3956870">Do</span> <span m="3956960">people</span> <span m="3957230">understand</span> <span m="3957720">the</span> <span m="3957880">essential</span> <span m="3958220">idea</span> <span m="3959120">of</span> <span m="3960680">this</span> <span m="3960830">idea</span> <span m="3961272">of</span> <span m="3961714">backtracking?</span> <span m="3964370">Does</span> <span m="3967190">anybody</span> <span m="3967580">have</span> <span m="3967770">any</span> <span m="3967910">comments</span> <span m="3968430">or</span> <span m="3968570">questions</span> <span m="3968970">about</span> <span m="3969190">it?</span> <span m="3969540">Like</span> <span m="3969790">ew,</span> <span m="3970330">or</span> <span m="3972190">ideas?</span> <span m="3972620">Yes.</span> </p>
<p><span m="3972990">AUDIENCE: What</span> <span m="3973360">about gaps?</span> </p>
<p><span m="3974340">PROFESSOR: What about</span> <span m="3974580">gaps?</span> <span m="3979340">BWA,</span> <span m="3980160">I</span> <span m="3980200">believe,</span> <span m="3980680">processes</span> <span m="3981290">gaps.</span> <span m="3982680">But</span> <span m="3983370">gaps</span> <span m="3983710">are</span> <span m="3983780">much,</span> <span m="3984100">much</span> <span m="3984340">less</span> <span m="3984550">likely</span> <span m="3985020">than</span> <span m="3985980">missed</span> <span m="3986300">bases.</span> <span m="3987720">The</span> <span m="3987760">other</span> <span m="3987920">thing</span> <span m="3988270">is</span> <span m="3988570">that</span> <span m="3989340">if</span> <span m="3989490">you're</span> <span m="3989610">doing</span> <span m="3990705">a</span> <span m="3991140">sequencing</span> <span m="3991740">library,</span> <span m="3993340">and</span> <span m="3993530">you</span> <span m="3993630">have</span> <span m="3994060">a</span> <span m="3994250">read that</span> <span m="3994590">actually</span> <span m="3994810">has</span> <span m="3994940">a</span> <span m="3994990">gap</span> <span m="3995290">in</span> <span m="3995410">it,</span> <span m="3995850">it's</span> <span m="3996020">probably</span> <span m="3996600">the</span> <span m="3996720">case</span> <span m="3997620">you have</span> <span m="3997680">another</span> <span m="3997980">read</span> <span m="3998210">that</span> <span m="3998350">doesn't.</span> <span m="3999460">For</span> <span m="3999570">the</span> <span m="3999680">same</span> <span m="3999980">sequence.</span> <span m="4001460">So</span> <span m="4002450">it</span> <span m="4002670">is</span> <span m="4003420">less</span> <span m="4003730">important</span> <span m="4004180">to</span> <span m="4004260">process</span> <span m="4004710">gaps</span> <span m="4005100">than it is to</span> <span m="4005430">process</span> <span m="4007590">differences.</span> </p>
<p><span m="4008590">The</span> <span m="4008710">reason</span> <span m="4009100">is</span> <span m="4009440">that</span> <span m="4009890">differences</span> <span m="4012400">mean</span> <span m="4012920">that</span> <span m="4013770">it</span> <span m="4013940">might</span> <span m="4014180">be</span> <span m="4014420">a</span> <span m="4014510">difference</span> <span m="4014810">of</span> <span m="4014940">an</span> <span m="4015050">allele.</span> <span m="4016070">In</span> <span m="4016270">other words,</span> <span m="4016520">it</span> <span m="4016620">might</span> <span m="4016750">be</span> <span m="4017000">that</span> <span m="4017190">your</span> <span m="4018070">base</span> <span m="4018320">is</span> <span m="4018480">different</span> <span m="4018820">than</span> <span m="4018930">the</span> <span m="4019010">reference</span> <span m="4019370">genome.</span> <span m="4020860">Indels</span> <span m="4021390">are</span> <span m="4021500">also</span> <span m="4021800">possible.</span> <span m="4023730">And</span> <span m="4023950">there</span> <span m="4024070">are</span> <span m="4024190">different</span> <span m="4024510">strategies</span> <span m="4024900">of</span> <span m="4024980">dealing</span> <span m="4025210">with</span> <span m="4025350">those.</span> <span m="4025580">That</span> <span m="4025700">would be</span> <span m="4025820">a</span> <span m="4025850">great</span> <span m="4026140">question</span> <span m="4026490">for</span> <span m="4026630">Hang</span> <span m="4026920">tomorrow</span> <span m="4028630">about</span> <span m="4028950">gaps.</span> <span m="4029370">Because</span> <span m="4029630">he</span> <span m="4029730">can</span> <span m="4029870">tell</span> <span m="4030040">you</span> <span m="4030270">in</span> <span m="4030390">practice</span> <span m="4030800">what</span> <span m="4030940">they</span> <span m="4031020">do.</span> <span m="4031230">And</span> <span m="4031330">we'll</span> <span m="4031440">get</span> <span m="4031600">into</span> <span m="4031780">a</span> <span m="4031830">little</span> <span m="4032060">bit</span> <span m="4032180">of</span> <span m="4032280">that</span> <span m="4032660">at</span> <span m="4032800">the</span> <span m="4032890">end</span> <span m="4032980">of</span> <span m="4033060">today's</span> <span m="4033330">lecture.</span> <span m="4033790">Yes.</span> <span m="4034180">Question?</span> </p>
<p><span m="4035534">AUDIENCE: I'm</span> <span m="4035946">Levy.</span> </p>
<p><span m="4036358">PROFESSOR: Hi,</span> <span m="4036770">Levy.</span> </p>
<p><span m="4037090">AUDIENCE: How do you make</span> <span m="4037450">sure when you're</span> <span m="4037810">backtracking</span> <span m="4038170">that you end up with</span> <span m="4038495">the</span> <span m="4038820">best possible</span> <span m="4039030">match?</span> <span m="4039340">Do you just</span> <span m="4039685">go down the</span> <span m="4040030">first--</span> </p>
<p><span m="4042690">PROFESSOR: The questions</span> <span m="4042830">is</span> <span m="4043280">how do you</span> <span m="4043620">guarantee</span> <span m="4044050">you</span> <span m="4044170">wind</span> <span m="4044300">up with</span> <span m="4044440">the</span> <span m="4044520">best</span> <span m="4044740">possible</span> <span m="4045110">match?</span> <span m="4046690">The</span> <span m="4046770">short</span> <span m="4046980">answer</span> <span m="4047290">is</span> <span m="4047400">that</span> <span m="4047470">you</span> <span m="4047550">don't.</span> <span m="4049380">There's</span> <span m="4049530">a</span> <span m="4049600">longer</span> <span m="4049970">answer,</span> <span m="4050230">which</span> <span m="4050350">we're</span> <span m="4050490">about</span> <span m="4050700">to</span> <span m="4050770">get</span> <span m="4051010">to,</span> <span m="4051470">about</span> <span m="4051720">how</span> <span m="4052040">we</span> <span m="4052200">try</span> <span m="4052710">to</span> <span m="4052810">approximate</span> <span m="4053460">that.</span> <span m="4054200">And</span> <span m="4054520">what</span> <span m="4055780">judgment</span> <span m="4056310">you</span> <span m="4056450">would</span> <span m="4056580">use</span> <span m="4056990">to</span> <span m="4057090">get</span> <span m="4057400">to</span> <span m="4057630">what</span> <span m="4057800">we</span> <span m="4057980">would</span> <span m="4058130">think</span> <span m="4058280">is</span> <span m="4058410">a</span> <span m="4058540">practically</span> <span m="4059330">good</span> <span m="4059610">match.</span> <span m="4060220">OK?</span> <span m="4061100">But</span> <span m="4061370">in</span> <span m="4061490">terms</span> <span m="4061720">of</span> <span m="4061840">theoretically</span> <span m="4062550">optimal,</span> <span m="4062870">the</span> <span m="4063190">answer</span> <span m="4063480">is,</span> <span m="4063620">it</span> <span m="4063730">doesn't</span> <span m="4064020">attempt</span> <span m="4064380">to</span> <span m="4064460">do</span> <span m="4064620">that.</span> <span m="4065716">That's a</span> <span m="4066090">good</span> <span m="4066270">question.</span> <span m="4066590">Yes.</span> </p>
<p><span m="4068000">AUDIENCE: In practice,</span> <span m="4068475">does</span> <span m="4068950">this</span> <span m="4069425">backtracking</span> <span m="4069900">method</span> <span m="4070375">at the</span> <span m="4070850">same time</span> <span m="4071325">as</span> <span m="4071800">you're</span> <span m="4072275">computing</span> <span m="4072750">the</span> <span m="4073700">matches</span> <span m="4074175">or--</span> </p>
<p><span m="4074660">PROFESSOR: Yes.</span> <span m="4075590">So</span> <span m="4075870">what's</span> <span m="4076216">happening is,</span> <span m="4076562">you remember</span> <span m="4076910">that loop</span> <span m="4076970">where we're</span> <span m="4077110">going</span> <span m="4077360">around,</span> <span m="4078120">where</span> <span m="4078310">we</span> <span m="4079480">were</span> <span m="4079600">moving</span> <span m="4079850">the</span> <span m="4079950">top</span> <span m="4080180">and</span> <span m="4080280">bottom</span> <span m="4080560">pointers.</span> <span m="4080990">If</span> <span m="4081090">you</span> <span m="4081160">get</span> <span m="4081320">to</span> <span m="4081400">a</span> <span m="4081460">point</span> <span m="4081700">where</span> <span m="4081790">they</span> <span m="4081900">come</span> <span m="4082110">together,</span> <span m="4083130">then</span> <span m="4083420">you</span> <span m="4083580">would</span> <span m="4084350">at</span> <span m="4084450">that</span> <span m="4084710">point,</span> <span m="4085660">begin</span> <span m="4086660">backtracking</span> <span m="4087300">and</span> <span m="4087380">try</span> <span m="4087540">different</span> <span m="4087830">bases.</span> <span m="4089280">And</span> <span m="4089440">if</span> <span m="4089530">you</span> <span m="4089650">look,</span> <span m="4089840">I</span> <span m="4089920">posted</span> <span m="4090410">the BWA</span> <span m="4090490">paper</span> <span m="4091380">on</span> <span m="4091520">the</span> <span m="4091590">Stellar</span> <span m="4091870">website.</span> <span m="4092400">And</span> <span m="4092490">if</span> <span m="4092570">you</span> <span m="4092690">look</span> <span m="4092860">in</span> <span m="4092950">one</span> <span m="4093080">of</span> <span m="4093120">the</span> <span m="4093210">figures,</span> <span m="4093690">the</span> <span m="4093850">algorithm</span> <span m="4094360">is</span> <span m="4094500">there,</span> <span m="4094890">And</span> <span m="4095240">you'll</span> <span m="4095460">actually</span> <span m="4095940">see,</span> <span m="4097020">if</span> <span m="4097170">you</span> <span m="4097279">can</span> <span m="4097500">deconvolute</span> <span m="4097990">what's</span> <span m="4098290">going</span> <span m="4098500">on,</span> <span m="4099210">that</span> <span m="4099850">inside</span> <span m="4100270">the</span> <span m="4100359">loop,</span> <span m="4100580">it's</span> <span m="4100689">actually</span> <span m="4100950">doing</span> <span m="4101210">exactly</span> <span m="4101600">that.</span> <span m="4103770">Yes.</span> <span m="4103979">Question.</span> </p>
<p><span m="4104689">AUDIENCE: In practice,</span> <span m="4105171">is the</span> <span m="4105653">number of</span> <span m="4106135">errors</span> <span m="4106617">is</span> <span m="4107099">small,</span> <span m="4107581">would</span> <span m="4108063">it make</span> <span m="4108545">sense</span> <span m="4109027">just to use</span> <span m="4109509">[INAUDIBLE]?</span> </p>
<p><span m="4113847">PROFESSOR: We're</span> <span m="4114330">going to get</span> <span m="4114510">to</span> <span m="4114580">that.</span> <span m="4114840">I</span> <span m="4114960">think</span> <span m="4115200">the</span> <span m="4115290">question</span> <span m="4115689">was,</span> <span m="4116430">if</span> <span m="4116560">the</span> <span m="4116640">number</span> <span m="4116899">of</span> <span m="4117000">errors</span> <span m="4117359">is</span> <span m="4117470">small,</span> <span m="4118370">would</span> <span m="4118569">it be</span> <span m="4118720">good</span> <span m="4119189">to</span> <span m="4119290">actually</span> <span m="4119729">use</span> <span m="4120420">a</span> <span m="4120510">different</span> <span m="4120890">algorithm,</span> <span m="4121510">drop</span> <span m="4121810">into</span> <span m="4121979">a</span> <span m="4122040">different</span> <span m="4122330">algorithm?</span> <span m="4122800">So</span> <span m="4123399">there</span> <span m="4123609">are</span> <span m="4123950">algorithms</span> <span m="4124520">on</span> <span m="4125790">FM</span> <span m="4126170">index</span> <span m="4126560">assisted</span> <span m="4127170">Smith</span> <span m="4127330">Waterman,</span> <span m="4127729">for</span> <span m="4127880">example.</span> <span m="4128870">Where</span> <span m="4129220">you</span> <span m="4129460">get</span> <span m="4129729">to</span> <span m="4129830">the</span> <span m="4129899">neighborhood</span> <span m="4130569">by</span> <span m="4131399">a</span> <span m="4131490">fast</span> <span m="4131870">technique</span> <span m="4132380">and</span> <span m="4132550">then</span> <span m="4132760">you</span> <span m="4133020">do</span> <span m="4133260">a</span> <span m="4133330">full</span> <span m="4133930">search,</span> <span m="4134510">using</span> <span m="4135600">a</span> <span m="4135680">more</span> <span m="4135939">in</span> <span m="4136029">depth</span> <span m="4136490">principles</span> <span m="4137060">methodology,</span> <span m="4137800">right?</span> <span m="4138600">And</span> <span m="4138740">so</span> <span m="4138850">there's</span> <span m="4139109">some</span> <span m="4139240">papers</span> <span m="4139590">I</span> <span m="4139660">have</span> <span m="4139910">in the</span> <span m="4140050">slides</span> <span m="4140430">here</span> <span m="4140550">that</span> <span m="4140670">I</span> <span m="4140740">referenced</span> <span m="4141100">that do</span> <span m="4141200">exactly</span> <span m="4141939">that.</span> </p>
<p><span m="4144420">These</span> <span m="4144529">are</span> <span m="4144670">all</span> <span m="4144720">great</span> <span m="4144910">questions.</span> <span m="4146920">OK.</span> <span m="4147850">Yes.</span> </p>
<p><span m="4149000">AUDIENCE: If you're--</span> <span m="4150029">If</span> <span m="4150130">you</span> <span m="4150290">only</span> <span m="4150450">decide</span> <span m="4150930">to backtrack</span> <span m="4151350">a</span> <span m="4151470">certain</span> <span m="4152069">number</span> <span m="4152359">of</span> <span m="4152479">times,</span> <span m="4152700">like 100 times,</span> <span m="4153580">then</span> <span m="4153700">wouldn't</span> <span m="4153950">like</span> <span m="4154240">the</span> <span m="4154560">alignment</span> <span m="4154880">be</span> <span m="4155000">biased</span> <span m="4155430">towards</span> <span m="4155670">the</span> <span m="4156330">end</span> <span m="4156600">of</span> <span m="4156810">the</span> <span m="4157241">short</span> <span m="4157672">read?</span> </p>
<p><span m="4158103">PROFESSOR: I</span> <span m="4158534">am</span> <span m="4158965">so</span> <span m="4159399">glad</span> <span m="4159719">you asked this</span> <span m="4160040">question.</span> <span m="4160850">The</span> <span m="4160950">question</span> <span m="4161210">is,</span> <span m="4162970">and</span> <span m="4163090">what was</span> <span m="4163229">your</span> <span m="4163319">name</span> <span m="4163500">again?</span> </p>
<p><span m="4164313">AUDIENCE: Kevin.</span> </p>
<p><span m="4164736">PROFESSOR: Kevin.</span> <span m="4165160">Kevin</span> <span m="4165430">asks,</span> <span m="4167100">gee,</span> <span m="4167390">if</span> <span m="4167490">you're</span> <span m="4167600">matching</span> <span m="4168000">from</span> <span m="4168149">the</span> <span m="4168260">right</span> <span m="4168510">to</span> <span m="4168600">the</span> <span m="4168680">left,</span> <span m="4169290">and</span> <span m="4169460">you're</span> <span m="4169560">doing</span> <span m="4169830">backtracking,</span> <span m="4170500">isn't</span> <span m="4171290">this</span> <span m="4171520">going</span> <span m="4171620">to</span> <span m="4171680">be</span> <span m="4171819">biased</span> <span m="4172250">towards</span> <span m="4172520">the</span> <span m="4172649">right</span> <span m="4172880">into</span> <span m="4173120">the</span> <span m="4173270">read,</span> <span m="4173830">in</span> <span m="4173930">some</span> <span m="4174120">sense,</span> <span m="4174430">right?</span> <span m="4175029">Because</span> <span m="4176010">if</span> <span m="4176180">the</span> <span m="4176300">right</span> <span m="4176500">into</span> <span m="4176710">the read</span> <span m="4176979">doesn't</span> <span m="4177310">match,</span> <span m="4177710">then</span> <span m="4177939">you're</span> <span m="4178060">going</span> <span m="4178149">to</span> <span m="4178189">give</span> <span m="4178420">up,</span> <span m="4178880">right?</span> <span m="4179810">In</span> <span m="4179970">fact,</span> <span m="4180779">what</span> <span m="4180819">we</span> <span m="4180939">know</span> <span m="4181279">is</span> <span m="4181500">the</span> <span m="4181620">left</span> <span m="4181910">end</span> <span m="4182060">of</span> <span m="4182109">the</span> <span m="4182200">read</span> <span m="4182399">is</span> <span m="4182490">the</span> <span m="4182580">better</span> <span m="4182870">end of</span> <span m="4183010">the</span> <span m="4183149">read.</span> <span m="4183750">Because</span> <span m="4184670">sequences</span> <span m="4185140">are</span> <span m="4185229">done</span> <span m="4185410">five</span> <span m="4185680">prime</span> <span m="4185920">to</span> <span m="4186010">three</span> <span m="4186229">prime</span> <span m="4187210">and</span> <span m="4188229">thus</span> <span m="4188569">typically,</span> <span m="4188930">the</span> <span m="4189050">highest</span> <span m="4189420">quality</span> <span m="4189760">scores</span> <span m="4190270">or</span> <span m="4190340">the</span> <span m="4190450">best</span> <span m="4190689">quality</span> <span m="4190960">scores</span> <span m="4191240">are</span> <span m="4191310">in</span> <span m="4191370">the</span> <span m="4191430">left</span> <span m="4191670">hand</span> <span m="4191840">side</span> <span m="4192060">of</span> <span m="4192100">the</span> <span m="4192200">read.</span> </p>
<p><span m="4195130">So</span> <span m="4195520">do</span> <span m="4195980">you</span> <span m="4196190">have</span> <span m="4196460">any</span> <span m="4196800">idea</span> <span m="4197000">about</span> <span m="4197150">how</span> <span m="4197290">you</span> <span m="4197500">would cope</span> <span m="4197760">with</span> <span m="4197890">that?</span> </p>
<p><span m="4199510">AUDIENCE: You could</span> <span m="4199690">just</span> <span m="4199990">reverse</span> <span m="4200340">one</span> <span m="4200480">of them.</span> <span m="4201324">But</span> <span m="4201746">you'd reverse--</span> </p>
<p><span m="4202168">PROFESSOR: Exactly</span> <span m="4202590">what they do.</span> <span m="4202950">They</span> <span m="4203310">execute the</span> <span m="4203770">entire genome</span> <span m="4204110">and</span> <span m="4204240">they</span> <span m="4204710">reverse</span> <span m="4205100">it</span> <span m="4205240">and</span> <span m="4205340">then</span> <span m="4205450">they</span> <span m="4205560">index</span> <span m="4205890">that.</span> <span m="4208840">And</span> <span m="4209040">so,</span> <span m="4209260">when</span> <span m="4209440">they</span> <span m="4210000">create</span> <span m="4210210">what's</span> <span m="4210340">called</span> <span m="4210490">a</span> <span m="4210530">mirror</span> <span m="4210870">index, they just</span> <span m="4211280">reverse</span> <span m="4211670">the</span> <span m="4211790">entire</span> <span m="4212080">genome,</span> <span m="4212390">and</span> <span m="4212520">now</span> <span m="4212640">you can</span> <span m="4212850">match</span> <span m="4213180">left</span> <span m="4213400">to</span> <span m="4213480">right,</span> <span m="4213720">as</span> <span m="4213800">opposed</span> <span m="4214030">to</span> <span m="4214120">right to</span> <span m="4214370">left.</span> <span m="4215600">Pretty</span> <span m="4215800">cool,</span> <span m="4216050">huh?</span> <span m="4217670">Yeah.</span> </p>
<p><span m="4221090">So</span> <span m="4221730">backtracking,</span> <span m="4223560">just</span> <span m="4223780">note</span> <span m="4224040">that</span> <span m="4224170">there</span> <span m="4224350">are</span> <span m="4224470">different</span> <span m="4226200">alignments that</span> <span m="4226690">can</span> <span m="4226950">occur</span> <span m="4227290">across</span> <span m="4227820">different</span> <span m="4228170">backtracking</span> <span m="4228640">paths.</span> <span m="4229030">And</span> <span m="4229150">this</span> <span m="4229250">is</span> <span m="4229400">not</span> <span m="4229600">optimal</span> <span m="4230100">in</span> <span m="4230190">any</span> <span m="4230370">sense.</span> <span m="4231850">And</span> <span m="4232280">to</span> <span m="4232400">your</span> <span m="4232570">question</span> <span m="4232970">about</span> <span m="4233220">how</span> <span m="4233470">you</span> <span m="4233610">actually</span> <span m="4234060">go</span> <span m="4234240">about</span> <span m="4234880">picking</span> <span m="4235180">a</span> <span m="4235200">backtracking</span> <span m="4235790">strategy,</span> <span m="4238220">assuming</span> <span m="4238660">we're</span> <span m="4238810">matching</span> <span m="4239150">from</span> <span m="4239330">right</span> <span m="4239540">to</span> <span m="4239610">left</span> <span m="4239870">again</span> <span m="4240290">for</span> <span m="4240450">a</span> <span m="4240480">moment,</span> <span m="4241460">what</span> <span m="4241720">you</span> <span m="4241850">can</span> <span m="4242030">do</span> <span m="4242240">is,</span> <span m="4243060">if</span> <span m="4243230">you</span> <span m="4243370">hit</span> <span m="4243840">a</span> <span m="4245070">mismatch,</span> <span m="4246510">you</span> <span m="4246860">backtrack</span> <span m="4248160">to</span> <span m="4248310">the</span> <span m="4248630">lowest</span> <span m="4249270">quality</span> <span m="4249820">based</span> <span m="4250120">position,</span> <span m="4250610">according</span> <span m="4250980">to</span> <span m="4251050">PHRED</span> <span m="4251390">scores.</span> </p>
<p><span m="4251660">We</span> <span m="4251770">talked</span> <span m="4251980">about</span> <span m="4252210">PHRED</span> <span m="4252410">scores</span> <span m="4252780">earlier,</span> <span m="4253350">which</span> <span m="4253520">are</span> <span m="4253650">shown</span> <span m="4253980">here</span> <span m="4254210">on</span> <span m="4254270">the</span> <span m="4254380">slide.</span> <span m="4256270">And</span> <span m="4256600">you</span> <span m="4256850">backtrack</span> <span m="4257440">there</span> <span m="4257720">and</span> <span m="4257820">you</span> <span m="4257910">try a</span> <span m="4258180">different</span> <span m="4258560">base</span> <span m="4258840">and</span> <span m="4259030">you</span> <span m="4259110">move</span> <span m="4259320">forward</span> <span m="4259680">from</span> <span m="4259870">there.</span> <span m="4260770">So</span> <span m="4261230">you're</span> <span m="4261350">assuming</span> <span m="4261810">that</span> <span m="4261990">the</span> <span m="4262080">read,</span> <span m="4262730">which</span> <span m="4262890">is</span> <span m="4263010">the</span> <span m="4263110">query,</span> <span m="4263900">which</span> <span m="4264090">is</span> <span m="4264160">associated</span> <span m="4264640">quality</span> <span m="4265030">scores,</span> <span m="4266220">is</span> <span m="4266430">most</span> <span m="4266800">suspect</span> <span m="4267420">where</span> <span m="4267550">the</span> <span m="4267650">quality</span> <span m="4267960">score is</span> <span m="4268320">the</span> <span m="4268390">lowest.</span> <span m="4270190">So</span> <span m="4270230">you</span> <span m="4270300">backtrack</span> <span m="4271450">to</span> <span m="4271570">the</span> <span m="4271700">right</span> <span m="4272160">to</span> <span m="4272700">the</span> <span m="4273410">leftmost</span> <span m="4274290">lowest</span> <span m="4274650">quality</span> <span m="4275020">score.</span> </p>
<p><span m="4276710">Now</span> <span m="4279200">it's</span> <span m="4279440">a</span> <span m="4279490">very</span> <span m="4279710">simple</span> <span m="4280060">approach.</span> <span m="4281160">Right?</span> <span m="4282040">And</span> <span m="4282350">we</span> <span m="4282470">talked</span> <span m="4282700">a</span> <span m="4282760">little</span> <span m="4283000">bit</span> <span m="4283140">about</span> <span m="4283620">the</span> <span m="4283730">idea</span> <span m="4284270">that</span> <span m="4285260">you</span> <span m="4285390">don't</span> <span m="4285560">necessarily</span> <span m="4285930">want</span> <span m="4286090">to</span> <span m="4286130">match</span> <span m="4286400">from</span> <span m="4286550">the</span> <span m="4286660">right</span> <span m="4286930">side</span> <span m="4288080">and</span> <span m="4288720">thus,</span> <span m="4289320">typically</span> <span m="4289690">the</span> <span m="4289800">parameters</span> <span m="4290060">to</span> <span m="4290320">algorithms</span> <span m="4290880">like</span> <span m="4291080">this</span> <span m="4291260">include,</span> <span m="4292420">how</span> <span m="4292660">many</span> <span m="4292830">mismatches</span> <span m="4293320">are</span> <span m="4293520">allowed</span> <span m="4293850">in the</span> <span m="4293920">first</span> <span m="4294230">L</span> <span m="4294440">bases</span> <span m="4294920">on</span> <span m="4294990">the</span> <span m="4295070">left</span> <span m="4295350">end,</span> <span m="4296070">the</span> <span m="4296190">sum</span> <span m="4296460">of the</span> <span m="4296520">mismatch</span> <span m="4296970">qualities</span> <span m="4297320">you're</span> <span m="4297410">going</span> <span m="4297550">to</span> <span m="4297640">tolerate,</span> <span m="4298030">and</span> <span m="4298140">so</span> <span m="4298300">forth.</span> <span m="4298580">And</span> <span m="4298640">you'll</span> <span m="4298740">find</span> <span m="4299030">that these</span> <span m="4299170">align yourself</span> <span m="4299580">with</span> <span m="4299670">a lot of</span> <span m="4300020">switches</span> <span m="4300290">that</span> <span m="4300400">you</span> <span m="4300610">can</span> <span m="4300760">set.</span> <span m="4302120">And</span> <span m="4302260">you</span> <span m="4302360">can</span> <span m="4302500">consult</span> <span m="4302990">with</span> <span m="4303540">your</span> <span m="4303720">colleagues</span> <span m="4304250">about</span> <span m="4304430">how</span> <span m="4304570">to</span> <span m="4304650">set</span> <span m="4304920">switches,</span> <span m="4305270">because</span> <span m="4305520">it</span> <span m="4305600">depends</span> <span m="4305900">upon</span> <span m="4306170">the</span> <span m="4306240">particular</span> <span m="4306760">type</span> <span m="4306960">of</span> <span m="4307050">data</span> <span m="4307280">you're</span> <span m="4307480">aligning,</span> <span m="4307900">the</span> <span m="4308010">length</span> <span m="4308240">of</span> <span m="4308330">the</span> <span m="4308450">reads</span> <span m="4308810">and so</span> <span m="4309040">forth.</span> </p>
<p><span m="4310560">But</span> <span m="4310730">suffice</span> <span m="4311150">it to</span> <span m="4311260">say,</span> <span m="4313220">when</span> <span m="4313420">you're</span> <span m="4313930">doing</span> <span m="4314290">this,</span> <span m="4315780">typically</span> <span m="4316240">we</span> <span m="4316380">create</span> <span m="4316610">these</span> <span m="4316760">mirror</span> <span m="4317110">indices</span> <span m="4317920">that</span> <span m="4318070">actually</span> <span m="4318310">reverse</span> <span m="4318760">the</span> <span m="4318930">entire</span> <span m="4319050">genome</span> <span m="4319780">and then</span> <span m="4319980">index</span> <span m="4320390">it.</span> <span m="4321300">So</span> <span m="4321380">we</span> <span m="4321490">can either</span> <span m="4321630">match</span> <span m="4321910">either</span> <span m="4322270">right</span> <span m="4322490">to</span> <span m="4322570">left</span> <span m="4322790">or</span> <span m="4323050">left</span> <span m="4323310">to</span> <span m="4323410">right.</span> <span m="4325180">And</span> <span m="4325330">so</span> <span m="4325480">for</span> <span m="4325680">example,</span> <span m="4326370">if</span> <span m="4326460">you</span> <span m="4327070">have</span> <span m="4327350">a</span> <span m="4327410">mirror</span> <span m="4327780">index,</span> <span m="4329650">and</span> <span m="4329850">you</span> <span m="4330100">only</span> <span m="4330410">tolerate</span> <span m="4330920">up</span> <span m="4331150">to</span> <span m="4331270">two</span> <span m="4331550">errors,</span> <span m="4333480">then</span> <span m="4333710">you know</span> <span m="4334055">that</span> <span m="4334400">either,</span> <span m="4334850">you're</span> <span m="4334960">going</span> <span m="4335070">to</span> <span m="4335130">get</span> <span m="4335340">the</span> <span m="4335420">first</span> <span m="4335820">half</span> <span m="4336040">right</span> <span m="4336320">in</span> <span m="4336450">one</span> <span m="4336640">index</span> <span m="4336950">or</span> <span m="4337060">the</span> <span m="4337150">mirror</span> <span m="4337410">index.</span> <span m="4339450">And</span> <span m="4339580">so</span> <span m="4339650">you</span> <span m="4339720">can</span> <span m="4339840">use</span> <span m="4340030">both</span> <span m="4340310">indices</span> <span m="4340690">in</span> <span m="4340770">parallel,</span> <span m="4341630">the</span> <span m="4341720">forward</span> <span m="4342060">and</span> <span m="4342190">the</span> <span m="4342270">reverse</span> <span m="4342580">index</span> <span m="4342960">of</span> <span m="4343050">the</span> <span m="4343130">genome,</span> <span m="4344060">and</span> <span m="4344730">then</span> <span m="4344920">get</span> <span m="4345180">pretty</span> <span m="4345410">far</span> <span m="4345780">into</span> <span m="4345970">the</span> <span m="4346140">read</span> <span m="4346770">before</span> <span m="4347070">you have to</span> <span m="4347230">start</span> <span m="4347450">backtracking.</span> </p>
<p><span m="4349990">There are</span> <span m="4350210">all</span> <span m="4350420">these</span> <span m="4350590">sorts</span> <span m="4350860">of</span> <span m="4351660">techniques,</span> <span m="4352120">shall</span> <span m="4352320">we</span> <span m="4352460">say,</span> <span m="4352830">to</span> <span m="4352920">actually</span> <span m="4353710">overcome</span> <span m="4354180">some</span> <span m="4354380">the</span> <span m="4354450">limitations</span> <span m="4355030">of</span> <span m="4355100">backtracking.</span> <span m="4356900">Any</span> <span m="4357120">questions</span> <span m="4357500">about</span> <span m="4357690">backtracking</span> <span m="4358230">at</span> <span m="4358280">all?</span> <span m="4361020">Yes.</span> </p>
<p><span m="4361650">AUDIENCE: Is it</span> <span m="4362149">trivial</span> <span m="4362648">knowing</span> <span m="4363147">the</span> <span m="4363646">BWT</span> <span m="4364145">originally</span> <span m="4365143">to find</span> <span m="4365642">the</span> <span m="4366141">mirror</span> <span m="4366640">BWT?</span> <span m="4367638">Like</span> <span m="4368137">for example,</span> </p>
<p><span m="4368636">PROFESSOR: No,</span> <span m="4369135">it's not</span> <span m="4369634">trivial.</span> </p>
<p><span m="4370632">AUDIENCE: So it's</span> <span m="4371131">not like</span> <span m="4371630">a simple</span> <span m="4372129">matrix</span> <span m="4372628">transforming</span> <span m="4373127">[INAUDIBLE].</span> </p>
<p><span m="4374640">PROFESSOR: No.</span> <span m="4374935">Not to</span> <span m="4375230">my knowledge.</span> <span m="4375957">I think</span> <span m="4376404">you start with</span> <span m="4376851">the original genome,</span> <span m="4377300">you</span> <span m="4377510">reverse</span> <span m="4377910">it</span> <span m="4378020">and then</span> <span m="4378190">you</span> <span m="4378260">compute</span> <span m="4378540">the</span> <span m="4378610">BWT</span> <span m="4379080">with</span> <span m="4379160">that.</span> <span m="4380100">Right?</span> <span m="4380480">That's</span> <span m="4380710">pretty</span> <span m="4380970">easy</span> <span m="4381170">to</span> <span m="4381270">do.</span> <span m="4382920">And</span> <span m="4383110">Hang</span> <span m="4383370">was</span> <span m="4383510">explaining</span> <span m="4383910">to</span> <span m="4383970">me</span> <span m="4384090">today</span> <span m="4384290">how</span> <span m="4384460">you</span> <span m="4384590">compute</span> <span m="4385210">his</span> <span m="4385440">new</span> <span m="4385630">ways</span> <span m="4385830">of</span> <span m="4386250">compute</span> <span m="4386310">BWT,</span> <span m="4386970">which</span> <span m="4387170">don't</span> <span m="4387370">actually</span> <span m="4387660">involve</span> <span m="4388030">sorting</span> <span m="4388350">the</span> <span m="4388460">entire</span> <span m="4388790">thing.</span> <span m="4389880">There are</span> <span m="4390140">insertion</span> <span m="4390700">ways</span> <span m="4390880">of</span> <span m="4390950">computing</span> <span m="4391040">the</span> <span m="4391160">BWT</span> <span m="4391250">that</span> <span m="4391360">are</span> <span m="4391850">very</span> <span m="4393150">[INAUDIBLE],</span> <span m="4394020">and</span> <span m="4394120">you</span> <span m="4394180">could</span> <span m="4394310">ask</span> <span m="4394500">him</span> <span m="4394580">this</span> <span m="4394690">question</span> <span m="4394990">tomorrow</span> <span m="4395060">if you</span> <span m="4395340">care</span> <span m="4395510">to</span> <span m="4395570">come.</span> </p>
<p><span m="4396850">All</span> <span m="4396940">right</span> <span m="4397780">just</span> <span m="4397960">to</span> <span m="4398040">give</span> <span m="4398190">you</span> <span m="4398270">an</span> <span m="4398350">idea</span> <span m="4398600">on</span> <span m="4398740">how</span> <span m="4399190">complex</span> <span m="4399580">things</span> <span m="4399820">are,</span> <span m="4400650">to</span> <span m="4400780">build</span> <span m="4401170">an</span> <span m="4401290">index</span> <span m="4401670">like</span> <span m="4401860">this,</span> <span m="4403280">takes,</span> <span m="4403830">for</span> <span m="4403960">the</span> <span m="4404110">entire</span> <span m="4404460">human</span> <span m="4404810">genome,</span> <span m="4405700">we're</span> <span m="4405770">talking</span> <span m="4406360">five</span> <span m="4407860">hours</span> <span m="4408300">of</span> <span m="4408780">compute</span> <span m="4409180">time</span> <span m="4409540">to</span> <span m="4409620">compute</span> <span m="4409960">an</span> <span m="4410090">index</span> <span m="4410820">to</span> <span m="4410920">give</span> <span m="4411110">you</span> <span m="4411250">an</span> <span m="4411310">order</span> <span m="4411670">of</span> <span m="4411710">magnitude</span> <span m="4412220">time</span> <span m="4412750">for</span> <span m="4412880">how</span> <span m="4413030">to</span> <span m="4413110">compute</span> <span m="4414130">the</span> <span m="4414780">BWT.</span> <span m="4416095">the</span> <span m="4416360">LF</span> <span m="4417100">checkpoints,</span> <span m="4417660">and</span> <span m="4417770">the</span> <span m="4417860">suffix</span> <span m="4418210">array</span> <span m="4418780">sampling.</span> <span m="4419780">Something</span> <span m="4420120">like</span> <span m="4420320">that.</span> </p>
<p><span m="4421070">So it's</span> <span m="4421250">really</span> <span m="4421440">not</span> <span m="4421620">too</span> <span m="4421720">bad</span> <span m="4421940">to</span> <span m="4422020">compute</span> <span m="4422620">the</span> <span m="4422710">index</span> <span m="4422970">of</span> <span m="4423030">the</span> <span m="4423140">entire</span> <span m="4423480">genome.</span> <span m="4426050">And</span> <span m="4426430">to</span> <span m="4426570">do</span> <span m="4427010">searches,</span> <span m="4428450">you</span> <span m="4428570">know,</span> <span m="4428710">we're</span> <span m="4428850">talking</span> <span m="4429270">about,</span> <span m="4429620">like</span> <span m="4429790">on a</span> <span m="4429950">four</span> <span m="4430190">processor</span> <span m="4430740">machine,</span> <span m="4431070">we're</span> <span m="4431180">talking</span> <span m="4431480">about</span> <span m="4431680">maybe</span> <span m="4431990">upwards</span> <span m="4432340">of</span> <span m="4432430">100</span> <span m="4432860">million</span> <span m="4433180">rads</span> <span m="4433460">per</span> <span m="4433620">hour</span> <span m="4434070">to</span> <span m="4434200">map.</span> <span m="4435560">So</span> <span m="4435710">if</span> <span m="4435780">you have</span> <span m="4435920">200</span> <span m="4436250">million</span> <span m="4436540">reads</span> <span m="4437150">and</span> <span m="4437310">you</span> <span m="4437400">want</span> <span m="4437540">to</span> <span m="4437580">map</span> <span m="4437860">them</span> <span m="4438120">to a</span> <span m="4438190">genome,</span> <span m="4438800">or</span> <span m="4438970">align</span> <span m="4439290">them</span> <span m="4439450">as</span> <span m="4439580">it's</span> <span m="4439720">sometimes</span> <span m="4440090">called,</span> <span m="4441320">it's</span> <span m="4441450">going to</span> <span m="4441610">take</span> <span m="4441780">you a</span> <span m="4441870">couple</span> <span m="4442170">hours</span> <span m="4442400">to</span> <span m="4442490">do</span> <span m="4442670">it.</span> <span m="4443970">So</span> <span m="4444130">this</span> <span m="4444370">is</span> <span m="4444530">sort</span> <span m="4444720">of</span> <span m="4444760">the</span> <span m="4444910">order</span> <span m="4445260">of</span> <span m="4445300">magnitude</span> <span m="4445990">of</span> <span m="4446100">the</span> <span m="4446530">time</span> <span m="4446920">required</span> <span m="4447400">to</span> <span m="4447460">do</span> <span m="4447610">these</span> <span m="4447830">sorts</span> <span m="4447910">of</span> <span m="4448010">functions.</span> </p>
<p><span m="4450730">And</span> <span m="4451520">there</span> <span m="4451620">are</span> <span m="4451720">a</span> <span m="4451820">couple</span> <span m="4451950">fine</span> <span m="4452310">points</span> <span m="4452550">I</span> <span m="4452580">wanted</span> <span m="4452860">to end</span> <span m="4453070">with</span> <span m="4453240">today.</span> <span m="4454760">The</span> <span m="4454770">first</span> <span m="4455130">is</span> <span m="4455220">we</span> <span m="4455350">haven't</span> <span m="4455600">talked</span> <span m="4455890">at all</span> <span m="4456000">about</span> <span m="4456280">paired,</span> <span m="4456780">erred,</span> <span m="4457160">and</span> <span m="4457400">read</span> <span m="4457640">alignment.</span> <span m="4463190">In</span> <span m="4463370">paired</span> <span m="4463740">read</span> <span m="4464125">alignment,</span> <span m="4465210">you</span> <span m="4465460">get,</span> <span m="4466370">for</span> <span m="4466550">each</span> <span m="4466800">molecule,</span> <span m="4467950">you</span> <span m="4468050">get</span> <span m="4468300">two</span> <span m="4468510">reads.</span> <span m="4469180">One</span> <span m="4470110">starting</span> <span m="4470560">at</span> <span m="4470640">the</span> <span m="4470720">five</span> <span m="4470990">prime</span> <span m="4471300">end</span> <span m="4471480">on</span> <span m="4471630">one</span> <span m="4471830">side,</span> <span m="4472095">,</span> <span m="4472360">and</span> <span m="4472520">one</span> <span m="4472620">starting</span> <span m="4472880">from</span> <span m="4472980">the</span> <span m="4473050">five</span> <span m="4473250">prime</span> <span m="4473480">end</span> <span m="4473630">on</span> <span m="4473700">the</span> <span m="4473820">other</span> <span m="4473980">side.</span> <span m="4475840">So</span> <span m="4475920">typical</span> <span m="4476360">read</span> <span m="4476540">links</span> <span m="4476750">might</span> <span m="4476960">be</span> <span m="4477210">100</span> <span m="4477540">base</span> <span m="4477770">pairs</span> <span m="4478040">on</span> <span m="4478120">the</span> <span m="4478190">left</span> <span m="4478540">and</span> <span m="4478610">100</span> <span m="4478850">base</span> <span m="4479050">pairs</span> <span m="4479280">on</span> <span m="4479380">the</span> <span m="4479470">right.</span> </p>
<p><span m="4481490">What</span> <span m="4481810">is</span> <span m="4482550">called</span> <span m="4482790">the</span> <span m="4482890">insert</span> <span m="4483390">size</span> <span m="4483740">is</span> <span m="4484010">the</span> <span m="4484160">total</span> <span m="4484700">size</span> <span m="4485340">of</span> <span m="4485470">the</span> <span m="4485530">molecule</span> <span m="4486190">from</span> <span m="4486420">five</span> <span m="4486730">prime</span> <span m="4487040">end</span> <span m="4487330">to</span> <span m="4487410">five</span> <span m="4487670">prime</span> <span m="4487860">end</span> <span m="4488000">to</span> <span m="4488170">read.</span> <span m="4489260">And</span> <span m="4489510">the</span> <span m="4489590">stuff</span> <span m="4490040">in</span> <span m="4490160">the</span> <span m="4490230">middle</span> <span m="4490520">is</span> <span m="4491110">not</span> <span m="4491310">observed.</span> <span m="4492230">We</span> <span m="4492400">actually</span> <span m="4492800">don't</span> <span m="4493140">know</span> <span m="4493270">what</span> <span m="4493470">it</span> <span m="4493560">is.</span> <span m="4494600">And</span> <span m="4494810">we</span> <span m="4494930">also</span> <span m="4495140">don't</span> <span m="4495340">know</span> <span m="4495450">how</span> <span m="4495600">long</span> <span m="4495890">it</span> <span m="4495950">is.</span> <span m="4497610">Now</span> <span m="4498640">when</span> <span m="4498980">these</span> <span m="4499170">libraries</span> <span m="4499680">are</span> <span m="4499800">prepared,</span> <span m="4500460">size</span> <span m="4500810">selection</span> <span m="4501105">is</span> <span m="4501400">done,</span> <span m="4502220">so</span> <span m="4502350">we</span> <span m="4502410">get</span> <span m="4502520">a</span> <span m="4502610">rough</span> <span m="4502880">idea</span> <span m="4503480">of</span> <span m="4504240">what</span> <span m="4504430">it</span> <span m="4504600">should</span> <span m="4504890">be.</span> <span m="4505380">We</span> <span m="4505540">can</span> <span m="4505660">actually</span> <span m="4505960">compute</span> <span m="4506400">by</span> <span m="4506500">looking</span> <span m="4506970">at</span> <span m="4507110">where</span> <span m="4507280">things</span> <span m="4507680">align</span> <span m="4508100">on</span> <span m="4508190">the</span> <span m="4508270">genome,</span> <span m="4508930">what</span> <span m="4509100">it</span> <span m="4509200">actually</span> <span m="4509800">is.</span> <span m="4511090">But</span> <span m="4511230">we</span> <span m="4511360">don't</span> <span m="4511600">know</span> <span m="4511810">absolutely.</span> </p>
<p><span m="4514700">If</span> <span m="4514940">we</span> <span m="4515040">were</span> <span m="4515260">able</span> <span m="4515820">to</span> <span m="4516980">strictly</span> <span m="4517490">control</span> <span m="4518010">the</span> <span m="4518090">length</span> <span m="4518370">of</span> <span m="4518460">the</span> <span m="4518590">unobserved</span> <span m="4519270">part,</span> <span m="4520240">which</span> <span m="4520430">is</span> <span m="4521060">almost</span> <span m="4521360">impossible</span> <span m="4521910">to</span> <span m="4522020">do,</span> <span m="4522930">then</span> <span m="4523080">we</span> <span m="4523180">would</span> <span m="4523330">get</span> <span m="4523510">molecular</span> <span m="4524000">rulers.</span> <span m="4525370">And</span> <span m="4525510">we</span> <span m="4525600">would</span> <span m="4525810">know</span> <span m="4526150">exactly</span> <span m="4526590">down</span> <span m="4526850">to</span> <span m="4526890">the</span> <span m="4527010">base,</span> <span m="4528100">whether</span> <span m="4528360">or</span> <span m="4528390">not</span> <span m="4528550">there were</span> <span m="4528760">indels</span> <span m="4529250">between</span> <span m="4530020">the</span> <span m="4530140">left</span> <span m="4530340">read</span> <span m="4530480">and</span> <span m="4530910">the</span> <span m="4531060">right read when we</span> <span m="4531130">did</span> <span m="4531290">the</span> <span m="4531380">alignment.</span> <span m="4531820">We</span> <span m="4532010">actually</span> <span m="4532200">don't</span> <span m="4532440">have</span> <span m="4532700">that</span> <span m="4532900">today.</span> </p>
<p><span m="4535790">The</span> <span m="4535930">sequencing</span> <span m="4536610">instrument</span> <span m="4537100">actually</span> <span m="4537550">identifies</span> <span m="4538340">the</span> <span m="4538480">read</span> <span m="4538735">pairs</span> <span m="4538990">in</span> <span m="4539200">its</span> <span m="4539300">output.</span> <span m="4539970">That's</span> <span m="4540130">the</span> <span m="4540210">only</span> <span m="4540480">way</span> <span m="4540640">to</span> <span m="4540740">do</span> <span m="4540900">this.</span> <span m="4541660">So</span> <span m="4541720">when you</span> <span m="4541840">get</span> <span m="4542040">an output</span> <span m="4542410">file,</span> <span m="4543190">like</span> <span m="4543290">a</span> <span m="4543340">fast</span> <span m="4543700">Q</span> <span m="4543810">file,</span> <span m="4544220">from a</span> <span m="4544630">sequencing</span> <span m="4545190">instrument,</span> <span m="4545830">it</span> <span m="4545940">will</span> <span m="4546080">tell</span> <span m="4546330">you,</span> <span m="4546920">for</span> <span m="4547110">a</span> <span m="4547150">given</span> <span m="4547420">molecule,</span> <span m="4547900">here's</span> <span m="4548240">the</span> <span m="4548340">left</span> <span m="4548600">read</span> <span m="4548860">and</span> <span m="4549120">here's</span> <span m="4549230">the right</span> <span m="4549470">read.</span> <span m="4550450">Although</span> <span m="4550830">left</span> <span m="4551090">and</span> <span m="4551240">right</span> <span m="4551450">are</span> <span m="4551800">really</span> <span m="4551870">sort of</span> <span m="4551920">misnomers</span> <span m="4552480">because</span> <span m="4552750">there</span> <span m="4552880">really</span> <span m="4553050">is</span> <span m="4553180">no</span> <span m="4553310">left</span> <span m="4553510">and</span> <span m="4553640">right,</span> <span m="4554000">right?</span> <span m="4555060">This is</span> <span m="4555130">one</span> <span m="4555360">end and</span> <span m="4555520">then</span> <span m="4555650">this</span> <span m="4555760">is</span> <span m="4555850">the</span> <span m="4555990">other</span> <span m="4556210">end.</span> </p>
<p><span m="4559140">Typical</span> <span m="4559560">ways</span> <span m="4559760">of</span> <span m="4559850">processing</span> <span m="4560310">these</span> <span m="4560460">paired</span> <span m="4560680">reads,</span> <span m="4561190">first you</span> <span m="4561560">align</span> <span m="4561900">left</span> <span m="4562120">and</span> <span m="4562230">right</span> <span m="4562420">reads.</span> <span m="4563950">And</span> <span m="4564280">they</span> <span m="4564380">could</span> <span m="4564590">really</span> <span m="4564830">only</span> <span m="4565080">be</span> <span m="4565670">oriented</span> <span m="4566280">with</span> <span m="4566430">respect</span> <span m="4566740">to a</span> <span m="4566840">genome</span> <span m="4567140">sequence</span> <span m="4567490">where you</span> <span m="4567630">say</span> <span m="4567760">that</span> <span m="4567900">one</span> <span m="4568130">has</span> <span m="4568230">a</span> <span m="4568280">lower</span> <span m="4568510">coordinate</span> <span m="4569030">than</span> <span m="4569130">the</span> <span m="4569250">other</span> <span m="4569420">one</span> <span m="4569780">when</span> <span m="4569910">you're</span> <span m="4570040">actually</span> <span m="4570240">doing</span> <span m="4570440">the</span> <span m="4570550">alignment.</span> <span m="4572680">And</span> <span m="4572880">if</span> <span m="4573030">one</span> <span m="4573280">read</span> <span m="4573540">fails</span> <span m="4573800">to</span> <span m="4573890">align</span> <span m="4574250">uniquely,</span> <span m="4574770">then</span> <span m="4574950">what</span> <span m="4575050">you</span> <span m="4575150">can</span> <span m="4575280">do</span> <span m="4575380">is, you know</span> <span m="4575470">what</span> <span m="4575930">neighborhood</span> <span m="4576600">you're</span> <span m="4576780">in</span> <span m="4577730">because you know,</span> <span m="4578100">roughly</span> <span m="4579200">speaking,</span> <span m="4579710">what</span> <span m="4579900">the</span> <span m="4580030">insert</span> <span m="4580450">size</span> <span m="4580790">is,</span> <span m="4581780">so</span> <span m="4581900">you</span> <span m="4581980">can</span> <span m="4582090">do</span> <span m="4582200">Smith</span> <span m="4582510">Waterman</span> <span m="4582930">to</span> <span m="4583350">actually</span> <span m="4583630">try</span> <span m="4583910">and</span> <span m="4584010">locate</span> <span m="4584420">the</span> <span m="4584540">other</span> <span m="4584780">read</span> <span m="4585230">in</span> <span m="4585390">that</span> <span m="4585560">neighborhood.</span> <span m="4586620">Or</span> <span m="4587030">you</span> <span m="4587120">can</span> <span m="4587280">tolerate</span> <span m="4589160">multiply</span> <span m="4589670">mapped</span> <span m="4590080">reads.</span> </p>
<p><span m="4590970">One</span> <span m="4591180">thing</span> <span m="4591510">that</span> <span m="4591680">I</span> <span m="4591780">did</span> <span m="4592010">not</span> <span m="4592190">mention</span> <span m="4592470">to</span> <span m="4592580">you</span> <span m="4593360">explicitly,</span> <span m="4594220">is</span> <span m="4594350">that</span> <span m="4594460">when</span> <span m="4594660">you</span> <span m="4595320">match</span> <span m="4595630">the</span> <span m="4595730">entire</span> <span m="4596020">query,</span> <span m="4596380">and</span> <span m="4596490">top</span> <span m="4596720">and</span> <span m="4596830">bottom</span> <span m="4597190">are</span> <span m="4597280">more</span> <span m="4597520">than</span> <span m="4597720">one</span> <span m="4597900">away</span> <span m="4598750">from</span> <span m="4598930">each</span> <span m="4599120">other,</span> <span m="4599390">that</span> <span m="4599580">means</span> <span m="4599790">you've</span> <span m="4599890">got</span> <span m="4600150">many</span> <span m="4600530">places</span> <span m="4600860">in</span> <span m="4600950">the</span> <span m="4601040">genome</span> <span m="4601460">that</span> <span m="4601580">things</span> <span m="4601910">map.</span> <span m="4603410">And</span> <span m="4603580">thus</span> <span m="4603760">you</span> <span m="4603850">may</span> <span m="4603990">report</span> <span m="4604350">all of</span> <span m="4604670">those</span> <span m="4604850">locations</span> <span m="4605300">or</span> <span m="4605750">I</span> <span m="4605880">might</span> <span m="4606060">report</span> <span m="4606400">the</span> <span m="4606490">first</span> <span m="4606840">one.</span> <span m="4609030">So</span> <span m="4609210">that's</span> <span m="4610970">one</span> <span m="4611450">bit</span> <span m="4611870">of</span> <span m="4612590">insight</span> <span m="4613140">into</span> <span m="4613380">how</span> <span m="4613550">to</span> <span m="4613640">do</span> <span m="4613760">a</span> <span m="4613900">map</span> <span m="4614400">paired</span> <span m="4614700">reads.</span> </p>
<p><span m="4615950">And</span> <span m="4616440">these</span> <span m="4616670">are</span> <span m="4616720">becoming</span> <span m="4617030">very</span> <span m="4617330">important</span> <span m="4617790">because as</span> <span m="4617990">sequencing</span> <span m="4618530">costs</span> <span m="4618900">go</span> <span m="4619020">down,</span> <span m="4619900">people</span> <span m="4620280">are</span> <span m="4620420">doing</span> <span m="4620680">more</span> <span m="4621040">and</span> <span m="4621120">more</span> <span m="4622840">paired</span> <span m="4623180">and</span> <span m="4623350">sequencing</span> <span m="4624590">because</span> <span m="4624860">they</span> <span m="4624950">give</span> <span m="4625140">you</span> <span m="4625240">much</span> <span m="4625430">more</span> <span m="4625600">information</span> <span m="4626190">about</span> <span m="4626400">the</span> <span m="4626520">original</span> <span m="4626900">library</span> <span m="4627360">you</span> <span m="4627480">created</span> <span m="4628790">and</span> <span m="4629210">for</span> <span m="4629340">certain</span> <span m="4629630">protocols</span> <span m="4630230">can</span> <span m="4630330">allow</span> <span m="4630610">you</span> <span m="4630710">to</span> <span m="4630810">localize</span> <span m="4631430">events</span> <span m="4631710">in</span> <span m="4631780">the</span> <span m="4631850">genome</span> <span m="4632330">far</span> <span m="4632450">more</span> <span m="4632710">accurately.</span> </p>
<p><span m="4636500">Final</span> <span m="4636900">piece</span> <span m="4637130">of</span> <span m="4637260">advice</span> <span m="4638280">on</span> <span m="4638450">considerations</span> <span m="4638930">for</span> <span m="4639090">read</span> <span m="4639455">alignment.</span> <span m="4640580">We</span> <span m="4640710">talked</span> <span m="4641820">about</span> <span m="4642130">the</span> <span m="4642240">idea</span> <span m="4642610">that</span> <span m="4642880">some</span> <span m="4643100">reads</span> <span m="4643370">will</span> <span m="4643490">map</span> <span m="4644250">or</span> <span m="4644420">align</span> <span m="4644780">uniquely</span> <span m="4645220">to</span> <span m="4645340">the</span> <span m="4645420">genome</span> <span m="4646350">and</span> <span m="4646610">some</span> <span m="4646880">will</span> <span m="4647570">multimap.</span> <span m="4650390">You</span> <span m="4650490">know</span> <span m="4650670">that the</span> <span m="4650790">genome</span> <span m="4651110">is</span> <span m="4651190">roughly</span> <span m="4652300">50%</span> <span m="4652970">repeat</span> <span m="4653310">sequence.</span> <span m="4654740">And</span> <span m="4654910">thus</span> <span m="4655170">it's</span> <span m="4655390">likely</span> <span m="4655900">that</span> <span m="4656100">if</span> <span m="4656230">you</span> <span m="4656310">have</span> <span m="4656540">a</span> <span m="4656600">particular</span> <span m="4657140">read</span> <span m="4658600">molecule,</span> <span m="4660050">there's</span> <span m="4660180">a</span> <span m="4660270">reasonable</span> <span m="4660660">chance</span> <span m="4661030">that</span> <span m="4661210">it</span> <span m="4661380">will</span> <span m="4662320">map</span> <span m="4662640">to</span> <span m="4662740">multiple</span> <span m="4663210">locations.</span> <span m="4664380">Is there a</span> <span m="4664480">question</span> <span m="4664790">here?</span> <span m="4665070">No.</span> <span m="4665501">OK.</span> </p>
<p><span m="4667660">You have to</span> <span m="4667970">figure out</span> <span m="4668330">what your</span> <span m="4668640">desired</span> <span m="4668950">mismatch</span> <span m="4669360">tolerance</span> <span m="4669630">is</span> <span m="4669900">when</span> <span m="4670010">you're</span> <span m="4670090">doing</span> <span m="4672380">alignment</span> <span m="4672820">and</span> <span m="4672910">set</span> <span m="4673050">the</span> <span m="4673130">parameters</span> <span m="4673620">to your</span> <span m="4673770">aligner</span> <span m="4674470">carefully,</span> <span m="4675380">after</span> <span m="4675640">reading</span> <span m="4675860">the</span> <span m="4675920">documentation</span> <span m="4676610">thoroughly,</span> <span m="4677450">because</span> <span m="4677880">as you</span> <span m="4678000">could</span> <span m="4678190">tell,</span> <span m="4678940">there's</span> <span m="4679180">no</span> <span m="4679670">beautiful</span> <span m="4680260">matrix</span> <span m="4680670">formulation</span> <span m="4681300">like</span> <span m="4681480">there</span> <span m="4681660">is</span> <span m="4682140">with</span> <span m="4682250">a</span> <span m="4682440">well</span> <span m="4682890">established</span> <span m="4684840">basis</span> <span m="4685420">in</span> <span m="4685540">the</span> <span m="4685630">literature,</span> <span m="4686580">rather</span> <span m="4687410">it's</span> <span m="4687810">more</span> <span m="4688080">ad</span> <span m="4688230">hoc.</span> <span m="4689720">And</span> <span m="4689890">you</span> <span m="4689940">need</span> <span m="4690070">to</span> <span m="4690120">figure</span> <span m="4690360">out</span> <span m="4690420">what</span> <span m="4690560">the</span> <span m="4690700">desired</span> <span m="4690960">processing</span> <span m="4691510">is for</span> <span m="4691690">paired</span> <span m="4692160">reads.</span> </p>
<p><span m="4694520">So</span> <span m="4694680">what</span> <span m="4694850">we've</span> <span m="4694980">talked</span> <span m="4695240">about</span> <span m="4695460">today</span> <span m="4696320">is</span> <span m="4696450">we</span> <span m="4696550">started off</span> <span m="4696900">talking</span> <span m="4697140">about</span> <span m="4697310">library</span> <span m="4697730">complexity</span> <span m="4698930">and</span> <span m="4699070">the</span> <span m="4699190">idea</span> <span m="4699640">that</span> <span m="4699770">when</span> <span m="4699920">we</span> <span m="4700030">get</span> <span m="4701000">a</span> <span m="4701180">bunch</span> <span m="4701460">of</span> <span m="4701590">reads</span> <span m="4702610">from</span> <span m="4702860">a</span> <span m="4702910">sequencer,</span> <span m="4703910">we</span> <span m="4704100">can</span> <span m="4704280">use</span> <span m="4704600">that</span> <span m="4704770">collection</span> <span m="4705180">of</span> <span m="4705270">reads</span> <span m="4705500">to</span> <span m="4705600">estimate</span> <span m="4706270">the</span> <span m="4706350">complexity</span> <span m="4707000">of</span> <span m="4707080">our</span> <span m="4707260">original</span> <span m="4707640">library</span> <span m="4708570">and</span> <span m="4708810">whether</span> <span m="4709210">or</span> <span m="4709280">not</span> <span m="4709740">something</span> <span m="4710060">went</span> <span m="4710210">wrong</span> <span m="4711170">in</span> <span m="4711270">the</span> <span m="4711350">biological</span> <span m="4711870">processing</span> <span m="4712440">that</span> <span m="4712550">we</span> <span m="4712660">were</span> <span m="4712780">doing.</span> <span m="4713520">Assuming</span> <span m="4713900">it's</span> <span m="4714000">a</span> <span m="4714070">good</span> <span m="4714330">set</span> <span m="4714540">of</span> <span m="4714650">reads,</span> <span m="4715500">we</span> <span m="4715650">need</span> <span m="4715740">to</span> <span m="4715800">figure</span> <span m="4716130">out</span> <span m="4716250">where</span> <span m="4716460">they</span> <span m="4716600">align</span> <span m="4716930">to</span> <span m="4717000">the</span> <span m="4717110">genome.</span> </p>
<p><span m="4718260">So</span> <span m="4718380">we</span> <span m="4718480">talked</span> <span m="4718700">about</span> <span m="4718910">this</span> <span m="4719060">idea</span> <span m="4719330">of</span> <span m="4719380">creating</span> <span m="4719750">a</span> <span m="4719910">full</span> <span m="4720250">text</span> <span m="4720680">minute</span> <span m="4721390">size</span> <span m="4721640">index,</span> <span m="4722450">which</span> <span m="4722650">involves</span> <span m="4723000">a</span> <span m="4723040">Burrows-Wheeler</span> <span m="4723640">transform.</span> <span m="4724800">And</span> <span m="4725020">we</span> <span m="4725120">saw</span> <span m="4725450">how</span> <span m="4725700">we</span> <span m="4725820">can</span> <span m="4725960">compute</span> <span m="4726410">that</span> <span m="4727160">and</span> <span m="4727270">throw away</span> <span m="4727650">almost</span> <span m="4727930">everything</span> <span m="4728280">else</span> <span m="4728680">except</span> <span m="4729040">for</span> <span m="4729130">the</span> <span m="4729230">BWT</span> <span m="4729760">itself,</span> <span m="4731130">the</span> <span m="4731750">suffix</span> <span m="4732100">array</span> <span m="4732340">checkpoints,</span> <span m="4733480">and</span> <span m="4733700">the</span> <span m="4733820">FM</span> <span m="4735010">index</span> <span m="4735340">checkpoints</span> <span m="4736580">to</span> <span m="4737310">be</span> <span m="4737470">able</span> <span m="4737640">to</span> <span m="4737880">reconstruct</span> <span m="4739400">this</span> <span m="4739600">at</span> <span m="4740090">a</span> <span m="4740200">relatively</span> <span m="4740670">modest</span> <span m="4741210">increase</span> <span m="4741550">in</span> <span m="4741630">size</span> <span m="4741880">over</span> <span m="4742080">the</span> <span m="4742170">genome</span> <span m="4742520">itself</span> <span m="4742910">and</span> <span m="4743030">do</span> <span m="4743110">this</span> <span m="4743290">very,</span> <span m="4743770">very</span> <span m="4743920">rapid</span> <span m="4744310">matching,</span> <span m="4745100">albeit</span> <span m="4746070">with</span> <span m="4747230">more</span> <span m="4747550">problematic</span> <span m="4748160">matching</span> <span m="4748510">of</span> <span m="4748790">mismatches.</span> <span m="4750470">And</span> <span m="4750700">then</span> <span m="4750930">we</span> <span m="4751050">turned</span> <span m="4751840">to</span> <span m="4751940">the</span> <span m="4752040">question</span> <span m="4752830">of</span> <span m="4753480">how</span> <span m="4753660">to</span> <span m="4753770">deal</span> <span m="4753920">with</span> <span m="4754040">those</span> <span m="4754200">mismatches</span> <span m="4754740">with</span> <span m="4754850">backtracking</span> <span m="4755930">and</span> <span m="4756430">some</span> <span m="4756750">fine</span> <span m="4756940">points</span> <span m="4757270">on</span> <span m="4758070">paired</span> <span m="4758410">end</span> <span m="4759110">alignment.</span> </p>
<p><span m="4760900">So</span> <span m="4761670">that</span> <span m="4762000">is</span> <span m="4763620">the</span> <span m="4764050">end</span> <span m="4764380">of</span> <span m="4764510">today's</span> <span m="4764860">lecture.</span> <span m="4766680">On</span> <span m="4767690">Tuesday</span> <span m="4768070">of</span> <span m="4768130">next</span> <span m="4768350">week,</span> <span m="4768890">we'll</span> <span m="4769000">talk</span> <span m="4769230">about</span> <span m="4770750">how</span> <span m="4771010">to</span> <span m="4771150">actually</span> <span m="4772050">construct</span> <span m="4772820">a</span> <span m="4772920">reference</span> <span m="4773290">genome,</span> <span m="4773700">which</span> <span m="4773840">is</span> <span m="4773940">a</span> <span m="4774060">really</span> <span m="4774420">neat</span> <span m="4774580">thing</span> <span m="4774820">to</span> <span m="4774890">be</span> <span m="4775100">able</span> <span m="4775280">to</span> <span m="4775360">do,</span> <span m="4776150">take</span> <span m="4776320">a</span> <span m="4776390">whole</span> <span m="4776860">bunch</span> <span m="4777150">of</span> <span m="4777230">reads,</span> <span m="4778590">put</span> <span m="4778750">the</span> <span m="4778840">puzzle</span> <span m="4779080">back</span> <span m="4779230">together</span> <span m="4779570">again.</span> <span m="4780630">I</span> <span m="4780770">would</span> <span m="4780900">encourage</span> <span m="4781310">you</span> <span m="4781500">to</span> <span m="4782380">make</span> <span m="4782640">sure</span> <span m="4782790">you</span> <span m="4782940">understand</span> <span m="4783440">how</span> <span m="4783570">this</span> <span m="4784100">indexing</span> <span m="4784460">strategy</span> <span m="4784800">works.</span> <span m="4785360">Look</span> <span m="4785770">at the</span> <span m="4785890">slides.</span> <span m="4786250">Feel</span> <span m="4786590">free</span> <span m="4786740">to</span> <span m="4786780">ask</span> <span m="4787020">any</span> <span m="4787230">of</span> <span m="4787290">us.</span> </p>
<p><span m="4788120">Thanks</span> <span m="4788360">so</span> <span m="4788440">much</span> <span m="4788650">for</span> <span m="4788720">your</span> <span m="4788860">attention.</span> <span m="4789260">Welcome</span> <span m="4789600">back.</span> <span m="4790330">Have</span> <span m="4790500">a</span> <span m="4790600">great</span> <span m="4791460">weekend.</span> <span m="4791800">We'll</span> <span m="4791910">see</span> <span m="4792120">you</span> <span m="4792240">next</span> <span m="4792820">Tuesday.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id951068236">MP4 - 176MB</a>)</li>
<li>Internet Archive (<a href="http://archive.org/download/MIT7.91JS14/MIT7_91JS14_lec05_300k.mp4">MP4 - 176MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-5-library-complexity-and-short-read-alignment-mapping/P3ORBMon8aw.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","7");googletag.pubads().set("CRS_BEG2","91");googletag.pubads().set("CRS_END","J");googletag.pubads().set("SESSION","S");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
